Hierarchical Quasi-Clustering Methods for Asymmetric Networks
Gunnar Carlsson
Department of Mathematics, Stanford University

GUNNAR @ MATH . STANFORD . EDU

Facundo Mémoli
MEMOLI @ MATH . OSU . EDU
Department of Mathematics and Department of Computer Science and Engineering, Ohio State University
Alejandro Ribeiro, Santiago Segarra
{ARIBEIRO , SSEGARRA}@ SEAS . UPENN . EDU
Department of Electrical and Systems Engineering, University of Pennsylvania

Abstract
This paper introduces hierarchical quasiclustering methods, a generalization of hierarchical clustering for asymmetric networks where
the output structure preserves the asymmetry of
the input data. We show that this output structure
is equivalent to a finite quasi-ultrametric space
and study admissibility with respect to two
desirable properties. We prove that a modified
version of single linkage is the only admissible quasi-clustering method. Moreover, we
show stability of the proposed method and we
establish invariance properties fulfilled by it.
Algorithms are further developed and the value
of quasi-clustering analysis is illustrated with a
study of internal migration within United States.

1. Introduction
Given a network of interactions, hierarchical clustering
methods determine a dendrogram, i.e. a family of nested
partitions indexed by a resolution parameter. Clusters that
arise correspond to sets of nodes that are more similar to
each other than to the rest and, as such, can be used to study
the formation of communities (Shi & Malik, 2000; Newman
& Girvan, 2002; 2004; Von Luxburg, 2007; Ng et al., 2002; Lance
& Williams, 1967; Jain & Dubes, 1988). For asymmetric net-

works, in which the dissimilarity from node x to node x0
may differ from the one from x0 to x (Saito & Yadohisa,
2004), the determination of said clusters is not a straightforward generalization of the methods used to cluster symmetric datasets (Hubert, 1973; Slater, 1976; Boyd, 1980; Tarjan,

1983; Slater, 1984; Murtagh, 1985; Pentney & Meila, 2005; Meila
& Pentney, 2007; Zhao & Karypis, 2005).
Proceedings of the 31 st International Conference on Machine
Learning, Beijing, China, 2014. JMLR: W&CP volume 32. Copyright 2014 by the author(s).

This difficulty motivates formal developments whereby hierarchical clustering methods are constructed as those that
are admissible with respect to some reasonable properties
(Carlsson & Mémoli, 2010; 2013; Carlsson et al., 2013). A fundamental distinction between symmetric and asymmetric
networks is that while it is easy to obtain uniqueness results
for the former (Carlsson & Mémoli, 2010), there are a variety
of methods that are admissible for the latter (Carlsson et al.,
2013). Although one could conceive of imposing further
restrictions to winnow the space of admissible methods for
clustering asymmetric networks, it is actually reasonable
that multiple methods should exist. Since dendrograms are
symmetric structures one has to make a decision as to how
to derive symmetry from an asymmetric dataset and there
are different stages of the clustering process at which such
symmetrization can be carried out (Carlsson et al., 2013). In
a sense, there is a fundamental mismatch between having a
network of asymmetric relations as input and a symmetric
dendrogram as output.
This paper develops a generalization of dendrograms and
hierarchical clustering methods to allow for asymmetric
output structures. We refer to these asymmetric structures
as quasi-dendrograms and to the procedures that generate them as hierarchical quasi-clustering methods. Since
the symmetry in dendrograms can be traced back to the
symmetry of equivalence relations we start by defining
a quasi-equivalence relation as one that is reflexive and
transitive but not necessarily symmetric (Section 3). We
then define a quasi-partition as the structure induced by a
quasi-equivalence relation, a quasi-dendrogram as a nested
collection of quasi-partitions, and a hierarchical quasiclustering method as a map from the space of networks
to the space of quasi-dendrograms (Section 3.1). Quasipartitions are similar to regular partitions in that they contain disjoint blocks of nodes but they also include an influence structure between the blocks derived from the asymmetry in the original network. This influence structure defines a partial order over the blocks (Harzheim, 2005).

Hierarchical Quasi-Clustering Methods for Asymmetric Networks

We proceed to study admissibility of quasi-clustering methods with respect to the directed axioms of value and transformation. The Directed Axiom of Value states that the
quasi-clustering of a network of two nodes is the network itself. The Directed Axiom of Transformation states
that reducing dissimilarities cannot lead to looser quasiclusters. We show that there is a unique quasi-clustering
method admissible with respect to these axioms and that
this method is an asymmetric version of the single linkage clustering method (Section 3.4). The analysis in
this section hinges upon an equivalence between quasidendrograms and quasi-ultrametrics (Section 3.2) that generalizes the well-known equivalence between dendrograms
and ultrametrics (Jardine & Sibson, 1971).
Exploiting the fact that quasi-dendrograms can be represented by quasi-ultrametrics, we propose a quantitative notion of stability of quasi-clustering methods (Section 3.5).
We prove that the unique method from Section 3.4 is stable in the sense that we propose. We also establish several
invariance properties enjoyed by this method.
In order to apply the quasi-clustering method to real data,
we derive an algorithm based on matrix powers in a dioid
algebra (Gondran & Minoux, 2008) (Section 3.6). As an
example, we cluster a network that contains information
about the internal migration between states of the United
States for the year 2011 (Section 4). The quasi-clustering
output unveils that migration is dominated by geographical
proximity. Moreover, by exploiting the asymmetric influence between clusters, one can show the migrational influence of California over the West Coast.
Proofs of results in this paper not contained in the main
body can be found in the supplementary material.

2. Preliminaries
A network N is a pair (X, AX ) where X is a finite set of
points or nodes and AX : X ⇥ X ! R+ is a dissimilarity function. The value AX (x, x0 ) is assumed to be nonnegative for all pairs (x, x0 ) 2 X ⇥ X and 0 if and only
if x = x0 . However, AX need not satisfy the triangle inequality and may be asymmetric in that it is possible to
have AX (x, x0 ) 6= AX (x0 , x) for some x 6= x0 . We further
define N as the set of all networks. Networks N 2 N can
have different node sets X and different dissimilarities AX .
A conventional non-hierarchical clustering of the set X is
a partition P , i.e., a collection of sets P = {B1 , . . . , BJ }
which are pairwise disjoint and required to cover X. The
sets B1 , B2 , . . . BJ are called the blocks of P and represent clusters. A partition P = {B1 , . . . , BJ } of X induces
and is induced by an equivalence relation ⇠ on X such that
for all x, x0 , x00 2 X we have that x ⇠ x, x ⇠ x0 if and
only if x0 ⇠ x, and x ⇠ x0 combined with x0 ⇠ x00 im-

plies x ⇠ x00 . In hierarchical clustering, the output is not a
single partition P but a nested collection DX of partitions
DX ( ) of X indexed by a resolution parameter
0. For
a given DX , we say that two nodes x and x0 are equivalent at resolution
0 and write x ⇠DX ( ) x0 if and
0
only if nodes x and x are in the same cluster of DX ( ).
The nested collection DX is termed a dendrogram (Jardine
& Sibson, 1971). The interpretation of a dendrogram is that
of a structure which yields different clusterings at different
resolutions. At resolution = 0 each point is in a cluster of
its own and as the resolution parameter increases, nodes
start forming clusters. We denote by [x] the equivalence
class to which the node x 2 X belongs at resolution , i.e.
[x] := {x0 2 X x ⇠DX ( ) x0 }.
Given a network (X, AX ) and x, x0 2 X, a chain C(x, x0 )
is an ordered sequence of nodes in X,
C(x, x0 ) = [x = x0 , x1 , . . . , xl

1 , xl

= x0 ],

(1)

which starts at x and ends at x0 . We say that C(x, x0 ) links
or connects x to x0 . The links of a chain are the edges
connecting consecutive nodes of the chain in the direction
given by the chain. We define the cost of a chain (1) as
the maximum dissimilarity maxi|xi 2C(x,x0 ) AX (xi , xi+1 )
encountered when traversing its links in order.

3. Quasi-Clustering methods
A partition P = {B1 , . . . , BJ } of a set X can be interpreted as a reduction in data complexity in which variations between elements of a group are neglected in favor
of the larger dissimilarities between elements of different
groups. This is natural when clustering datasets endowed
with symmetric dissimilarities because the concepts of a
node x 2 X being close to another node x0 2 X and x0
being close to x are equivalent. In an asymmetric network
these concepts are different and this difference motivates
the definition of structures more general than partitions.
Considering that a partition P = {B1 , . . . , BJ } of X is
induced by an equivalence relation ⇠ on X we search for
the equivalent of an asymmetric partition by removing the
symmetry property in the definition of the equivalence relation. Thus, we define a quasi-equivalence
as a binary
relation that satisfies the reflexivity and transitivity properties but is not necessarily symmetric as stated next.
Definition 1 A binary relation
between elements of a
set X is a quasi-equivalence if and only if the following
properties hold true for all x, x0 , x00 2 X:
(i) Reflexivity. Points are quasi-equivalent to themselves, x
x.
(ii) Transitivity. If x
x0 and x0
x00 then x
x00 .

Hierarchical Quasi-Clustering Methods for Asymmetric Networks
B4
B1

B2
B5

B3
B6

Figure 1. A quasi-partition P̃ = (P, E) on a set of nodes. The
vertex set P of the quasi-partition is given by a partition of
the nodes P = {B1 , B2 , . . . , B6 }. The edges of the directed
graph P̃ = (P, E) represent unidirectional influence between the
blocks of the partition.

Quasi-equivalence relations are more often termed preorders or quasi-orders in the literature (Harzheim, 2005). We
choose the term quasi-equivalence to emphasize that they
are a modified version of an equivalence relation.
We define a quasi-partition of the set X as a directed, unweighted graph P̃ = (P, E) with no self-loops where the
vertex set P is a partition P = {B1 , . . . , BJ } of the space
X and the edge set E ✓ P ⇥ P is such that the following
properties are satisfied (see Fig. 1):
(QP1) Unidirectionality. For any given pair of distinct
blocks Bi , Bj 2 P we have at most one edge between
them. Thus, if for some i 6= j we have (Bi , Bj ) 2 E
then (Bj , Bi ) 2
/ E.
(QP2) Transitivity. If there are edges between blocks Bi
and Bj and between blocks Bj and Bk , then there is an
edge between blocks Bi and Bk .
The vertex set P of a quasi-partition P̃ = (P, E) represents sets of nodes that can influence each other, whereas
the edges in E capture the notion of directed influence from
one group to the next. In the example in Fig. 1, nodes
which are drawn together can exert influence on each other.
This gives rise to the blocks Bi which form the vertex set
P of the quasi-partition. Additionally, some blocks have
influence over others in only one direction. E.g., block B1
can influence B4 but not vice versa. This latter fact motivates keeping B1 and B4 as separate blocks in the partition
whereas the former motivates the addition of the directed
influence edge (B1 , B4 ). Likewise, B1 can influence B3 ,
B2 can influence B3 and B4 can influence B5 but none of
these influences are true in the opposite direction. Block
B1 need not be able to directly influence B5 , but can influence it through B4 , hence the edge from B1 to B5 , in
accordance with (QP2). All other influence relations are
not meaningful, justifying the lack of connections between
the other blocks.

Requirements (QP1) and (QP2) in the definition of quasipartition represent the relational structure that emerges
from quasi-equivalence relations as we state in the following proposition.
Proposition 1 Given a node set X and a quasiequivalence relation
on X [cf. Definition 1] define the
relation $ on X as
x $ x0

()

x

x0 and x0

x,

(2)

for all x, x0 2 X. Then, $ is an equivalence relation. Let
P = {B1 , . . . , BJ } be the partition of X induced by $.
Define E ✓ P ⇥ P such that for all distinct Bi , Bj 2 P
(Bi , Bj ) 2 E

()

xi

xj ,

(3)

for some xi 2 Bi and xj 2 Bj . Then, P̃ = (P, E) is a
quasi-partition of X. Conversely, given a quasi-partition
P̃ = (P, E) of X, define the binary relation
on X so
that for all x, x0 2 X
x

x0 () [x] = [x0 ] or ([x], [x0 ]) 2 E,

(4)

where [x] 2 P is the block of the partition P that contains the node x and similarly for [x0 ]. Then, is a quasiequivalence on X.
Proof: See Theorem 4.9, Ch. 1.4 in (Harzheim, 2005).

⌅

In the same way that an equivalence relation induces and is
induced by a partition on a given node set X, Proposition
1 shows that a quasi-equivalence relation induces and is induced by a quasi-partition on X. We can then adopt the
construction of quasi-partitions as the natural generalization of clustering problems when given asymmetric data.
Further, observe that if the edge set E contains no edges,
P̃ = (P, E) is equivalent to the regular partition P when
ignoring the empty edge set. In this sense, partitions are
particular cases of quasi-partitions having the generic form
P̃ = (P, ;). To allow generalizations of hierarchical clustering methods with asymmetric outputs we introduce the
notion of quasi-dendrogram in the following section.
3.1. Quasi-dendrograms
Given that a dendrogram is defined as a nested set of partitions, we define a quasi-dendrogram D̃X of the set X as
a nested set of quasi-partitions D̃X ( ) = (DX ( ), EX ( ))
indexed by a resolution parameter
0. Recall the definition of [x] from Section 2. Formally, for D̃X to be a
quasi-dendrogram we require the following conditions:
(D̃1) Boundary conditions. At resolution = 0 all nodes
are in separate clusters with no edges between them and

Hierarchical Quasi-Clustering Methods for Asymmetric Networks

for some 0 sufficiently large all elements of X are in a
single cluster,
⇣
⌘
D̃X (0) = {x}, x 2 X , ; ,
⇣
⌘
D̃X ( 0 ) = {X}, ;
for some 0 0.
(5)
(D̃2) Equivalence hierarchy. For any pair of points x, x0
for which x ⇠DX ( 1 ) x0 at resolution 1 we must have
x ⇠DX ( 2 ) x0 for all resolutions 2 > 1 .
(D̃3) Influence hierarchy.
If there is an edge
([x] 1 , [x0 ] 1 ) 2 EX ( 1 ) between the equivalence
classes [x] 1 and [x0 ] 1 of nodes x and x0 at resolution 1 ,
at any resolution 2 > 1 we either have ([x] 2 , [x0 ] 2 ) 2
EX ( 2 ) or [x] 2 = [x0 ] 2 .
(D̃4) Right continuity. For all
0 there exists ✏ > 0
such that D̃X ( ) = D̃X ( 0 ) for all 0 2 [ , + ✏].
Requirement (D̃1) states that for resolution = 0 there
should be no influence between any pair of nodes and that,
for a large enough resolution
= 0 , there should be
enough influence between the nodes for all of them to belong to the same cluster. According to (D̃2), nodes become
ever more clustered since once they join together in a cluster, they stay together in the same cluster for all larger resolutions. Condition (D̃3) states for the edge set the analogous requirement that (D̃2) states for the node set. If there
is an edge present at a given resolution 1 , that edge should
persist at coarser resolutions 2 > 1 except if the groups
linked by the edge merge in a single cluster. Requirement
(D̃4) is a technical condition that ensures the correct definition of a hierarchical structure [cf. (8) below].
Comparison of (D̃1), (D̃2), and (D̃4) with the three properties defining a dendrogram (Carlsson & Mémoli, 2010) implies that given a quasi-dendrogram D̃X = (DX , EX )
on a node set X, the component DX is a dendrogram
on X. I.e, the vertex sets DX ( ) of the quasi-partitions
(DX ( ), EX ( )) for varying form a nested set of partitions. Hence, if the edge set EX ( ) = ; for every resolution parameter, D̃X recovers the structure of the dendrogram DX . Thus, quasi-dendrograms are a generalization of
dendrograms, or, equivalently, dendrograms are particular
cases of quasi-dendrograms with empty edge sets. Regarding dendrograms DX as quasi-dendrograms (DX , ;) with
empty edge sets, we have that the set of all dendrograms D
is a subset of D̃, the set of all quasi-dendrograms.
A hierarchical clustering method H : N ! D is defined as
a map from the space of networks N to the space of dendrograms D. This motivates the definition of a hierarchical
quasi-clustering method as follows.

Definition 2 A hierarchical quasi-clustering method H̃ is
defined as a map from the space of networks N to the space
of quasi-dendrograms D̃,
H̃ : N ! D̃.

(6)

Since D ⇢ D̃ we have that every clustering method is a
quasi-clustering method but not vice versa. Our goal here is
to study quasi-clustering methods satisfying desirable axioms that define the concept of admissibility. In order to
facilitate this analysis, we introduce quasi-ultrametrics as
asymmetric versions of ultrametrics and show their equivalence to quasi-dendrograms in the following section.
Remark 1 Unidirectionality (QP1) ensures that no cycles containing exactly two nodes can exist in any quasipartition P̃ = (P, E). If there were longer cycles, transitivity (QP2) would imply that every two distinct nodes in
a longer cycle would have to form a two-node cycle, contradicting (QP1). Thus, conditions (QP1) and (QP2) imply
that every quasi-partition P̃ = (P, E) is a directed acyclic
graph (DAG). The fact that a DAG represents a partial order shows that our construction of a quasi-partition from a
quasi-equivalence relation is consistent with the known set
theoretic construction of a partial order on a partition of a
set given a preorder on the set (Harzheim, 2005).
3.2. Quasi-ultrametrics
We define a quasi-ultrametric ũX on a given node set X as
follows.
Definition 3 Given a node set X, a quasi-ultrametric ũX
is a non-negative function ũX : X ⇥ X ! R+ satisfying
the following properties for all x, x0 , x00 2 X:
(i) Identity. ũX (x, x0 ) = 0 if and only if x = x0 .
(ii) Strong triangle inequality. ũX satisfies

ũX (x, x0 )  max(ũX (x, x00 ), ũX (x00 , x0 )).

(7)

Quasi-ultrametrics may be regarded as ultrametrics where
the symmetry property is not imposed. In particular, the
space Ũ of quasi-ultrametric networks, i.e. networks with
quasi-ultrametrics as dissimilarities, is a superset of the
space of ultrametric networks U ⇢ Ũ . See (Gurvich & Vyalyi, 2012) for structural properties of quasi-ultrametrics.
The following constructions and theorem establish a structure preserving equivalence between quasi-dendrograms
and quasi-ultrametrics. Consider the map
: D̃ ! Ũ
defined as follows: for a given quasi-dendrogram D̃X =
(DX , EX ) over the set X write (D̃X ) = (X, ũX ), where
we define ũX (x, x0 ) for each x, x0 2 X as the smallest
resolution at which either both nodes belong to the same

Hierarchical Quasi-Clustering Methods for Asymmetric Networks

equivalence class [x] = [x0 ] , i.e. x ⇠DX ( ) x0 , or there
exists an edge in EX ( ) from the equivalence class [x] to
the equivalence class [x0 ] ,
n
ũX (x, x0 ) := min
0
(8)
o
[x] = [x0 ] or ([x] , [x0 ] ) 2 EX ( ) .

ũX

)

x0 () max ũX (x, x0 ), ũX (x0 , x)  . (9)

Define further DX ( ) :=
edge set EX ( ) for every
DX ( ) are such that

X mod ⇠ũX ( )
and the
0 as follows: B1 6= B2 2

(B1 , B2 ) 2 EX ( ) () min ũX (x1 , x2 )  .
x1 2B1
x2 2B2

(10)

Finally, ⌥(X, ũX ) := D̃X , where D̃X := (DX , EX ).
Theorem 1 The maps : D̃ ! Ũ and ⌥ : Ũ ! D̃ are
both well defined. Furthermore,
⌥ is the identity on Ũ
and ⌥
is the identity on D̃.
Theorem 1 implies that quasi-dendrograms D̃X can be represented as quasi-ultrametric networks defined on the same
underlying node set X. This allows us to reinterpret hierarchical quasi-clustering methods [cf. (6)] as maps
H̃ : N ! Ũ ,

(11)

from the space of networks to the space of quasi-ultrametric
networks. Apart from the theoretical importance of Theorem 1, this equivalence result is of practical importance
since quasi-ultrametrics are mathematically more convenient to handle than quasi-dendrograms. However, quasidendrograms are more convenient for representing data as
illustrated in Section 4.
Given a quasi-dendrogram D̃X = (DX , EX ), the value
ũX (x, x0 ) of the associated quasi-ultrametric for x, x0 2 X
is given by the minimum resolution at which x can influence x0 . This may occur when x and x0 belong to the same
block of DX ( ) or when they belong to different blocks
B, B 0 2 DX ( ), but there is an edge from the block containing x to the block containing x0 , i.e. (B, B 0 ) 2 EX ( ).
Conversely, given a quasi-ultrametric network (X, ũX ), for
a given resolution the graph D̃X ( ) has as a vertex set
the classes of nodes whose quasi-ultrametric is less than
in both directions. Furthermore, D̃X ( ) contains a directed
edge between two distinct equivalence classes if the quasiultrametric from some node in the first class to some node
in the second is not greater than .

DX
x3

3
2 1
3

x2

x1

x3

x1

2

1

2

3

D̃X ( )

We also consider the map ⌥ : Ũ ! D̃ constructed as follows: for a given quasi-ultrametric ũX on the set X and
each
0 define the relation ⇠ũX ( ) on X as
x ⇠ũX (

x2

1

x2

x{1,2}

x2

x{1,2,3}
x1

0

0

x3

x1

<1
1

1

x3

x3

<2
2

2

<3

3
3

Figure 2. Equivalence between quasi-dendrograms D̃X
(DX , EX ) and quasi-ultrametrics ũX .

=

In Fig. 2 we present an example of the equivalence between quasi-dendrograms and quasi-ultrametric networks
stated by Theorem 1. At the top left of the figure, we
present a quasi-ultrametric ũX defined on a three-node set
X = {x1 , x2 , x3 }. At the top right, we depict the dendrogram component DX of the quasi-dendrogram D̃X =
(DX , EX ) equivalent to (X, ũX ) as given by Theorem 1.
At the bottom of the figure, we present graphs D̃X ( ) for
a range of resolutions
0. To obtain D̃X from ũX ,
we first obtain the dendrogram component DX by symmetrizing ũX to the maximum [cf. (9)], nodes x1 and x2
merge at resolution 2 and x3 merges with {x1 , x2 } at resolution 3. To see how the edges in D̃X are obtained, at
resolutions 0  < 1, there are no edges since there is
no quasi-ultrametric value between distinct nodes in this
range [cf. (10)]. At resolution = 1, we reach the first
non-zero values of ũX and hence the corresponding edges
appear in D̃X (1). At resolution
= 2, nodes x1 and
x2 merge and become the same vertex in graph D̃X (2).
Finally, at resolution = 3 all the nodes belong to the
same equivalence class and hence D̃X (3) contains only
one vertex. Conversely, to obtain ũX from D̃X as depicted in the figure, note that at resolution = 1 two edges
([x1 ]1 , [x2 ]1 ) and ([x3 ]1 , [x2 ]1 ) appear in D̃X (1), thus the
corresponding values of the quasi-ultrametric are fixed to
be ũX (x1 , x2 ) = ũ(x3 , x2 ) = 1. At resolution = 2,
when x1 and x2 merge into the same vertex in D̃X (2),
an edge is generated from [x3 ]2 to [x1 ]2 the equivalence
class of x1 at resolution = 2 which did not exist before,
implying that ũX (x3 , x1 ) = 2. Moreover, we have that
[x2 ]2 = [x1 ]2 , hence ũX (x2 , x1 ) = 2. Finally, at D̃X (3)
there is only one equivalence class, thus the values of ũX
that have not been defined so far must equal 3.
3.3. Admissible quasi-clustering methods
We encode desirable properties of quasi-clustering methods into axioms which we use as a criterion for admis-

Hierarchical Quasi-Clustering Methods for Asymmetric Networks

sibility. The Directed Axiom of Value (Ã1) and the Directed Axiom of Transformation (Ã2) winnow the space
of quasi-clustering methods by imposing conditions on
their output quasi-ultrametrics which, by Theorem 1, is
equivalent to imposing conditions on the output quasidendrograms. Defining an arbitrary two-node network
~ 2 (↵, ) := ({p, q}, Ap,q ) with Ap,q (p, q) = ↵ and
Ap,q (q, p) = for some ↵, > 0,
(Ã1) Directed Axiom of Value.
H̃( ~ 2 (↵, ))
~ 2 (↵, ) for every two-node network ~ 2 (↵, ).

=

(Ã2) Directed Axiom of Transformation. Consider two
networks NX = (X, AX ) and NY = (Y, AY ) and a
dissimilarity-reducing map
: X ! Y , i.e. a map
such that for all x, x0 2 X it holds AX (x, x0 )
AY ( (x), (x0 )). Then, for all x, x0 2 X, the outputs
(X, ũX ) = H̃(X, AX ) and (Y, ũY ) = H̃(Y, AY ) satisfy
ũX (x, x0 ) ũY ( (x), (x0 )).
(12)
The Directed Axiom of Transformation (Ã2) states that no
influence relation can be weakened by a dissimilarity reducing transformation. That is, if relations in the network
are strengthened, the tendency of nodes to cluster cannot
decrease. The Directed Axiom of Value (Ã1) simply recognizes that in any two-node network, the dissimilarity function is itself a quasi-ultrametric and that there is no valid
justification to output a different quasi-ultrametric.
3.4. Existence and uniqueness of admissible
quasi-clustering methods: directed single linkage
We call a quasi-clustering method H̃ admissible if it satisfies axioms (Ã1) and (Ã2) and we want to find methods that
are admissible with respect to these axioms. This is not difficult. Define the directed minimum chain cost ũ⇤X (x, x0 )
between nodes x and x0 as the minimum chain cost among
all chains connecting x to x0 . Formally, for all x, x0 2 X,
ũ⇤X (x, x0 ) = min0

max

C(x,x ) i|xi 2C(x,x0 )

AX (xi , xi+1 ).

(13)

Define the directed single linkage (DSL) hierarchical
quasi-clustering method H̃⇤ as the one with output quasiultrametrics (X, ũ⇤X ) = H̃⇤ (X, AX ) given by the directed
minimum chain cost function ũ⇤X . The DSL method is valid
and admissible as we show in the following proposition.
Proposition 2 The hierarchical quasi-clustering method
H̃⇤ is valid and admissible. I.e., ũ⇤X defined by (13) is a
quasi-ultrametric and H̃⇤ satisfies axioms (Ã1)-(Ã2).
We next ask which other methods satisfy (Ã1)-(Ã2) and
what special properties DSL has. As it turns out, DSL is

the unique quasi-clustering method that is admissible with
respect to (Ã1)-(Ã2) as we assert in the following theorem.
Theorem 2 Let H̃ be a valid hierarchical quasi-clustering
method satisfying axioms (Ã1) and (Ã2). Then, H̃ ⌘
H̃⇤ where H̃⇤ is the DSL method with output quasiultrametrics as in (13).
In (Carlsson & Mémoli, 2010), it was shown that single linkage is the only admissible hierarchical clustering method
for finite metric spaces. Admissibility was defined by three
axioms, two of which are undirected versions of (Ã1) and
(Ã2). In (Carlsson et al., 2013), they show that when replacing metric spaces by more general asymmetric networks,
the uniqueness result is lost and an infinite number of methods satisfy the admissibility axioms. In our paper, by considering the more general framework of quasi-clustering
methods, we recover the uniqueness result even for asymmetric networks. Moreover, Theorem 2 shows that the
only admissible method is a directed version of single linkage. In this way, it becomes clear that the non-uniqueness
result for asymmetric networks in (Carlsson et al., 2013)
is originated in the symmetry mismatch between the input asymmetric network and the output symmetric dendrogram. When we allow the more general asymmetric quasidendrogram as output, the uniqueness result is recovered.
DSL was identified as a natural extension of single linkage
hierarchical clustering to asymmetric networks in (Boyd,
1980). In our paper, by developing a framework to study
hierarchical quasi-clustering methods and leveraging the
equivalence result in Theorem 1, we show that DSL is the
unique admissible way of quasi-clustering asymmetric networks. Furthermore, stability and invariance properties are
established in the following section.
Remark 2 (Axiomatic strength and chaining effect)
DSL, having a strong resemblance to single linkage
hierarchical clustering on finite metric spaces, is likely
to be sensitive to a directed version of the so called
chaining effect (Jain & Dubes, 1988). By requiring a weaker
version of (Ã2), the most stringent of our two axioms,
the uniqueness result in Theorem 2 is lost and density
aware methods, that do not suffer from the chaining effect,
become admissible. This direction, shown to be successful
for finite metric spaces (Carlsson & Mémoli, 2013), appears
to be an interesting research avenue.
3.5. Stability and invariance properties of DSL
DSL is stable in the sense that if it is applied to similar
networks then it outputs similar quasi-dendrograms. This
notion has been used to study stability of clustering methods for finite metric spaces (Carlsson & Mémoli, 2010). More
precisely, we define a notion of distance between networks

Hierarchical Quasi-Clustering Methods for Asymmetric Networks

dN which is an analogue to the Gromov-Hausdorff distance
(Gromov, 2007) between metric spaces and defines a legitimate metric on N (see A.4 in supplementary material for
details). Since we may regard DSL as a map N ! Ũ and
Ũ is a subset of N , we are in a position in which we can
use dN to express the stability of H̃⇤ .
Theorem 3 For all NX , NY 2 N ,
dN H̃⇤ (NX ), H̃⇤ (NY )  dN (NX , NY ).
Theorem 3 states that the distance between the output
quasi-ultrametrics is upper bounded by the distance between the input networks. Thus, for DSL, nearby networks
yield nearby quasi-ultrametrics. In particular, Theorem 3
ensures that noisy dissimilarity data has limited effect on
quasi-dendrograms. Also, the theorem implies that DSL is
permutation invariant; see A.7 in supplementary material.
For a non-decreasing function : [0, 1) ! [0, 1) such
that (a) = 0 if and only if a = 0, and NX = (X, AX ) 2
N we write (NX ) to denote the network (X, (AX )).
Any such will be referred to as a change of scale function. Then, DSL is a scale invariant method as the following proposition asserts.
Proposition 3 For all NX 2 N and all change of scale
functions one has H̃⇤ (NX ) = H̃⇤ (NX ) .
Since Proposition 3 asserts that the quasi-ultrametric outcome is transformed by the same function
that alters
the dissimilarity function in the original network, DSL is
invariant to change of units. More precisely, in terms
of quasi-dendrograms, a transformation of dissimilarities through results in a transformed quasi-dendrogram
where the order in which influences between nodes arise is
the same as in the original one while the resolution at which
they appear changes according to . For further invariances
of DSL, see A.7 in the supplementary materials.
3.6. Algorithms
In this section we interpret AX as a matrix of dissimilarities and ũ⇤X as a symmetric matrix with entries corresponding to the quasi-ultrametric values ũ⇤X (x, x0 ) for all
x, x0 2 X. By (13), DSL quasi-clustering searches for
directed chains of minimum infinity norm cost in AX to
construct the matrix ũ⇤X . This operation can be performed
algorithmically using matrix powers in the dioid algebra
(R+ [ {+1}, min, max) (Gondran & Minoux, 2008).
In the dioid algebra (R+ [ {+1}, min, max) the regular sum is replaced by the minimization operator and
the regular product by maximization. Using and ⌦ to
denote sum and product on this dioid algebra we have
a
b := min(a, b) and a ⌦ b := max(a, b) for all

a, b 2 R+ [ {+1}. The matrix product A ⌦ B is therefore
given by the matrix with entries
⇥

A⌦B

⇤

ij

=

n
M
k=1

Aik ⌦Bkj

= min max Aik , Bkj .
k2[1,n]

(14)
(k)
(k 1)
(1)
Dioid powers AX := AX ⌦ AX
with AX = AX of a
dissimilarity matrix are related to quasi-ultrametric matrices ũ. For instance, the elements of the dioid power ũ(2) of
a given quasi-ultrametric matrix ũ are given by
⇥ (2) ⇤
ũ ij = min max ũik , ũkj .
(15)
k2[1,n]

Since ũ satisfies the strong triangle inequality we have
that ũij  max(ũik , ũkj ) for all k. In particular, for
k = j we have that max(ũij , ũjj ) = max(ũij , 0) =
ũij . Combining these two observations it follows that
the result of the minimization in (15) is [ũ(2) ]ij = ũij .
This being valid for all i, j implies ũ(2) = ũ. Furthermore, a matrix satisfying ũ(2) = ũ is such that ũij =
[ũ(2) ]ij = mink2[1,n] max(ũik , ũkj )  max(ũik , ũkj ) for
all k, which is just a restatement of the strong triangle inequality. Therefore, a non-negative matrix ũ represents a
finite quasi-ultrametric space if and only if ũ(2) = ũ and
only the diagonal elements are null. Building on this fact,
we develop the following algorithm to implement DSL.
Proposition 4 For every network (X, AX ) with |X| = n,
the quasi-ultrametric ũ⇤X is given by
(n 1)

ũ⇤X = AX

,

(16)

where the operation (·)(n 1) denotes the (n 1)st matrix
power in the dioid algebra (R+ [ {+1}, min, max) with
matrix product as defined in (14).
Matrix powers in dioid algebras are tractable operations.
Indeed, there exist sub cubic dioid power algorithms (Vassilevska et al., 2009; Duan & Pettie, 2009) of complexity
O(n2.688 ). Thus, Proposition 4 shows computational
tractability of DSL. There exist related methods with lower
complexity. For instance, Tarjan’s method (Tarjan, 1983),
which takes as input an asymmetric network but in contrast
to our method enforces symmetry in its output, runs in time
O(n2 log n) for complete networks. It seems of interest to
ascertain whether Tarjan’s method can be modified to suit
our (asymmetric) output construction. In the following section we use (16) to quasi-cluster a real-world network.

4. Applications
The number of migrants from state to state in the U.S. is
published yearly (United States Census Bureau, 2011). We denote by S the set of all states and by AS : S ⇥ S ! R+
a migrational dissimilarity such that AS (s, s) = 0 for all

Hierarchical Quasi-Clustering Methods for Asymmetric Networks

s 2 S and AS (s, s0 ) for all s 6= s0 2 S is a monotonically
decreasing function of the fraction of immigrants to s0 that
come from s (see A.9 in supplementary material for details). A small dissimilarity from state s to s0 implies that,
among all the immigrants into s0 , a high percentage comes
from s. We then construct the network NS = (S, AS ) with
node set S and dissimilarities AS . The application of hierarchical clustering to migration data has been extensively
investigated by Slater, see (Slater, 1976; 1984).
The outcome of applying DSL to the migration network
NS is computed via (16). By Theorem 1, the output quasiultrametric is equivalent to a quasi-dendrogram D̃S⇤ =
(DS⇤ , ES⇤ ). By analyzing the dendrogram component DS⇤
of the quasi-dendrogram D̃S⇤ , the influence of geographical
proximity in migrational preference is evident; see Fig. 4
in Section A.9 of the supplementary material.
To facilitate display and understanding, we do not present
quasi-partitions for all the nodes and resolutions. Instead,
we restrict the quasi-ultrametric to a subset of states representing an extended West Coast including Arizona and
Nevada. In Fig. 3, we depict quasi-partitions at four relevant resolutions of the quasi-dendrogram equivalent to the
restricted quasi-ultrametric. States represented with the
same color in the maps in Fig. 3 are part of the same cluster at the given resolution and states in white form singleton
clusters. Arrows between clusters for a given resolution
represent the edge set ES⇤ ( ) which we interpret as a migrational influence relation between the blocks of states.
The DSL quasi-clustering method H̃⇤ captures not only the
formation of clusters but also the asymmetric influence between them. E.g. the quasi-partition in Fig. 3 for resolution = 0.859 is of little interest since every state forms a
singleton cluster. The influence structure, however, reveals
a highly asymmetric migration pattern. At this resolution
California has migrational influence over every other state
in the region as depicted by the four arrows leaving California and entering each of the other states. This influence can
be explained by the fact that California contains the largest
urban areas of the region such as Los Angeles. Hence,
these urban areas attract immigrants from all over the country, reducing the proportional immigration into California
from its neighbors and generating the asymmetric influence
structure observed. Since this influence structure defines a
partial order over the clusters, the quasi-partition at resolution = 0.859 permits asserting the reasonable fact that
California is the dominant migration force in the region.
At larger resolutions we can ascertain the relative importance of clusters. At resolution = 0.921 we can say
that California is more important than the cluster formed
by Oregon and Washington as well as more important than
Arizona and Nevada. We can also see that Arizona precedes Nevada in the migration ordering at this resolution

= 0.859

= 0.921
WA
OR
NV
CA
AZ

= 0.922

= 0.923

Figure 3. Directed single linkage quasi-clustering method applied
to the extended West Coast migration flow.

while the remaining pairs of the ordering are undefined. At
resolution = 0.922 there is an interesting pattern as we
can see the cluster formed by the three West Coast states
preceding Arizona and Nevada in the partial order. At this
resolution the partial order also happens to be a total order
as Arizona is seen to precede Nevada.
For further applications, refer to Section A.9 in the supplementary material.

5. Conclusion
When clustering asymmetric networks, requiring the output to be symmetric – as in hierarchical clustering – might
be undesirable. Hence, we defined quasi-dendrograms, a
generalization of dendrograms that admits asymmetric relations, and developed a theory for quasi-clustering methods. We formalized the notion of admissibility by introducing two axioms. Under this framework, we showed that
DSL is the unique admissible method. We pointed out that
less stringent frameworks that give rise to new admissible
methods can be explored by weakening the Directed Axiom of Transformation. Furthermore, we proved an equivalence between quasi-dendrograms and quasi-ultrametrics
that generalizes the well-known equivalence between dendrograms and ultrametrics, and established the stability and
invariance properties of the DSL method. Finally, we illustrated the application of DSL to a migration network.

Acknowledgments
Work in this paper is supported by NSF CCF-0952867, AFOSR
MURI FA9550-10-1-0567, DARPA GRAPHS FA9550-12-10416, AFOSR FA9550-09-0-1-0531, AFOSR FA9550-09-10643, NSF DMS 0905823, and NSF DMS-0406992.

Hierarchical Quasi-Clustering Methods for Asymmetric Networks

References
Boyd, J.P. Asymmetric clusters of internal migration regions of france. Ieee Transactions on Systems Man and
Cybernetics, (2):101–104, 1980.
Bureau of Economic Analysis. Input-output accounts: the
use of commodities by industries before redefinitions.
U.S. Department of Commerce, 2011. URL http://
www.bea.gov/iTable/index_industry.cfm.

Meila, M. and Pentney, W. Clustering by weighted cuts in
directed graphs. Proceedings of the 7th SIAM International Conference on Data Mining, 2007.
Murtagh, F.
Multidimensional clustering algorithms.
Compstat Lectures, Vienna: Physika Verlag, 1985, 1,
1985.
Newman, M. and Girvan, M. Community structure in social and biological networks. Proc. Ntnl. Acad. Sci., 99
(12):7821–7826, 2002.

Carlsson, G. and Mémoli, F. Characterization, stability and
convergence of hierarchical clustering methods. Journal
of Machine Learning Research, 11:1425–1470, 2010.

Newman, M. and Girvan, M. Finding and evaluating community structure in networks. Phys. Rev. E, 69, 026113,
2004.

Carlsson, G. and Mémoli, F. Classifying clustering
schemes. Foundations of Computational Mathematics,
13(2):221–252, 2013.

Ng, A., Jordan, M., and Weiss, Y. On spectral clustering:
Analysis and an algorithm. In T.K. Leen, T.G. Dietterich
and V. Tresp (Eds.), Advances in neural information processing systems 14, MIT Press, Cambridge, 2:849–856,
2002.

Carlsson, G., Memoli, F., Ribeiro, A., and Segarra, S. Axiomatic construction of hierarchical clustering in asymmetric networks. In Acoustics, Speech and Signal Processing (ICASSP), 2013 IEEE International Conference
on, pp. 5219–5223, 2013.
Duan, R. and Pettie, S. Fast algorithms for (max, min)matrix multiplication and bottleneck shortest paths. Symposium on discrete algorithms, 2009.
Gondran, M. and Minoux, M. Graphs, dioids and semi
rings: New models and algorithms. Springer, 2008.
Gromov, M. Metric structures for Riemannian and nonRiemannian spaces. Birkhäuser Boston Inc., Boston,
MA, 2007. ISBN 978-0-8176-4582-3; 0-8176-4582-9.
Gurvich, V. and Vyalyi, M. Characterizing (quasi-) ultrametric finite spaces in terms of (directed) graphs. Discrete Applied Mathematics, 160(12):1742–1756, 2012.
Harzheim, E. Ordered sets. Springer, 2005.
Hubert, L. Min and max hierarchical clustering using
asymmetric similarity measures. Psychometrika, 38(1):
63–72, 1973.
Jain, A.K. and Dubes, R. C. Algorithms for clustering data.
Prentice Hall Advanced Reference Series. Prentice Hall
Inc., 1988.
Jardine, N. and Sibson, R. Mathematical taxonomy. John
Wiley & Sons Ltd., London, 1971. Wiley Series in Probability and Mathematical Statistics.
Lance, G. N. and Williams, W. T. A general theory of
classificatory sorting strategies 1. Hierarchical systems.
Computer Journal, 9(4):373–380, 1967.

Pentney, W. and Meila, M. Spectral clustering of biological
sequence data. Proc. Ntnl. Conf. Artificial Intel., 2005.
Saito, T. and Yadohisa, H. Data analysis of asymmetric structures: advanced approaches in computational
statistics. CRC Press, 2004.
Shi, J. and Malik, J. Normalized cuts and image segmentation. IEEE Transactions on Pattern Analysis and Machine Intelligence, 22(8):888–905, 2000.
Slater, P.B. Hierarchical internal migration regions of
france. Systems, Man and Cybernetics, IEEE Transactions on, (4):321–324, 1976.
Slater, P.B. A partial hierarchical regionalization of 3140
us counties on the basis of 1965-1970 intercounty migration. Environment and Planning A, 16(4):545–550,
1984.
Tarjan, R. E. An improved algorithm for hierarchical clustering using strong components. Inf. Process. Lett., 17
(1):37–41, 1983.
United States Census Bureau. State-to-state migration
flows. U.S. Department of Commerce, 2011. URL
http://www.census.gov/hhes/migration/
data/acs/state-to-state.html.
Vassilevska, V., Williams, R., and Yuster, R. All pairs bottleneck paths and max-min matrix products in truly subcubic time. Theory of Computing, 5:173–189, 2009.
Von Luxburg, U. A tutorial on spectral clustering. Statistics
and Computing, 17(4):395–416, 12 2007.
Zhao, Y. and Karypis, G. Hierarchical clustering algorithms for document datasets. Data Mining and Knowledge Discovery, 10:141–168, 2005.

