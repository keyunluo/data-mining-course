Convergence rates for persistence diagram estimation in Topological Data
Analysis

Frédéric Chazal
INRIA Saclay Île-de-France, Palaiseau, France

FREDERIC . CHAZAL @ INRIA . FR

Marc Glisse
INRIA Saclay Île-de-France, Palaiseau, France

MARC . GLISSE @ INRIA . FR

Catherine Labruère
Institut de Mathématiques de Bourgogne, France
Bertrand Michel
LSTA, Université Pierre et Marie Curie, Paris

Abstract
Computational topology has recently seen an important development toward data analysis, giving birth to Topological Data Analysis. Persistent homology appears as a fundamental tool in
this field. We show that the use of persistent
homology can be naturally considered in general statistical frameworks . We establish convergence rates of persistence diagrams associated to
data randomly sampled from any compact metric space to a well defined limit diagram encoding the topological features of the support of the
measure from which the data have been sampled.
Our approach relies on a recent and deep stability result for persistence that allows to relate our
problem to support estimation problems (with respect to the Gromov-Hausdorff distance). Some
numerical experiments are performed in various
contexts to illustrate our results.

1. Introduction
Motivations. During the last decades, the wide availability of measurement devices and simulation tools has led to
an explosion in the amount of available data in almost all
domains of science, industry, economy and even everyday
life. Often these data come as point clouds sampled in possibly high (or infinite) dimensional spaces. They are usually not uniformly distributed in the embedding space but
Proceedings of the 31 st International Conference on Machine
Learning, Beijing, China, 2014. JMLR: W&CP volume 32. Copyright 2014 by the author(s).

CLABRUER @ U - BOURGOGNE . FR

BERTRAND . MICHEL @ UPMC . FR

carry some geometric structure (manifold or more general
stratified space) which reflects important properties of the
“systems” from which they have been generated. Moreover, in many cases data are not embedded in Euclidean
spaces and come as (finite) sets of points with pairwise distance information. This often happens, e.g. with social network or sensor network data where each sensor may not
know its own position, but may evaluate its distance to the
other sensors using the strength of the signal received from
them. In such cases, data are given as matrices of pairwise
distances between the observations, i.e. as (discrete) metric spaces. Again, although they come as abstract spaces,
these data often carry specific topological and geometric
structures.
A large amount of research has been done on dimensionality reduction, manifold learning and geometric
inference for data embedded in Euclidean spaces and
assumed to be concentrated around submanifolds; see
for instance (Wang, 2012). However, the assumption
that data lies on a manifold may fail in many applications. In addition, the strategy of representing data by
points in Euclidean spaces may introduce large metric
distortions as the data may lie in highly curved spaces.
With the emergence of new geometric inference and
algebraic topology tools, computational topology (Edelsbrunner & Harer, 2010) has recently seen an important
development toward data analysis, giving birth to the
field of Topological Data Analysis (TDA) (Carlsson,
2009)-(https://sites.google.com/site/nips2012topology/)
whose aim is to infer relevant, multiscale, qualitative
and, quantitative topological structures directly from the
data. Topological persistence, more precisely persistent homology appears as a fundamental tool for TDA.

Convergence rates for persistence diagrams
∞

Metric data
set

Build geometric
filtered complex on
top of data

Filtered
simplicial
complex

Signature: persistence
diagram

Compute persistent
homology of the
complex.

0
0

0-dimensional homology
1-dimensional homology

Figure 1. A classical pipeline for persistence in TDA.

Roughly, homology (with coefficient in a field such as,
e.g., Z{2Z) associates to any topological space M, a
family of vector spaces (the so-called homology groups)
Hk pMq, k “ 0, 1, . . ., each of them encoding topological
features of M. The k th Betti number of M, denoted βk ,
is the dimension of Hk pMq and measures the number
of k-dimensional features of M: for example, β0 is the
number of connected components of M, β1 the number of
independent cycles or “tunnels”, β2 the number of “voids”,
etc. (see (Hatcher, 2001)). Persistent homology provides
a framework (Edelsbrunner et al., 2002)-(Zomorodian
& Carlsson, 2005)-(Chazal et al., 2012) and efficient
algorithms to encode the evolution of the homology of
families of nested topological spaces indexed by a set of
real numbers that may often be seen as scales, such as the
sublevel sets of a function, the union of growing balls, etc.
The obtained multiscale topological information is then
represented in a simple way as a barcode or persistence
diagram; see Figure 4 and Section 2.
In TDA, persistent homology has found applications in
many fields, including neuroscience (Singh et al., 2008),
bioinformatics (Kasson et al., 2007), shape classification
(Chazal et al., 2009b), clustering (Chazal et al., 2011b) and
sensor networks (De Silva & Ghrist, 2007). It is usually
computed for a filtered simplicial complex built on top
of the available data, i.e. a nested family of simplicial
complexes whose vertex set is the data set (see Section
2). The obtained persistence diagrams are then used
as “topological signatures” to exhibit and compare the
topological structure underlying the data; see Figure 1.
The relevance of this approach relies on stability results
ensuring that close data sets, with respect to the Hausdorff
or Gromov-Hausdorff distance, have close persistence
diagrams (Cohen-Steiner et al., 2005)-(Chazal et al.,
2009a)-(Chazal et al., 2012)-(Chazal et al., 2013a). However these results are not statistical and thus only provide
heuristic or exploratory uses in data analysis. Moreover,
The goal of this paper is to show that, thanks to recent results (Chazal et al., 2012)-(Chazal et al., 2013a) that allow to consider persistence diagrams associated to infinite
spaces, the use of persistent homology in TDA can be naturally considered in general statistical frameworks and persistence diagrams can be used as statistics with interesting
convergence properties.

Contribution. In this paper we assume that the available data is the realization of a probability distribution supported on an unknown compact metric space. We consider the persistent homology of different filtered simplicial complexes built on top of the data. We study, with a
minimax approach, the rate of convergence of the associated persistence diagrams to some well-defined persistence
diagram associated to the support of the probability distribution. More precisely, we assume that we observe a set
p n “ tX1 . . . , Xn u in a metric space pM, ρq,
of n points X
drawn i.i.d. from some unknown measure µ whose support is a compact set denoted Xµ Ď M. We also assume
that µ satisfies the so-called pa, bq-standard assumption for
some constants a, b ą 0: for any x P Xµ and any r ą 0,
µpBpx, rqq ě minparb , 1q. We then consider the persistent
homology of some filtered simplicial complexes FiltpXµ q
p built on top of Xµ and X
p n respectively and we
and FiltpXq
establish convergence rates to zero of the bottleneck distance between their persistence diagrams. The definition
of this distance is given in the second section. We illustrate
our results when M “ Rd and also discuss the case where
the data are corrupted by an additional Gaussian noise.
Our approach relies on the general theory of persistence
modules and our results follow from two recently proven
properties of persistence diagrams (Chazal et al., 2013a)(Chazal et al., 2009a)-(Chazal et al., 2012). First, as Xµ can
be any compact metric space (possibly infinite), the filtered
complex FiltpXµ q is usually not finite or even countable
and the existence of its persistence diagram cannot be established from the “classical” persistence theory (Zomorodian & Carlsson, 2005)-(Edelsbrunner et al., 2002). To
overcome this issue we use the general persistence framework introduced in (Chazal et al., 2009a)-(Chazal et al.,
2012). Notice that although this framework is rather abstract and theoretical, it does not have any practical drawback as only persistence diagrams of complexes built on
top of finite data are computed. Second, a fundamental
property of the persistence diagrams we are considering is
their stability proven in (Chazal et al., 2013a) that establishes a strong connection between the persistence estimation problem and more classical support estimation problems.
Related works. Although it is attracting more and more
interest, the use of persistent homology in data analysis remains widely heuristic. Despite a few promising results,
the statistical analysis of persistent homology is still in its
infancy. One of the first statistical results about persistent homology has been given in a parametric setting, by
Bubenik and Kim in (Bubenik & Kim, 2007). They show
for instance that for data sampled on an hypersphere according to a von Mises-Fisher distribution, the persistence
diagrams of the density can be estimated with the paramet-

Convergence rates for persistence diagrams

ric rate n´1{2 . However assuming that both the support
and the parametric family of the distribution are known are
strong assumptions hardly met in practice. Closer to our
approach, statistical analysis of homology has also been
proposed recently in (Balakrishnan et al., 2012) when the
geometric structure underlying the data is a smooth submanifold of an Euclidean space. The persistence diagram
of a space contains much more information than the homology of this space. So, it is not surprising that the convergence rates for the estimation of the persistence diagram
we find in this paper are much slower than the convergence
rates of (Balakrishnan et al., 2012) for the estimation of
the homology. Our approach is also strongly connected to
manifold estimation results obtained in (Genovese et al.,
2012b). Our results extend to persistent homology and allow us to deal with general compact metric spaces. Still in
the manifold setting, (Balakrishnan et al., 2013) develops
several methods to find confidence sets for persistence diagrams using subsampling methods and kernel estimators
among other approaches.
Both (Balakrishnan et al., 2013) and our work start from the
observation that persistence diagram inference is strongly
connected to the better known problem of measure support
estimation. As far as we know, only few results about support estimation in general metric spaces are available. For
example (De Vito et al., 2012) proposes kernel methods to
tackle the support estimation problem. On the other hand,
a large amount of literature is available for support estimation in Rd ; see for instance the review in (Cuevas, 2009).
p n “ tX1 , . . . Xn u
The convergence rate of the estimator X
to the support of the measure µ with respect to the Hausdorff distance is given in (Cuevas & Rodrı́guez-Casal,
2004) in Rd . Support estimation in Rd has also been studied under various additional assumptions such as convexity
assumptions (Rodrı́guez-Casal, 2007) or through boundary
fragments estimation (Korostelëv & Tsybakov, 1993) just
to name a few. When the measure has a density with respect to the Lebesgue measure, plug-in methods based on
non parametric estimators have been proposed in (Cuevas
& Fraiman, 1997) and (Tsybakov, 1997).
A few different methods have also been proposed for
topology estimation in non-deterministic frameworks such
as those based on deconvolution (Caillerie et al., 2011)(Niyogi et al., 2011). Several recent attempts have also
been made, with completely different approaches, to study
persistence diagrams from a statistical point of view, such
as (Mileyko et al., 2011) that studies probability measures
on the space of persistence diagrams or (Bubenik, 2012)
that introduces a functional representation of persistence
diagrams, the so-called persistence landscapes, allowing
means and variance of persistence diagrams to be defined.
Notice that our results should easily extend to persistence
landscapes.

Figure 2. From left to right: the α sublevelset of the distance
function to a point set X in R2 , the α-complex, Cechα pXq and
Rips2α pXq. The last two include a tetrahedron.

ε

∆

death
birth

Figure 3. Two diagrams at bottleneck distance ε.

Organization of the paper. The necessary background
material is presented in Section 2. The convergence results
are established in Section 3 for general metric spaces and in
Section 4 for measures supported in Rd . Some numerical
experiments are given in Section 5. All the proofs of the
results are available in (Chazal et al., 2013b).

2. Background and notations
Measured metric spaces. Let us denote pM, ρq a metric space, KpMq the set of all the compact subsets of M,
and dH pC1 , C2 q the Hausdorff distance between two subsets C1 , C2 P KpMq (Burago et al., 2001). Note that
pKpMq, dH q is a metric space. Two compact metric spaces
pM1 , ρ1 q and pM2 , ρ2 q are isometric if there exists a bijection Φ : M1 Ñ M2 that preserves distances. One way to
compare two metric spaces is to measure how far these two
metric spaces are from being isometric. The corresponding
distance is called the Gromov-Hausdorff distance (Burago
et al., 2001). Intuitively, it is the infimum of their Hausdorff
distance over all possible isometric embeddings of these
two spaces into a common metric space. The GromovHausdorff distance dGH defines a metric on the space K
of isometry classes of compact metric spaces (see Theorem 7.3.30 in (Burago et al., 2001)). Notice that when M1
and M2 are subspaces of a same metric space pM, ρq then
dGH pM1 , M2 q ď dH pM1 , M2 q.
Let µ be a probability measure on pM, ρq equipped with its
Borel algebra. Let Xµ denote the support of the measure µ,
namely the smallest closed set with probability one. In the
following of the paper, we will assume that Xµ is compact
and thus Xµ P KpMq. Also note that pXµ , ρq P K.

Convergence rates for persistence diagrams

Geometric complexes. The geometric complexes we
consider in this paper are built on top of metric spaces and
come as nested families indexed by a real parameter. Topological persistence is used to infer and encode the evolution
of the topology of theses families as the parameter grows.
For a complete definition of these geometric filtered complexes and their use in TDA, we refer to (Chazal et al.,
2013a), Section 4.2. Here, we only give a brief reminder
and refer to Figure 2 for illustrations. A simplicial complex C is a set of simplexes (points, segments, triangles,
etc) such that any face from a simplex in C is also in C and
the intersection of any two simplexes of C is a (possibly
empty) face of these simplexes. We do not assume such
simplicial complexes to be finite. The complexes considered in this paper can be seen as a generalization of neighborhood graphs in dimension larger than 1.
Given a metric space X which will also serve as the vertex
set, the Vietoris-Rips complex Ripsα pXq is the set of simplexes rx0 , . . . , xk s such that dX pxi , xj q ď α for all pi, jq.
The Čech complex Cechα pXq is similarly defined as the set
of simplexes rx0 , . . . , xk s such that the k ` 1 closed balls
Bpxi , αq have a non-empty intersection. Note that these
two families of complexes only depend on the pairwise distances between the points of X.
When X is embedded in Rd , we can extend the definition
of the Čech complex to the set of simplexes rx0 , . . . , xk s
such that the k ` 1 closed balls Bpxi , αq have a non-empty
intersection in Rd (not just in X). We also define the αcomplex as the set of simplexes rx0 , . . . , xk s such that, for
some β ď α that depends on the simplex, the k ` 1 closed
balls Bpxi , βq and the complement of all the other balls
Bpx, βq for x P X have a non-empty intersection in Rd
(equivalently, there exists a ball of radius at most α in Rd
such that x0 , . . . , xk are on its boundary and the interior
of the ball contains no point of X). Those two complexes
have the same homology as the union of the balls Bpx, αq
for x P X (see Figure 2). The α-complex is a subcomplex of the Delaunay triangulation and thus only contains
simplexes of dimension at most d. The union of the balls
Bpx, αq is also the α-sublevel set of the distance function to
X, dp¨, Xq, and as a consequence, those filtrations provide
a convenient way to study the evolution of the topology of
the union of growing balls or the sublevel sets of dp¨, Xq
(see Figure 2 and Section 5).
All these families of complexes are non-decreasing with
α: for any α ď β, there is an inclusion of Ripsα pXq in
Ripsβ pXq, and similarly for the Čech, and Alpha complexes. They are called filtrations. In the following, the
notation FiltpXq :“ pFiltα pXqqαPA denotes one of the filtrations defined above.

connected component
cycle

death
birth

Figure 4. An α-complex filtration, the sublevelset filtration of the
distance function, and their common persistence barcode.

Persistence diagrams. An extensive presentation of persistence diagrams is available in (Chazal et al., 2012). We
recall a few definitions and results needed in this paper and
give the intuition behind persistence.
Given a filtration, the topology of Filtα pXq changes as α
increases: new connected components can appear, existing
connected components can merge, cycles and cavities can
appear or be filled, etc. Persistent homology tracks these
changes, identifies features and associates an interval or
lifetime (from αbirth to αdeath ) to them. For instance, a connected component is a feature that is born at the smallest
α such that the component is present in Filtα pXq, and dies
when it merges with an older connected component. Intuitively, the longer a feature persists, the more relevant it
is.
A feature, or more precisely its lifetime, can be represented
as a segment whose extremities have abscissae αbirth and
αdeath ; the set of these segments is called the barcode of
FiltpXq. An interval can also be represented as a point
in the plane with coordinates pαbirth , αdeath q (see Figure 4).
The set of points (with multiplicity) representing the intervals is called the persistence diagram dgpFiltpXqq. Note
that the diagram is entirely contained in the half-plane
above the diagonal ∆ defined by y “ x, since death always occurs after birth. (Chazal et al., 2012) shows that this
diagram is still well-defined under very weak hypotheses,
and in particular dgpFiltpXqq is well-defined for any compact metric space X (Chazal et al., 2013a). The most persistent features (supposedly the most important) are those
represented by the points furthest from the diagonal in the
diagram, whereas points close to the diagonal can be interpreted as (topological) noise.
The space of persistence diagrams is endowed with a metric
called the bottleneck distance db . Given two persistence
diagrams, it is defined as the infimum of the δ for which we
can find a matching between the diagrams, such that two
points can only be matched if their distance is less than δ
and all points at distance more than δ from the diagonal
must be matched (see Figure 3). Note that points close
to the diagonal ∆ are easily ignored, which fits with their
interpretation as irrelevant noise.

Convergence rates for persistence diagrams

A fundamental property of persistence diagrams, proven in
(Chazal et al., 2012), is their stability. If X and X̃ are two
compact metric spaces then one has
´
¯
´
¯
db dgpFiltpXqq, dgpFiltpX̃qq ď 2dGH X, X̃ . (1)
Moreover, if X and X̃ are embedded in the same space
pM, ρq then (1) holds for dH in place of dGH . Note that these
properties are metric: they do not involve any probability
measure on X and X̃.

3. Persistence diagrams estimation in metric
spaces
Let pM, ρq be a metric space. Assume that we observe n
points X1 . . . , Xn in M drawn i.i.d. from some unknown
measure µ whose support is a compact set denoted Xµ . The
Gromov-Hausdorff distance allows us to compare Xµ with
compact metric spaces not necessarily embedded in M. We
thus consider pXµ , ρq as an element of K (rather than an
p of Xµ
element of KpMq). In the following, an estimator X
is a function of X1 . . . , Xn that takes values in K and is
measurable for the Borel algebra induced by dGH .
p be two filtrations defined on Xµ
Let FiltpXµ q and FiltpXq
p
and X. The statistical analysis of persistence diagrams proposed below starts from the following key fact: according
to (1), for any ε ą 0:

´ ´
¯
¯
p
P db dgpFiltpXµ qq, dgpFiltpXqq
ąε
´
¯
p ą 2ε
ď P dGH pXµ , Xq

(2)

where the probability corresponds to the product measure
µbn . Our strategy then consists in estimating the support
Xµ with respect to the dGH distance. Note that this general strategy of estimating Xµ in K is not only of theoretical interest. Indeed, as mentioned in the introduction,
in some cases the space M is unknown and the observations X1 . . . , Xn are just known through their pairwise distances ρpXi , Xj q, i, j “ 1, ¨ ¨ ¨ , n. The use of the GromovHausdorff distance then allows us to consider this set of observations as an abstract metric space of cardinality n, independently of the way it is embedded in M. This general
framework includes the more standard approach consisting in estimating the support with respect to the Hausdorff
p to KpMq. Using
distance by restraining the values of X
equation (2), the problem of persistence diagrams estimation reduces to the better known problem of estimating the
support of a measure.
p n :“ tX1 , . . . , Xn u be a set of independent observaLet X
tions endowed with the restriction of the distance ρ to this

set. This finite metric space is a natural estimator of the
support Xµ . In several contexts discussed in the following,
p n shows optimal rates of convergence to Xµ with respect
X
to the Hausdorff and Gromov-Hausdorff distance. From (2)
we then obtain upper bounds on the rate of convergence of
p n q. We also obtain the corresponding lower bounds
FiltpX
to prove optimality.
p n in Gromov-Hausdorff disThe rate of convergence of X
tance for probability measures µ satisfying an pa, dqstandard assumption is obtained using classical covering
arguments - see, e.g. (Cuevas & Rodrı́guez-Casal, 2004;
Niyogi et al., 2008). We then derive the following result
for persistence diagram estimation.
Theorem 1. Assume that the probability measure µ on M
satisfies the pa, bq-standard assumption, then for any ε ą
0:

´ ´
¯
¯
p n qq ą ε
P db dgpFiltpXµ qq, dgpFiltpX
˙
ˆ b
2
b
expp´naε q, 1 .
ď min
aεb

(3)

Moreover,
ˆ
˙1{b ´
¯
n
p n qq ď C1
lim sup
db dgpFiltpXµ qq, dgpFiltpX
log n
nÑ8
almost surely, and
˜
˙1{b¸
ˆ
´
¯
log
n
p n qq ď C2
P db dgpFiltpXµ qq, dgpFiltpX
n
converges to 1 when n Ñ 8, where C1 and C2 only depend
on a and b.
Let P “ Ppa, b, Mq be the set of all the probability
measures on the metric space pM, ρq satisfying the pa, bqstandard assumption on M:
P :“

tµ on M | Xµ is compact and @x P Xµ ,
`
˘
@r ą 0, µ pBpx, rqq ě min 1, arb u.

The next theorem gives upper and lower bounds for the rate
of convergence of persistence diagrams. The upper bound
is a consequence of Theorem 1, while the lower bound is
established using Le Cam’s lemma.
Theorem 2. Let pM, ρq be a metric space and let a ą 0
and b ą 0. Then:
ˆ
˙1{b
”
ı
log n
p
sup E db pdgpFiltpXµ qq, dgpFiltpXn qqq ď C
n
µPP
(4)

Convergence rates for persistence diagrams

where the constant C only depends on a and b (not on M).
Assume moreover that there exists a non isolated point x
N
in M and consider any sequence pxn q P pMztxuq such
x of
that ρpx, xn q ď panq´1{b . Then for any estimator dg
n
dgpFiltpXµ qq:
”
ı
x q ě C1
lim inf ρpx, xn q´1 sup E db pdgpFiltpXµ qq, dg
n
nÑ8

µPP

where C 1 is an absolute constant.
p n qq is minimax opConsequently, the estimator dgpFiltpX
timal on the space Ppa, b, Mq up to a logarithmic term as
soon as we can find a non-isolated point in M and a sequence pxn q in M such that ρpxn , xq „ panq´1{b . This is
obviously the case for the Euclidean space Rd .
Remark. Theorem 1 can also be used to find confidence
sets for persistence diagrams. Such confidence sets depend
on a and b which may be unknown and whose estimation is
beyond the scope of this paper. Alternative solutions have
been proposed recently in (Balakrishnan et al., 2013).

4. Persistence diagram estimation in Rk
Persistence diagram estimation for nonsingular measures in Rk . Paper (Singh et al., 2009) is a significant
breakthrough for level set estimation through density estimation. It presents a fully data-driven procedure, in the
spirit of Lepski’s method, that is adaptive to unknown local
density regularity and achieves a Hausdorff error control
that is minimax optimal for a class of level sets with very
general shapes. In this section, we study persistence diagram inference in the framework of (Singh et al., 2009).
Nevertheless, we do not use the estimator of (Singh et al.,
2009) for this task since we only consider here the support
estimation problem (and not the more general level set issue as in (Singh et al., 2009)). Let X1 , . . . , Xn be i.i.d.
observations drawn from an unknown probability measure
µ having density f with respect to the Lebesgue measure
on Rk . Let Xf :“ Xµ be the support of µ and let G0 :“
tx P Rk | f pxq ą 0u. The boundaryŤof a set G is denoted
BG and for any ε ą 0, Iε pGq :“ x | Bpx,εqĂG Bpx, εq
is the ε-inner of G. We denote by Fpαq the set composed
of all the densities which supports are included in a fixed
compact domain χ and satisfy the two following assumptions rAs and rBs, for fixed positive constants Ca , Cb :
rAs : The density f is upper bounded by fmax ą 0 and
there exist constants α, Ca , δa ą 0 such that for all
x P G0 with f pxq ď δa , f pxq ě Ca dpx, BG0 qα .
rBs : There exist constants ε0 ą 0 and Cb ą 0 such that
for all ε ď ε0 , Iε pG0 q ‰ H and dpx, Iε pG0 qq ď Cb ε
for all x P BG0 .

Assumption rAs describes how fast the density increases
in the neighborhood of the boundary of the support: the
smaller α, the easier the support may be possible to detect.
Assumption rBs prevents the boundary from having arbitrarily small features (as for cusps). Under assumptions rAs
and rBs, the measure µ also satisfies the standard assumption with b “ α ` k. Moreover, G0 and the support Xf are
almost identical in the sense that dH pG0 , Xf q “ 0. As a
consequence, we obtain from Theorem 2 that the estimator
p n qq converges in expectation to dgpFiltpXf qq for
dgpFiltpX
db with a rate upper bounded by plog n{nq1{pk`αq . Moreover, this rate is minimax over the sets Fpαq.
Persistence diagram estimation for singular measures
in RD . We now consider the case where the support of µ
is a smooth submanifold of RD . As far as we know, rates of
convergence for manifold estimation have only been studied recently in (Genovese et al., 2012b) and (Genovese
et al., 2012a) under several noise models that can be considered in the context of persistence diagram estimation.
However, for the sake of simplicity, we only study here
the noiseless model considered in (Genovese et al., 2012b).
For a fixed positive integer k ă D, for some fixed positive constants b, B, κ and for a fixed compact domain χ
in RD , let H :“ Hpd, A, B, κ, χq be the set of probability measures on χ satisfying the two assumptions of (Genovese et al., 2012b): µ is in H if and only if Xµ is a kdimensional manifold whose reach - a measure of the regularity of Xµ , see Section 2 in (Genovese et al., 2012b) is lower bounded by κ and if µ has a density g with respect to the k-dimensional volume measure on Xµ , such
that 0 ă A ď inf yPXµ gpyq ď supyPXµ gpyq ď B ă 8.
Under these two assumptions, µ satisfies the standard assumption with b “ k. Thus, if we take X̂n for estimating
the support Xµ in this context, we obtain a rate of convergence upper bounded by p logn n q1{k both for support and
persistence diagram estimation. Nevertheless, this rate is
not minimax optimal on the space H, as shown by Theorem 2 in (Genovese et al., 2012b). The correct minimax
rate is n´2{k for both estimation problems. However, the
achievement of the optimal rate relies on a “theoretical” estimator that cannot be computed in practice.
Additive noise. To finish this section, we shortly discuss
the additive Gaussian noise model: we now assume that
the data are of the form Yi “ Xi ` εi where X1 , . . . Xn
are sampled according to a measure µ as in the previous
paragraph and where ε1 , . . . , εn are i.i.d. standard Gaussian random variables. We deduce from the results given
in (Genovese et al., 2012b) in this context that the minimax
convergence rates for the persistence diagram estimation is
upper bounded by some rate of the order of plog nq´1{2 .
However, giving a tight lower bound for this problem appears to be more difficult than for the support estimation.

Convergence rates for persistence diagrams

Figure 5. Left: the space M1 . Middle: in blue the persistence diagram dgpM1 q of the distance to M1 (1-dimensional homology); in red
a persistence diagram of the α-filtration built on top of n “ 14000 points randomly sampled on M1 . Right: the log of the estimated
expectation of the bottleneck distance between the estimated diagrams and dgpM1 q as a function of logplogpnq{nq.

5. Experiments

(Edelsbrunner, 1995). So, for each n we computed the average bottleneck distance between the obtained diagrams
and the persistence diagram dgpM1 q of the distance to M1
which is known exactly and represented in blue on Figure
5, middle. For each n, the average bottleneck distance between dgpM1 q and the persistence diagrams obtained for
the k “ 100 randomly sampled
” sets Xn of size n has beenı
p n qqq
used as an estimate Ê of E db pdgpM1 q, dgpCα pX

A few experiments were conducted in order to illustrate our
results and the behavior of the persistence diagrams under
sampling of metric spaces. We consider two different metric spaces, denoted M1 and M2 hereafter. M1 is the torus
of revolution in R3 with parametric equations xpu, vq “
p5 ` cospuqq cospvq, ypu, vq “ p5 ` cospuqq sinpvq and
zpu, vq “ sinpuq, pu, vq P r0, 2πs2 (see Figure 5, left). Its
metric is the restriction of the Euclidean metric in R3 and
it is endowed with the push forward by the parametrization of the uniform measure on the square r0, 2πs2 . M2
is a space of images: we used a 3D character from the
SCAPE database (Anguelov et al., 2005) and considered
all the images of this character from a view rotating around
a fixed vertical axis. We converted these images in gray
color and resized these images to 300 ˆ 400 “ 120, 000
pixels (see Figure 6). Each is then identified with a point in
R120,000 where the ith coordinate is the level of gray of the
ith pixel. The metric space M2 is the obtained subset with
the restriction of the Euclidean metric in R120,000 . As it is
parametrized by a circular set of views, it is endowed with
the push forward of the uniform measure on the circle.

where Cα denotes the α-complex filtration. logpÊq is plotted as a function of logplogpnq{nq on Figure 5, right. As
expected, since the the torus is 2-dimensional, the points
are close to a line of slope 1{2.
For M2 , as it is embedded in a very high dimensional space,
computing the α-complex is out of reach. So, we computed
the persistence diagrams for the 1-dimensional homology
of the Vietoris-Rips complex built on top of the sampled
sets. As in that case the exact persistence diagram of the
Vietoris-Rips filtration built on top of M2 is not known, we
only computed the 1-dimensional homology persistence diagrams of the Vietoris-Rips filtrations built on top of 20 sets
of 250 points each, randomly sampled on M2 . All these diagrams have been plotted on the same Figure 6, middle.
The right of Figure 6 represents a 2D embedding of one
of the 250 points sampled data set using the Multidimensional Scaling algorithm (MDS). Since M2 is a set of images taken according to a rotating viewpoint, it carries a
circular structure highlighted by the MDS embedding. The
persistence diagrams that all have one point clearly off the
diagonal assert the presence of a cycle in M2 .

Table 1. Sampling parameters (where rn : h : ms denotes the set
tn, n ` h, ¨ ¨ ¨ mu).

Space
M1
M2

k
100
20

n
r4000 : 500 : 8500s
250

Geom. complex
α-complex
Vietoris-Rips

From each of the measured metric spaces M1 and M2 ,
we sampled k sets of n points for different values of n
from which we computed persistence diagrams for different geometric complexes (see Table 1). For M1 we have
computed the persistence diagrams for the 1-dimensional
homology of the α-complex built on top of the sampled
sets. As α-complexes have the same homology as the corresponding union of balls, these persistence diagrams are
the ones of the distance function to the sampled point set

6. Discussion and future works
In previous works, persistent homology in TDA has been
mainly considered with a non statistical approach, where
persistence diagrams are used as exploratory tools to analyze the topological structure of data. The results we obtain
open the door to a rigorous use of persistence diagrams in
statistical frameworks.

Convergence rates for persistence diagrams

Figure 6. Left: Images sampled from M2 . Middle: on the same figure the 1-dimensional homology persistence diagrams of the VietorisRips filtration of 20 sets of 250 points sampled on M2 . Right: the plot of the embedding of M2 in R2 using MDS.

Since our approach is based on very general recent stability results in persistence theory, it can be adapted to other
frameworks. For example, building on ideas developed
in (Chazal et al., 2011a) and (Caillerie et al., 2011), it is
possible to extend our results to persistence diagram estimation for data corrupted by different kinds of noise using Wasserstein deconvolution methods. In another direction, an interesting representation of persistence diagrams
as elements of a Hilbert space has recently been proposed
in (Bubenik, 2012). Our results easily extend to this representation called persistence landscapes. Following this
point of view, we also intend to adapt classical kernel-based
methods with kernels carrying topological information.

References
Anguelov, D., Srinivasan, P., Koller, D., Thrun, S.,
Rodgers, J., and Davis, J. SCAPE: shape completion
and animation of people. In Proceedings of SIGGRAPH,
pp. 408–416, 2005.
Balakrishnan, S., Rinaldo, A., Sheehy, D., Singh, A., and
Wasserman, L. A. Minimax rates for homology inference. Journal of Machine Learning Research - Proceedings Track, 22:64–72, 2012.
Balakrishnan, S., Fasy, B.and Lecci, F., Rinaldo, A., Singh,
A., and Wasserman, L. Statistical inference for persistent
homology. arXiv preprint arXiv:1303.7117, 2013.
Bubenik, P. Statistical topology using persistence landscapes. ArXiv e-prints, July 2012.
Bubenik, P. and Kim, P. T. A statistical approach to persistent homology. Homology, Homotopy and Applications,
9(2):337–362, 2007.
Burago, D., Burago, Y., and Ivanov, S. A course in metric
geometry, volume 33. Amer. Math. Soc., 2001.

Caillerie, C., Chazal, F., Dedecker, J., and Michel, B. Deconvolution for the Wasserstein metric and geometric inference. Electronic Journal of Statistics, 5:1394–1423,
2011.
Carlsson, G. Topology and data. AMS Bulletin, 46(2):255–
308, 2009.
Chazal, F., Cohen-Steiner, D., Glisse, M., Guibas, L.J., and
Oudot, S.Y. Proximity of persistence modules and their
diagrams. In SCG, pp. 237–246, 2009a. ISBN 978-160558-501-7. doi: http://doi.acm.org/10.1145/1542362.
1542407.
Chazal, F., Cohen-Steiner, D., Guibas, L. J., Memoli, F.,
and Oudot, S. Y. Gromov-Hausdorff stable signatures
for shapes using persistence. Computer Graphics Forum,
pp. 1393–1403, 2009b.
Chazal, F., Cohen-Steiner, D., and Mérigot, Q. Geometric inference for probability measures. Foundations of
Computational Mathematics, 11(6):733–751, 2011a.
Chazal, F., Guibas, L. J., Oudot, S., and Skraba, P.
Persistence-based clustering in Riemannian manifolds.
In Proc. of the 27th ACM Symp. on Computational Geometry, 2011b.
Chazal, F., de Silva, V., Glisse, M., and Oudot, S. The
structure and stability of persistence modules. arXiv
preprint arXiv:1207.3674, 2012.
Chazal, F., de Silva, V., and Oudot, S. Persistence stability for geometric complexes. Geometriae Dedicata (to
appear - online first Dec. 2013), 2013a.
Chazal, Frédéric, Glisse, Marc, Labruère, Catherine, and
Michel, Bertrand. Optimal rates of convergence for persistence diagrams in topological data analysis. arXiv
preprint arXiv:1305.6239, 2013b.

Convergence rates for persistence diagrams

Cohen-Steiner, D., Edelsbrunner, H., and Harer, J. Stability
of persistence diagrams. In SCG, pp. 263–271, 2005.
Cuevas, A. Set estimation: another bridge between statistics and geometry. Bol. Estad. Investig. Oper., 25(2):
71–85, 2009. ISSN 1889-3805.
Cuevas, A. and Fraiman, R. A plug-in approach to support
estimation. Ann. Stat., 25(6):2300–2312, 1997.
Cuevas, A. and Rodrı́guez-Casal, A. On boundary estimation. Adv. in Appl. Prob., 36(2):340–354, 2004.
De Silva, V. and Ghrist, R. Homological sensor networks.
Notices of the American Math Soc, 54(1), 2007.
De Vito, E., Rosasco, L., and Toigo, A. Learning sets
with separating kernels, 2012. URL http://arxiv.
org/abs/1204.3573. submitted.
Edelsbrunner, H. The union of balls and its dual shape.
Discrete Comput. Geom., 13(1):415–440, 1995.
Edelsbrunner, H. and Harer, J. Computational topology:
an introduction. American Math. Soc., 2010.
Edelsbrunner, H., Letscher, D., and Zomorodian, A. Topological persistence and simplification. Discrete Comput.
Geom., 28:511–533, 2002.
Genovese, C., Perone-Pacifico, M., Verdinelli, I., and
Wasserman, L. Minimax manifold estimation. Journal of
Machine Learning Research, 13:1263–1291, july 2012a.
Genovese, C. R., Perone-Pacifico, M., Verdinelli, I., and
Wasserman, L. Manifold estimation and singular deconvolution under hausdorff loss. Ann. Statist., 40:941–963,
2012b.
Hatcher, A. Algebraic Topology. Cambridge Univ. Press,
2001.
https://sites.google.com/site/nips2012topology/.
Nips
2012 workshop on alg. topol. and machine learning.
Kasson, P. M., Zomorodian, A., Park, S., Singhal, N.,
Guibas, L. J., and Pande, V. S. Persistent voids: a new
structural metric for membrane fusion. Bioinformatics,
23(14):1753–1759, 2007.
Korostelëv, A. P. and Tsybakov, A. B. Minimax theory
of image reconstruction, volume 82 of Lecture Notes in
Statistics. Springer-Verlag, New York, 1993.
Mileyko, Y., Mukherjee, S., and Harer, John. Probability
measures on the space of persistence diagrams. Inverse
Problems, 27(12), 2011.

Niyogi, P., Smale, S., and Weinberger, S. Finding the homology of submanifolds with high confidence from random samples. Discrete & Computational Geometry, 39
(1-3):419–441, March 2008.
Niyogi, P., Smale, S., and Weinberger, S. A topological
view of unsupervised learning from noisy data. SIAM
Journal on Computing, 40(3):646–663, 2011.
Rodrı́guez-Casal, A. Set estimation under convexity type
assumptions. Annales de l’Institut Henri Poincare (B)
Probability and Statistics, 43(6):763 – 774, 2007.
Singh, A., Scott, C., and Nowak, R. Adaptive Hausdorff
estimation of density level sets. Ann. Stat., 37(5B):2760–
2782, 2009.
Singh, G., Memoli, F., Ishkhanov, T., Sapiro, G., Carlsson,
G., and Ringach, D. L. Topological analysis of population activity in visual cortex. Journal of vision, 8(8),
2008.
Tsybakov, A. B. On nonparametric estimation of density
level sets. Ann. Statist., 25(3):948–969, 1997.
Wang, J. Geometric structure of high-dimensional data and
dimensionality reduction. Springer, 2012.
Zomorodian, A. and Carlsson, G. Computing persistent
homology. Disc. Comp. Geom., 33(2):249–274, 2005.

