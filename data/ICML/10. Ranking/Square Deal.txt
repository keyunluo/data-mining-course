Square Deal: Lower Bounds and Improved Relaxations for Tensor Recovery

Cun Mu1
CM 3052@ COLUMBIA . EDU
Bo Huang1
BH 2359@ COLUMBIA . EDU
John Wright2
JOHNWRIGHT @ EE . COLUMBIA . EDU
Donald Goldfarb1
GOLDFARB @ COLUMBIA . EDU
1
Department of Industrial Engineering and Operations Research, Columbia University
2
Department of Electrical Engineering, Columbia University

Abstract
Recovering a low-rank tensor from incomplete
information is a recurring problem in signal processing and machine learning. The most popular convex relaxation of this problem minimizes
the sum of the nuclear norms (SNN) of the unfolding matrices of the tensor. We show that this
approach can be substantially suboptimal: reliably recovering a K-way n×n×· · · ×n tensor
of Tucker rank (r, r, . . . , r) from Gaussian measurements requires Ω(rnK−1 ) observations. In
contrast, a certain (intractable) nonconvex formulation needs only O(rK +nrK) observations.
We introduce a simple, new convex relaxation,
which partially bridges this gap. Our new formulation succeeds with O(rbK/2c ndK/2e ) observations. The lower bound for the SNN model follows from our new result on recovering signals
with multiple structures (e.g. sparse, low rank),
which indicates the significant suboptimality of
the common approach of minimizing the sum of
individual sparsity inducing norms (e.g. `1 , nuclear norm). Our new tractable formulation for
low-rank tensor recovery shows how the sample
complexity can be reduced by designing convex
regularizers that exploit several structures jointly.

1. Introduction
Tensors arise naturally in problems where the goal is to
estimate a multi-dimensional object whose entries are indexed by several continuous or discrete variables. For example, a video is indexed by two spatial variables and one
temporal variable; a hyperspectral datacube is indexed by
two spatial variables and a frequency/wavelength variable.
Proceedings of the 31 st International Conference on Machine
Learning, Beijing, China, 2014. JMLR: W&CP volume 32. Copyright 2014 by the author(s).

While tensors often reside in extremely high-dimensional
data spaces, in many applications, the tensor of interest is
low-rank, or approximately so (Kolda & Bader, 2009), and
hence has much lower-dimensional structure. The general
problem of estimating a low-rank tensor has applications
in many different areas, both theoretical and applied: e.g.,
estimating latent variable graphical models (Anandkumar
et al., 2012), classifying audio (Mesgarani et al., 2006),
mining text (Cohen & Collins, 2012), processing radar signals (Nion & Sidiropoulos, 2010), multilinear multitask
learning (Romera-Paredes et al., 2013) , to name a few.
We consider the problem of recovering a K-way tensor
X ∈ Rn1 ×n2 ×···×nK from linear measurements
z =
QK
G[X ] ∈ Rm . Typically, m  N =
n
,
and
so
i
i=1
the problem of recovering X from z is ill-posed. In the
past few years, tremendous progress has been made in understanding how to exploit structural assumptions such as
sparsity for vectors (Candès et al., 2006) or low-rankness
for matrices (Recht et al., 2010) to develop computationally tractable methods for tackling ill-posed inverse problems. In many situations, convex optimization can estimate a structured object from near-minimal sets of observations (Negahban et al., 2012; Chandrasekaran et al., 2012;
Amelunxen et al., 2013). For example, an n × n matrix
of rank r can, with high probability, be exactly recovered
from Cnr generic linearP
measurements, by minimizing the
nuclear norm kXk∗ = i σi (X). Since a rank r matrix
has r(2n − r) degrees of freedom, this is nearly optimal.
In contrast, the correct generalization of these results to
low-rank tensors is not obvious. The numerical algebra
of tensors is fraught with hardness results (Hillar & Lim,
2013). For example, even computing a tensor’s (CP) rank,
Xr

(i)
(i) 	
rankcp (X ) := min r | X =
a1 ◦ · · · ◦ aK ,
i=1

is NP-hard in general. The nuclear norm of a tensor is also
intractable, and so we cannot simply follow the formula
that has worked for vectors and matrices.
With an eye towards numerical computation, many re-

Square Deal: Lower Bounds and Improved Relaxations for Tensor Recovery

searchers have studied how to recover tensors of small
Tucker rank (Tucker, 1966). The Tucker rank of a K-way
tensor X is a K-dimensional vector whose i-th entry is the
(matrix) rank of the mode-i unfolding X (i) of X :

ranktc (X ) := rank(X (1) ), · · · , rank(X (K) ) .

(1.1)

Q

Here, the matrix X (i) ∈ Rni × j6=i nj is obtained by concatenating all the mode-i fibers of X as column vectors.
Each mode-i fiber is an ni -dimensional vector obtained by
fixing every index of X but the i-th one. The Tucker rank
of X can be computed efficiently using the (matrix) singular value decomposition. For this reason, we focus on
tensors of low Tucker rank. However, we will see that our
proposed regularization strategy also automatically adapts
to recover tensors of low CP rank, with some reduction in
the required number of measurements.
The definition (1.1) suggests a natural, tractable convex approach to recovering
tensors: seek the X that

 low-rank
P
minimizes i λi X (i) ∗ out of all X satisfying G[X ] =
z. We will refer to this as the sum-of-nuclear-norms (SNN)
model. Originally proposed in (Liu et al., 2009), this approach has been widely studied (Gandy et al., 2011; Signoretto et al., 2010; 2013; Tomioka et al., 2011) and applied to various datasets in imaging (Semerci et al., 2013;
Kreimer & Sacchi, 2013; Li & Li, 2010; Li et al., 2010).
Perhaps surprisingly, we show that this natural approach
can be substantially suboptimal. Moreover, we will suggest a simple new convex regularizer with provably better performance. Suppose n1 = · · · = nK = n, and
ranktc (X )  (r, r, . . . , r). Let Tr denote the set of all
such tensors.1 We will consider the problem of estimating an element X 0 of Tr from Gaussian measurements G
(i.e., zi = hG i , X i, where G i has i.i.d. standard normal entries). To describe a generic tensor in Tr , we need at most
rK + rnK parameters. In Section 2, we show that a certain
nonconvex strategy can recover all X ∈ Tr exactly when
m > (2r)K + 2nrK. In contrast, the best known theoretical guarantee for SNN minimization, due to Tomioka
et al. (2011), shows that X 0 ∈ Tr can be recovered (or accurately estimated) from Gaussian measurements G, provided m = Ω(rnK−1 ). In Section 3, we prove that this
number of measurements is also necessary: accurate recovery is unlikely unless m = Ω(rnK−1 ). Thus, there
is a substantial gap between an ideal nonconvex approach
and the best known tractable surrogate. In Section 4, we
introduce a simple alternative, which we call the square reshaping model, which reduces the required number of measurements to O(rbK/2c ndK/2e ). For K > 3, we obtain an
improvement of a multiplicative factor polynomial in n.
1

To keep the presentation in this paper compact, we state most
of our results regarding tensors in Tr , although it is not difficult
to modify them for general tensors.

Our theoretical results pertain to Gaussian operators G. The
motivation for studying Gaussian measurements is twofold.
First, Gaussian measurements may be of interest for compressed sensing recovery (Donoho, 2006), either directly
as a measurement strategy, or indirectly due to universality phenomena (Bayati et al., 2012). Second, the available theoretical tools for Gaussian measurements are very
sharp, allowing us to rigorously investigate the efficacy of
various regularization schemes, and prove both upper and
lower bounds on the number of observations required. In
Section 5, we demonstrate that our qualitative conclusions
carry over to more realistic measurement models, such as
random subsampling (Liu et al., 2009). We expect our results to be of great interest for a wide range of problems
in tensor completion (Liu et al., 2009), robust tensor recovery/decomposition (Li et al., 2010; Goldfarb & Qin, 2014)
and sensing.
Our technical approach draws on, and enriches, the literature on general structured model recovery. The surprisingly poor behavior of the SNN model is an example of a
phenomenon first discovered by Oymak et al. (2012): for
recovering objects with multiple structures, a combination
of structure-inducing norms is often not significantly more
powerful than the best individual structure-inducing norm.
Our lower bound for the SNN model follows from a general
result of this nature, which we prove using the novel geometric framework of (Amelunxen et al., 2013). Compared
to (Oymak et al., 2012), our result pertains to a more general family of regularizers, and gives sharper constants. In
addition, for low-rank tensor recovery problem, we demonstrate the possibility to reduce the number of generic measurements through a new convex regularizer that exploits
several sparse structures jointly.

2. Bounds for Non-Convex Recovery
In this section, we introduce a non-convex model for tensor
recovery, and show that it recovers low-rank tensors from
near-minimal number of measurements.
For a tensor of low Tucker rank, the matrix unfolding along
each mode is low-rank. Suppose we observe G[X 0 ] ∈ Rm .
We would like to attempt to recover X 0 by minimizing
some combination of the ranks of the unfoldings, over all
tensors X that are consistent with our observations. This
suggests a vector optimization problem:
min

(w.r.t. RK
+)

ranktc (X )

s.t. G[X ] = G[X 0 ].

(2.1)

In vector optimization, a feasible point is called Pareto optimal if no other feasible point dominates it in every criterion. Similarly, we say that (2.1) recovers X 0 if there
does not exist any other tensor X that is consistent with the
observations and has no larger rank along each mode, i.e.

Square Deal: Lower Bounds and Improved Relaxations for Tensor Recovery

the set {X 0 6= X 0 | G[X 0 ] = G[X 0 ], ranktc (X 0 ) RK
+
ranktc (X 0 )} is empty.2
The recovery performance of (2.1) depends heavily on the
properties of G. Suppose (2.1) fails to recover X 0 ∈ Tr .
Then there exists another X 0 ∈ Tr such that G[X 0 ] =
G[X 0 ]. To guarantee that (2.1) recovers any X 0 ∈ Tr ,
a necessary and sufficient condition is that G is injective
on Tr , which is implied by the condition null(G) ∩ T2r =
{0}. So, if null(G) ∩ T2r = {0}, (2.1) will recover any
X 0 ∈ Tr . We expect this to occur when the number of
measurements significantly exceeds the number of intrinsic degrees of freedom of a generic element of Tr , which is
O(rK + nrK). The following theorem shows that when m
is approximately twice this number, with probability one,
G is injective on Tr :
Theorem 1. Whenever m ≥ (2r)K +2nrK +1, with probability one, null(G) ∩ T2r = {0}, and hence (2.1) recovers
every X 0 ∈ Tr .
The proof of Theorem 1 follows from a covering argument,
which we present in the appendix.
Although problem (2.1) is not tractable, it can serve as
a baseline for understanding how many generic measurements are required to recover X 0 , and thus provide a
benchmark for tractable formulations.

3. Convexification: Sum of Nuclear Norms?
Since the nonconvex problem (2.1) is NP-hard for general
G, it is tempting to seek a convex surrogate. In matrix recovery problems, the nuclear norm is often an excellent
convex surrogate for the rank (Fazel, 2002; Recht et al.,
2010; Gross, 2011). It seems natural, then, to replace the
ranks in (2.1) with nuclear norms. Due to convexity, the
resulting vector optimization problem can be solved by the
following scalar optimization:
min
X

K
X

λi kX (i) k∗

s.t.

G[X ] = G[X 0 ],

(3.1)

i=1

Equivalently, it means X 0 is the unique optimal solution to:

min max
X

i

Corollary 2 (of (Tomioka et al., 2011), Theorem 3).
Suppose that X 0 has Tucker rank (r, . . . , r), and m ≥
CrnK−1 , where C is a constant. Then with high probability, X 0 is the optimal solution to (3.1), with each λi = 1.
This result shows that there is a range in which (3.1) succeeds: loosely, when we undersample by at most a factor
of m/N ∼ r/n. However, the number of observations
m ∼ rnK−1 is significantly larger than the number of degrees of freedom in X 0 , which is on the order of rK +nrK.
Is it possible to prove a better bound for this model? Unfortunately, we show that in general O(rnK−1 ) measurements
are also necessary for reliable recovery using (3.1):
Theorem
X ∈ o
Tr be nonzero. Set κ =
n 3. Let
2 0
2
mini (X 0 )(i) ∗ / kX 0 kF ×nK−1 . Then if the number
of measurements m ≤ κ − 2, X 0 is not the unique solution
2
to (3.1), with probability at least 1 − 4 exp(− (κ−m−2)
16(κ−2) ).
Moreover, there exists X 0 ∈ Tr for which κ = rnK−1 .
This implies that Corollary 2 (as well as some other results of (Tomioka et al., 2011)) is essentially tight. Unfortunately, it has negative implications for the efficacy of the
SNN model in (3.1): although a generic element X 0 of Tr
can be described using at most rK +nrK real numbers, we
require Ω(rnK−1 ) observations to recover it using (3.1).
Theorem 3 is a direct consequence of a much more general principle underlying multi-structured recovery, which
is elaborated next. After that, in Section 4, we show that
for low-rank tensor recovery, better convexifying schemes
are available.

General lower bound for multiple structures

where λ ≥ 0. The optimization (3.1) was first introduced
by (Liu et al., 2009) and has been used successfully in
applications in imaging (Semerci et al., 2013; Kreimer &
Sacchi, 2013; Li & Li, 2010; Ely et al., 2013; Li et al.,
2010). Similar convex relaxations have been considered
in a number of theoretical and algorithmic works (Gandy
et al., 2011; Signoretto et al., 2010; Tomioka et al., 2011;
2

Signoretto et al., 2013). It is not too surprising, then, that
(3.1) provably recovers the underlying tensor X 0 , when the
number of measurements m is sufficiently large. The following is a (simplified) corollary of results of Tomioka et.
al. (2011)

rank(X (i) )
rank((X 0 )(i) )


s.t. G[X ] = G[X 0 ].

The poor behavior of (3.1) is an instance of a much more
general phenomenon, first discovered by Oymak et. al.
(2012). Our target tensor X 0 has multiple low-dimensional
structures simultaneously: it is low-rank along each of the
K modes. In practical applications, many other such simultaneously structured objects could also be of interest.
For sparse phase retrieval problems in signal processing
(Oymak et al., 2012), the task can be rephrased to infer
a block sparse matrix, which implies both sparse and lowrank structures. In robust metric learning (Lim et al., 2013),
the goal is to estimate a matrix that is column sparse and
low rank concurrently. In computer vision, many signals of
interest are both low-rank and sparse in an appropriate basis
(Liang et al., 2012). To recover such simultaneously structured objects, it is tempting to build a convex relaxation by

Square Deal: Lower Bounds and Improved Relaxations for Tensor Recovery

combining the convex relaxations for each of the individual
structures. In the tensor case, this yields (3.1). Surprisingly,
this combination is often not significantly more powerful
than the best single regularizer (Oymak et al., 2012). We
obtain Theorem 3 as a consquence of a new, general result of this nature, using a geometric framework introduced
in (Amelunxen et al., 2013). Compared to (Oymak et al.,
2012), this approach has a clearer geometric intuition, covers a more general class of regularizers3 and yields sharper
bounds.
Consider a signal x0 ∈ Rn having K low-dimensional
structures simultaneously (e.g. sparsity, low-rank, etc.)4 .
Let k·k(i) be the penalty norms corresponding to the i-th
structure (e.g. `1 , nuclear norm). Consider the composite
norm optimization
min f (x) := λ1 kxk(1) + λ2 kxk(2) + · · · + λK kxk(K)

x∈Rn

s.t. G[x] = G[x0 ],

(3.2)

where G[·] is a Gaussian measurement operator, and λ > 0.
Is x0 the unique optimal solution to (3.2)? Recall that the
descent cone of a function f at a point x0 is defined as
C(f, x0 ) = cone {v | f (x0 + v) ≤ f (x0 )} ,

(3.3)

which, in short, will be denoted as C. Then x0 is the unique
optimal solution if and only if null(G) ∩ C = {0}. Thus,
recovery fails if null(G) has nontrivial intersection with C.
Since G is a Gaussian operator, null(G) is a uniformly oriented random subspace of dimension n − m. This random
subspace is more likely to have nontrivial intersection with
C if C is large, in a sense we will make precise. The polar of C is C o = cone ∂f (x0 ) . Because polarity reverses
inclusion, C will be large whenever C o is small.
To control the size of C o , we first consider a single norm
∗
k·k , with dual norm k·k . Suppose that k·k is L∗
Lipschitz: kxk ≤ L kxk2 for all x. Then kxk2 ≤ L kxk
for all x as well. Noting that

	
∗
∂ k·k (x) = v | hv, xi = kxk , kvk ≤ 1 ,
for any v ∈ ∂ k·k (x0 ), we have
kx0 k
kx0 k
hv, x0 i
≥
≥
.
∗
kvk2 kx0 k2
L kx0 k2
L kvk kx0 k2

3

x0
θ1

θ2

C(k·k(1) , x0 )

C(k·k(2) , x0 )

Figure 1. Cones and their polars for convex regularizers k·k(1)
and k·k(2) respectively. Suppose that x0 has two sparse structures simultaneously. Consider convex regularizer f (x) =
kx0 k(1) + kx0 k(2) . Suppose, as depicted, θ1 ≥ θ2 . Then both
cone(∂ kx0 k(1) ) and cone(∂ kx0 k(2) ) are in the circular cone

circ(x0 , θ1 ). Thus we have: cone ∂f (x0 ) = cone(∂ kx0 k(1) +

	
∂ kx0 k(2) ) ⊆ conv circ(x0 , θ1 ), circ(x0 , θ2 ) = circ(x0 , θ1 ).

Then if x0 6= 0, and θ = cos−1 (kx0 k /L kx0 k2 ),
∂ k·k (x0 ) ⊆ circ (x0 , θ) .

(3.6)

Table 1 describes the angle parameters θ for various popular structure inducing norms. Notice that in general, more
complicated x0 leads to smaller angles θ. For example, if
x0 is a k-sparse vector with entries all of the same magnitude, and k·k the `1 norm, cos2 θ = k/n. As x0 becomes
more dense, ∂ k·k is contained in smaller circular cones.
P
For f = i λi k·k(i) , every element of ∂f (x0 ) is a conic
combination of elements of the ∂ k·k(i) (x0 ). Since each of
the ∂ k·k(i) (x0 ) is contained in a circular cone with axis
x0 , cone (∂f (x0 )) is also contained in a circular cone:
Lemma 1. Suppose that k·k(i) is Li -Lipschitz. For x0 6=


0, set θi = cos−1 kx0 k(i) /Li kx0 k2 . Then


cone (∂f (x0 )) ⊆ circ x0 , max θi .
i=1...K

(3.7)

So, the subdifferential of our combined regularizer f is
contained in a circular cone whose angle is given by the
largest of {θi }K
i=1 . Figure 1 visualizes this geometry.

(3.4)

A more geometric way of summarizing the above fact is as
follows: for x 6= 0, let us denote the circular cone with
axis x and angle θ as
circ(x, θ) := {z | ∠(z, x) ≤ θ} .

cone(∂ kx0 k(2) )
x0

cone(∂ kx0 k(1) )

(3.5)

(Oymak et al., 2012) studies decomposable norms, with some
additional assumptions. Our result holds for arbitrary norms.
4
x0 ∈ Rn is the underlying signal of interest, perhaps after
vectorization. For example, suppose we want to recover the matrix X0 ∈ Rn1 ×n2 . Then x0 = vec(X0 ) ∈ Rn1 n2 .

How does this behavior affect the recoverability of x0 via
(3.2)? The informal reasoning above suggests that as θ
becomes smaller, the descent cone C becomes larger, and
we require more measurements to recover x0 . This can
be made precise using an elegant framework introduced by
Amelunxen et. al. (2013). They define the statistical dimension of the convex cone C to be the expected norm of
the projection of a standard Gaussian vector onto C:
h
i
.
2
δ(C) = Eg∼i.i.d. N (0,1) kPC (g)k2 .
(3.8)

Square Deal: Lower Bounds and Improved Relaxations for Tensor Recovery
Table 1. Concise models and their surrogates. For each norm k·k , the third column describes the range of achievable angles θ. Larger
cos θ corresponds to a smaller C o , a larger C, and hence a larger number of measurements required for reliable recovery.

Object

Complexity Measure

Relaxation

cos2 θ

κ = n cos2 θ

Sparse x ∈ Rn

k = kxk0

[ n1 , nk ]

[1, k]

c = # {j | Xej 6= 0}

kxk1
P
j kXej k2

[n1 , cn1 ]

r = rank(X)

kXk∗

[ n12 ,
[ n12 ,

Column-sparse X ∈ R
Low-rank X ∈ R

n1 ×n2

n1 ×n2

(n1 ≥ n2 )

Using tools from spherical integral geometry, (Amelunxen
et al., 2013) shows that for linear inverse problems with
Gaussian measurements, a sharp phase transition in recoverability occurs around m = δ(C). Since we attempt to derive a necessary condition for the success of (3.2), we need
only one side of their result, with slight modifications:
Corollary 4. Let G : Rn → Rm be a Gaussian operator,
and C a convex cone. Then if m ≤ δ(C),


(δ(C) − m)2
.
P [ C ∩ null(G) = {0} ] ≤ 4 exp −
16δ(C)
To apply this result to our problem, we need to have a lower
bound on the statistical dimension δ(C), of the descent cone
C of f at x0 . Using the Pythagorean theorem, monotonicity
of δ(·), and Lemma 1, we calculate
δ(C) = n − δ(C o ) = n − δ (cone (∂f (x0 )))

(3.9)

≥ n − δ(circ(x0 , max θi )).
i

Moreover, using the properties of statistical dimension, we
are able to prove an upper bound for the statistical dimension of circular cone, which improves the constant in existing results (Amelunxen et al., 2013; McCoy, 2013).
Lemma 2. δ(circ(x0 , θ)) < n sin2 θ + 2.

c
n2 ]
r
n2 ]

[n1 , rn1 ]

mini κi is determined by only the best of the structures. Per
Table 1, κi is often on the order of the number of degrees
of freedom in a generic object of the i-th structure. For
example, for a k-sparse vector whose nonzeros are all of
the same magnitude, κ = k.
Theorem 5 together with Table 1 leads us to the phenomenon recently discovered by Oymak et. al. (2012): for
recovering objects with multiple structures, a combination
of structure-inducing norms tends to be not significantly
more powerful than the best individual structure-inducing
norm. As we demonstrate, this general behavior follows
a clear geometric interpretation. The subdifferential of a
norm at x0 is contained in a relatively small circular cone
with central axis x0 .
Theorem 3 can then be easily deduced by specializing Theorem 5 to low-rank tensors as follows: if X is a K-mode
n × n × · · · × n tensor
ofTucker rank
√ (r, r, . . . , r), then for
. 
each i, kX k(i) = X (i) ∗ is L = n-Lipschitz. Hence,
o
n
2
2
κ = min X (i) ∗ / kX kF nK−1 .
i

o
n
2
2
The term mini X (i) ∗ / kX kF lies between 1 and r,

By combining (3.9) and Lemma 2, we have δ(C) ≥
n mini cos2 θi − 2. Using Corollary 4, we finally obtain:

inclusively. For example, if X has Tucker decomposition6
X = C ×1 U1 ×2 · · · ×K UK , with UTi Ui = I and C supersymmetric (C i1 ...iK = 1{i1 =i2 =···=iK } ), then that term
is equal to r.

Theorem 5. Let x0 6= 0. Suppose for each i, k·k(i) is
Li -Lipschitz. Set

4. A Better Convexification: Square Deal

κi =

2
n kx0 k(i)
2
L2i kx0 k2

= n cos2 (θi ),

and κ = mini κi . Then if m ≤ κ − 2,
P [ x0 is the unique optimal solution to (3.2) ]


(κ − m − 2)2
≤ 4 exp −
.
(3.10)
16 (κ − 2)

The number of measurements promised by Corollary 2 and
Theorem 3 is actually the same (up to constants) as the
number of measurements required to recover a tensor X 0
which is low-rank along just one mode. Since matrix nuclear norm minimization correctly recovers a n1 × n2 matrix of rank r when m ≥ Cr(n1 + n2 ) (Chandrasekaran
et al., 2012), solving
minimize kX (1) k∗

subject to G[X ] = G[X 0 ]

(4.1)

Thus, for reliable recovery, the number of measurements
needs to be at least proportional to κ.5 Notice that κ =

also recovers X 0 w.h.p. when m ≥ CrnK−1 .

5
E.g., if m = (κ − 2)/2, the probability of success is at most
4 exp(−(κ − 2)/64).

6
The mode-i (matrix) product A ×i B of size-compatible tensor A and matrix B outputs the tensor C such that C (i) = BA(i) .

Square Deal: Lower Bounds and Improved Relaxations for Tensor Recovery

This suggests a more mundane explanation for the difficulty with (3.1): the term rnK−1 comes from the need to
reconstruct the right singular vectors of the n × nK−1 matrix X (1) . If we had some way of matricizing a tensor that
produced a more balanced (square) matrix and also preserved the low-rank property, we could remedy this effect,
and reduce the overall sampling requirement. In fact, this
is possible when the order K of X 0 is four or larger.
For A ∈ Rm1 ×n1 , and integers m2 and n2 satisfying
m1 n1 = m2 n2 , the reshaping operator reshape(A, m2 , n2 )
returns an m2 ×n2 matrix whose elements are taken columnwise from A. This operator rearranges elements in A and
leads to a matrix of different shape. In the following, we
reshape matrix X (1) to a more square matrix while preserving the low-rank property. Let X ∈ Rn1 ×n2 ×···×nK .
Select j ∈ [K] := {1, 2, · · · , K}. Then we define matrix X [j] as7
j
K


Y
Y
X [j] = reshape X (1) ,
ni ,
ni .
i=1

(4.2)

i=j+1

We can view X [j] as a natural generalization of the standard tensor matricization. When j = 1, X [j] is nothing but
X (1) . However, when some j > 1 is selected, X [j] could
become a more balanced matrix. This reshaping also preserves some of the algebraic structures of X . In particular,
we will see that if X is a low-rank tensor (in either the CP
or Tucker sense), X [j] will be a low-rank matrix.
Lemma 3. (1) If X has CP decomposition X =
Pr
(1)
(2)
(K)
, then
i=1 λi ai ◦ ai ◦ · · · ◦ ai
X [j] =

r
X

(j)

(1)

(K)

λi (ai ⊗ · · · ⊗ ai ) ◦ (ai

(j+1)

⊗ · · · ⊗ ai

).

i=1

(4.3)
(2) If X has Tucker decomposition X = C ×1 U1 ×2 U2 ×3
· · · ×K UK , then
∗

X [j] = (Uj ⊗ · · · ⊗ U1 ) C [j] (UK ⊗ · · · ⊗ Uj+1 ) . (4.4)
Using Lemma 3 and the fact that rank(A ⊗ B) =
rank(A) rank(B), we obtain:
Lemma 4. Let ranktc (X ) = (r1 , r2 , · · · , rK ), and
rankcp (X ) = rn
Then rank(X [j] )o ≤ rcp , and
cp .
Qj
QK
rank(X [j] ) ≤ min
i=j+1 ri .
i=1 ri ,

Thus, X [j] is not only more balanced but also maintains the
low-rank property of the tensor X , which motivates us to
recover X 0 by solving


minimize X [j] ∗ subject to G[X ] = G[X 0 ]. (4.5)
Using Lemma 4 and (Chandrasekaran et al., 2012), we can
prove that this relaxation exactly recovers X 0 , when the
number of measurements is sufficiently large:
Theorem 6. Consider a K-way tensor with the same
length (say n) along each mode. (1) If X 0 has CP rank r,
dK
2 e is sufficient to reusing (4.5) with j = d K
2 e, m ≥ Crn
cover X 0 with high probability. (2) If X 0 has Tucker rank
K
bK
2 c nd 2 e
(r, r, · · · , r), using (4.5) with j = d K
2 e, m ≥ Cr
is sufficient to recover X 0 with high probability.
K

K

The number of measurements O(rb 2 c nd 2 e ) required to
recover X with square reshaping (4.5), is always within
a constant of the number O(rnK−1 ) with the sum-ofnuclear-norms model, and is significantly smaller when r
is small and K ≥ 4. E.g., we obtain an improvement of
a multiplicative factor of nbK/2c−1 when r is a constant.
This is a significant improvement.
Our square reshaping can be generalized to group together
any j modes (say modes i1 , i2 , . . . , ij ) rather than the first
j modes. Denote I = {i1 , i2 , . . . , ij } ⊆ [K] and J =
[K]\I = {ij+1 , ij+2 , . . . , iK }. Then the embedded matrix
Qj
QK
X I ∈ R k=1 nik × k=j+1 nik can be defined similarly as
in (4.2) but with a relabeling preprocessing. In specific, for
1 ≤ k ≤ K, we relabel the k-th mode as the original ik -th
b , we can define
mode. Regarding this relabeled tensor X
j
K


Y
Y
b (1) ,
b [j] = reshape X
n ik ,
n ik .
X I := X
k=1

k=j+1

Lemma 4 and Theorem 6 can then also be easily extended.
Note that for tensors with different lengths or ranks, the
comparison between SNN and our square reshaping becomes more subtle. It is possible to construct examples
for which the square reshaping model does not have an advantage over the SNN model, even for K > 3. Nevertheless, for a large class of tensors, our square reshaping is
capable of reducing the number of generic measurements
required by SNN model, both in theory and in numerical
experiments.

7

One can also think of (4.2) as embedding thetensor X into
the matrix X [j] as follows: X i1 ,i2 ,··· ,iK = X [j] a,b , where
a

=

1+

j
X

(im − 1)

m=1

b

=

1+

K
X
m=j+1

m−1
Y

!
nl

l=1


(im − 1)

m−1
Y
l=j+1


nl  .

5. Numerical Experiments
We corroborate the improvement of square reshaping with
numerical experiments on low-rank tensor completion
(LRTC) for both noise-free (synthetic data) and noisy (real
data) cases. LRTC attempts to reconstruct the (approximately) low-rank tensor X 0 from a subset Ω of its entries.
By imposing appropriate incoherence conditions, it is possible to prove exact/stable recovery guarantees for both our

Square Deal: Lower Bounds and Improved Relaxations for Tensor Recovery

square deal formulation (Gross, 2011) and the SNN model
(Huang et al., 2014) for LRTC. However, unlike the recovery problem under Gaussian random measurements, due to
the lack of sharp bounds, we have no proof that the square
model is guaranteed to outperform the SNN model here.
Nonetheless, numerical results below clearly indicate the
advantage of our square approach, complementing our theoretical results established in previous sections.

5.2. Video Completion

5.1. Simulation

For our square model, we set I = {1, 4} for the Ocean
video, and set I = {1, 2} for the Campus and the Face
videos, to construct more balanced embedded matrices
X I . Due to the existence of noise in real data, we would
solve the regularized least square problems

We generate a four-way tensor X 0 ∈ Rn×n×n×n as X 0 =
c0 ×1 u1 ×2 u2 ×3 u3 ×4 u4 , where c0 ∼ N (0, 1), and
ui ’s are generated uniformly over the unit sphere S n−1 =
{x ∈ Rn | kxk2 = 1}. The observed entries are chosen uniformly with ratio ρ. Since the unfolding matrix of
X 0 along each mode has the same distribution, we set each
λi = 1. Therefore, we compare the recovery performances
between
K
X
min
kX (i) k∗ s.t. PΩ [X ] = PΩ [X 0 ], (5.1)
X

i=1

min X {1,2} ∗
X

s.t. PΩ [X ] = PΩ [X 0 ].

(5.2)

We increase the problem size n from 10 to 30 with increment 1, and the observation ratio ρ from 0.01 to 0.2 with
increment 0.01. For each (ρ, n)-pair, we simulate 10 test
instances and declare a trial to be successful if the recovered X ? satisfies kX ? − X 0 kF /kX 0 kF ≤ 10−2 .
The optimization problems are solved using efficient firstorder methods. Since (5.2) is equivalent to standard matrix
completion, we use the existing solver ALM (Lin et al.,
2010). For the sum of nuclear norms minimization (5.1),
we implement the accelerated linearized Bregman algorithm (Huang et al., 2013) (see appendix for details).

30

30

25

25

Size of tensor (n)

Size of tensor (n)

Figure 2 plots the fraction of correct recovery for each pair.
Clearly, the square approach succeeds in a much larger region.

20

15

10

20

15

10
0.05
0.1
0.15
Fraction of entries observed (rho)

Square

0.2

0.05
0.1
0.15
Fraction of entries observed (rho)

0.2

SNN

Figure 2. Tensor completion. The colormap indicates the fraction of instances that are correctly recovered for each (ρ, n)-pair,
which increases with brightness from 100% failure (black) to
100% success (white).

Color videos can be naturally represented as four-mode
tensors (length×width×channels×frames). We compare
the performances of our square model and the SNN model
on video completion from randomly missing pixels. We
consider three video datasets: Ocean video (112 × 160 ×
3 × 32), Campus video (128 × 160 × 3 × 199) and Face
video (96 × 65 × 3 × 994).8

4

min

X 

1
2
kPΩ [X ] − DkF +
λi X (i) ∗ (5.3)
2
i=1

min

1
2
kPΩ [X ] − DkF + λ kX I k∗ ,
2

X

X

(5.4)

where D = PΩ [X 0 ] is the observed tensor, λi ≥ 0 and
λ ≥ 0 are tuning parameters. Since the purpose of our
experiment is to compare SNN and square models, to make
the comparison fair and meaningful, we should tune those
parameters as optimally as possible. That is not an easy
task, especially for the SNN model (5.3), which involves
four tuning parameters. As a remedy, we solve equivalent
nuclear norm constrained programs,9


2
min 12 kPΩ [X ] − DkF s.t. X (i) ∗ ≤ βi , ∀i ∈ [4], (5.5)
X

min
X

1
2

2

kPΩ [X ] − DkF

s.t. kX I k∗ ≤ β,

(5.6)

where
we set βi and β to their oracle values, i.e. βi =

(X 0 )(i)  and β = k(X 0 )I k , which can be reason∗
∗
ably considered as (nearly) optimal settings. Therefore, our
comparisons here are quite fair to both models.
To solve (5.5) and (5.6), we exploit the Frank-Wolfe algorithm, interests in which have recently resurged (Jaggi,
2013), due to its good scalability for dealing with nuclear
norm constrained problems (see appendix for details). Figures 3 and 4 display the results obtained using (5.5) and
(5.6). Clearly, our square approach outperforms the SNN
model.
We expect the benefits of using our square formulation will
be magnified in multi-spectral video data, where the number of channels could be much larger than three. In such
data, the video tensor tends to be low rank in both the wavelength and the temporal modes. Thus we can group these
two modes to form our low-rank matrix X I . When the
8
A detailed description of these data is included in the appendix.
9
The equivalence between the penalized problem and the norm
constrained problem is shown in the appendix.

Square Deal: Lower Bounds and Improved Relaxations for Tensor Recovery

merical experiments for tensor completion still suggest the
square reshaping model outperforms the SNN model generally. Compared with Ω(rnK−1 ) measurements required
K
K
by the SNN model, the sample complexity, O(rb 2 c nd 2 e ),
required by the square reshaping (4.5), is always within a
constant of it, and is much better for small r and K ≥ 4.
Although this is a significant improvement, compared with
the nonconvex model (2.1), the improved sample complexity achieved by the square model is still suboptimal. It
remains an open and intriguing problem to obtain nearoptimal tractable convex relaxations for all K > 2.

Figure 3. Sample snapshots from our datasets: Ocean, Campus,
Face. Left: sampled video (20 % for the Ocean video, 20% for the
Campus video and 2.5% for the Face video). Middle: video recovered by SNN model. Right: video recovered by square model.
0.4

0.2

0.1

0
0

0.2

0.4

0.6

0.8

1

Sampling Rate

Ocean

SNN
Square

0.3

0.2

0.1

0
0

0.1

0.2

0.3

Sampling Rate

Campus

0.4

0.4

Recovery Error (%)

SNN
Square

0.3

Recovery Error (%)

Recovery Error (%)

0.4

SNN
Square

0.3

0.2

0.1

0
0

0.05

0.1

0.15

Sampling Rate

Face

Figure 4. Video Completion. (relative) recovery error vs. sampling rate, for the three videos in Figure 3.

technique of taking multi-spectral data becomes mature in
the future, we believe our square reshaping model will be
more useful and more significant for the completion task.

6. Discussions
In this paper, we establish several theoretical bounds for
the problem of low-rank tensor recovery using random
Gaussian measurements. For the nonconvex model (2.1),
we show that (2r)K +2nrK+1 measurements are sufficient to recover any X 0 ∈ Tr almost surely. For
the conventional convex surrogate sum-of-nuclear-norms
(SNN) model (3.1), we prove a necessary condition that
Ω(rnK−1 ) Gaussian measurements are required for reliable recovery. This lower bound is derived from our study
of multi-structured object recovery in a very general setting, which can be applied to many other scenarios (e.g.
signal processing, metric learning, computer vision). To
narrow the apparent gap between the non-convex model
and the SNN model, we unfold the tensor into a more balanced matrix while preserving its low-rank property, leading to our square reshaping model (4.5). We then prove that
K
K
O(rb 2 c nd 2 e ) measurements are sufficient to recover a
tensor X 0 ∈ Tr with high probability. Though the theoretical results only pertain to Gaussian measurements, our nu-

0.2

Very recently, other interesting models and algorithms have
been proposed for low-rank tensor recovery. In (RomeraParedes & Pontil, 2013), the nuclear norm in the SNN
model is replaced by a new convex regularizer along each
mode. Since this new convex penalty function is not a
norm, Theorem 3 does not imply its suboptimality. In
(Romera-Paredes et al., 2013; Xu et al., 2013), efficient
methods based on alternating minimization are designed to
solve related non-convex models. Empirical improvements
over the SNN model are shown in all the above convex
and non-convex approaches. However, to the best of our
knowledge, no theoretical guarantees have been obtained
yet. Further analyzing these methods is an interesting problem for future research.
Putting our work in a broader setting, to recover objects
with multiple structures, regularizing with a combination
of individual structure-inducing norms is proven to be substantially suboptimal (Theorem 5 and also (Oymak et al.,
2012)). The resulting sample requirements tend to be much
larger than the intrinsic degrees of freedom of the lowdimensional manifold in which the structured signal lies.
Our square model for low-rank tensor recovery demonstrates the possibility that a better exploitation of those
structures can significantly reduce this sample complexity
(see also (Richard et al., 2013) for ideas in this direction).
However, there are still no clear clues on how to intelligently utilize several simultaneous structures generally, and
moreover how to design tractable methods to recover multistructured objects with near minimal numbers of measurements. These problems are definitely worth future study.

Acknowledgements
We thank the reviewers for helpful comments. CM was
supported by the Class of 1988 Doctoral Fellowship and
NSF Grant DMS-1016571. BH and DG were supported
by NSF Grant DMS-1016571. JW was supported by
Columbia University startup funding and Office of Naval
Research award N00014-13-1-0492.

References
Amelunxen, D., Lotz, M., McCoy, M., and Tropp, J. Living on
the edge: A geometric theory of phase transitions in convex

Square Deal: Lower Bounds and Improved Relaxations for Tensor Recovery
optimization. arXiv preprint arXiv:1303.6672, 2013.
Anandkumar, A., Ge, R., Hsu, D., Kakade, S., and Telgarsky,
M. Tensor decompositions for learning latent variable models.
arXiv preprint arXiv:1210.7559, 2012.
Bayati, Mohsen, Lelarge, Marc, and Montanari, Andrea. Universality in polytope phase transitions and message passing algorithms. arXiv preprint arXiv:1207.7321, 2012.

Lim, D., McFee, B., and Lanckriet, G. Robust structural metric
learning. In ICML, 2013.
Lin, Z., Chen, M., and Ma, Y. The augmented lagrange multiplier method for exact recovery of corrupted low-rank matrices. arXiv preprint arXiv:1009.5055, 2010.
Liu, J., Musialski, P., Wonka, P., and Ye, J. Tensor completion for
estimating missing values in visual data. In ICCV, 2009.

Candès, E., Romberg, J., and Tao, T. Stable signal recovery from
incomplete and inaccurate measurements. Communications on
Pure and Applied Mathematics, 59(8), 2006.

McCoy, M. A geometric analysis of convex demixing. PhD thesis,
California Institute of Technology, 2013.

Chandrasekaran, V., Recht, B., Parrilo, P., and Willsky, A. The
convex geometry of linear inverse problems. Foundations of
Computational Mathematics, 12(6):805–849, 2012.

Mesgarani, N., Slaney, M., and Shamma, S.A. Discrimination of
speech from nonspeech based on multiscale spectro-temporal
modulations. IEEE Trans. Audio, Speech, and Language Processing, 14(3):920–930, 2006.

Cohen, S. B. and Collins, M. Tensor decomposition for fast latentvariable PCFG parsing. In NIPS, 2012.
Donoho, D. Compressed sensing. IEEE Trans. Info. Theory, 52
(4):1289–1306, 2006.
Ely, G., Aeron, S., Hao, N., and Kilmer, M. E. 5d and 4d prestack seismic data completion using tensor nuclear norm (tnn).
preprint, 2013.
Fazel, M. Matrix rank minimization with applications. PhD thesis, Stanford University, 2002.
Gandy, S., Recht, B., and Yamada, I. Tensor completion and lown-rank tensor recovery via convex optimization. Inverse Problems, 27(2):025010, 2011.
Goldfarb, D. and Qin, Z. Robust low-rank tensor recovery: Models and algorithms. SIAM Journal on Matrix Analysis and Applications, 35(1):225–253, 2014.
Gross, D. Recovering low-rank matrices from few coefficients in
any basis. IEEE Trans. Info. Theory, 57(3):1548–1566, 2011.
Hillar, C. and Lim, L. Most tensor problems are np-hard. Journal
of the ACM (JACM), 60(6):45, 2013.
Huang, B., Ma, S., and Goldfarb, D. Accelerated linearized bregman method. Journal of Scientific Computing, 54(2-3):428–
453, 2013.
Huang, B., Mu, C., Goldfarb, D., and Wright, J. Provable lowrank tensor recovery. preprint, 2014.
Jaggi, M. Revisiting frank-wolfe: Projection-free sparse convex
optimization. In ICML, 2013.
Kolda, T. and Bader, B. Tensor decompositions and applications.
SIAM Review, 51(3):455–500, 2009.

Negahban, S., Ravikumar, P., Wainwright, M., and Yu, B. A unified framework for high-dimensional analysis of m-estimators
with decomposable regularizers. Stat. Sci., 27(4):528–557,
2012.
Nion, D. and Sidiropoulos, N. Tensor algebra and multidimensional harmonic retrieval in signal processing for mimo
radar. IEEE Trans. on Signal Processing, 58(11):5693–5705,
2010.
Oymak, S., Jalali, A., Fazel, M., Eldar, Y., and Hassibi, B. Simultaneously structured models with application to sparse and
low-rank matrices. arXiv preprint arXiv:1212.3753, 2012.
Recht, B., Fazel, M., and Parrilo, P. Guaranteed minimum-rank
solutions of linear matrix equations via nuclear norm minimization. SIAM review, 52(3):471–501, 2010.
Richard, E., Bach, F., and Vert, J. Intersecting singularities for
multi-structured estimation. In ICML, 2013.
Romera-Paredes, B. and Pontil, M. A new convex relaxation for
tensor completion. In NIPS, 2013.
Romera-Paredes, B., Aung, H., Bianchi-Berthouze, N., and Pontil, M. Multilinear multitask learning. In ICML, 2013.
Semerci, O., Hao, N., Kilmer, M., and Miller, E. Tensor-based
formulation and nuclear norm regularization for multi-energy
computed tomography. arXiv preprint arXiv:1307.5348, 2013.
Signoretto, M., De Lathauwer, L., and Suykens, J. Nuclear norms
for tensors and their use for convex multilinear estimation. Submitted to Linear Algebra and Its Applications, 43, 2010.
Signoretto, M., Tran Dinh, Q., Lathauwer, L., and Suykens, J.
Learning with tensors: a framework based on convex optimization and spectral regularization. Machine Learning, pp. 1–49,
2013.

Kreimer, N., Stanton A. and Sacchi, M. D. Nuclear norm minimization and tensor completion in exploration seismology. In
ICASSP, 2013.

Tomioka, R., Suzuki, T., Hayashi, K., and Kashima, H. Statistical
performance of convex tensor decomposition. In NIPS, 2011.

Li, N. and Li, B. Tensor completion for on-board compression of
hyperspectral images. In ICIP, 2010.

Tucker, L. Some mathematical notes on three-mode factor analysis. Psychometrika, 31(3):279–311, 1966.

Li, Y., Yan, J., Zhou, Y., and Yang, J. Optimum subspace learning
and error correction for tensors. In ECCV, 2010.

Xu, Y., Hao, R., Yin, W., and Su, Z. Parallel matrix factorization for low-rank tensor completion. arXiv preprint
arXiv:1312.1254, 2013.

Liang, X., Ren, X., Zhang, Z., and Ma, Y. Repairing sparse lowrank texture. In ECCV 2012, 2012.

