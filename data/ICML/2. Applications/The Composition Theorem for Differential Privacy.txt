The Composition Theorem for Differential Privacy

Peter Kairouz
ECE Department, University of Illinois at Urbana-Champaign, Urbana, IL 61801 USA

KAIROUZ 2@ ILLINOIS . EDU

Sewoong Oh
IESE Department, University of Illinois at Urbana-Champaign, Urbana, IL 61801 USA

SWOH @ ILLINOIS . EDU

Pramod Viswanath
ECE Department, University of Illinois at Urbana-Champaign, Urbana, IL 61801 USA

PRAMODV @ ILLINOIS . EDU

Abstract
Sequential querying of differentially private
mechanisms degrades the overall privacy level.
In this paper, we answer the fundamental question of characterizing the level of overall privacy degradation as a function of the number of
queries and the privacy levels maintained by each
privatization mechanism. Our solution is complete: we prove an upper bound on the overall
privacy level and construct a sequence of privatization mechanisms that achieves this bound. The
key innovation is the introduction of an operational interpretation of differential privacy (involving hypothesis testing) and the use of new
data processing inequalities. Our result improves
over the state-of-the-art and has immediate applications to several problems studied in the literature.

1. Introduction
Differential privacy is a formal framework to quantify
to what extent individual privacy in a statistical database
is preserved while releasing useful aggregate information
about the database. It provides strong privacy guarantees
by requiring the indistinguishability of whether or not an
individual is in the database based on the released information. Denoting the database when the individual is present
as D and as D0 when the individual is not, a differentially
private mechanism provides indistinguishability guarantees
with respect to the pair (D, D0 ). The databases D and D0
are referred to as ‚Äúneighboring‚Äù databases.
Definition 1.1 (Differential Privacy (Dwork et al.,
Proceedings of the 32 nd International Conference on Machine
Learning, Lille, France, 2015. JMLR: W&CP volume 37. Copyright 2015 by the author(s).

2006b;a)). A randomized mechanism M over a set of
databases is (Œµ, Œ¥)-differentially private if for all pairs of
neighboring databases D and D0 , and for all sets S in the
output space of the mechanism X ,
P(M (D) ‚àà S) ‚â§ eŒµ P(M (D0 ) ‚àà S) + Œ¥ .
A basic problem in differential privacy is how does the
overall privacy level degrade under the composition of interactive queries where each query meets a certain differential privacy guarantee. A routine argument shows
that the composition of k queries, each of which is (Œµ, Œ¥)differentially private, is at least (k, kŒ¥)-differentially private (Dwork et al., 2006b;a; Dwork & Lei, 2009; Dwork
et al., 2010). A tighter bound of (ŒµÃÉŒ¥ÃÉ , kŒ¥ + Œ¥ÃÉ)-differential
privacy under k-fold adaptive composition is provided, using more sophisticated arguments, in Dwork et al. (2010)
for the case when each of the individual queries
is (Œµ, Œ¥)q


2
differentially private. Here ŒµÃÉŒ¥ÃÉ = O kŒµ +Œµ k log(1/Œ¥ÃÉ) .
On the other hand, it was not known if this bound could be
improved until this work.
Our main result is the exact characterization of the privacy
guarantee under k-fold composition. Any k-fold adaptive
composition of (Œµ, Œ¥)-differentially private mechanisms
satisfies this privacy guarantee, stated as Theorem 3.3. Further, we construct a specific sequence of privacy mechanisms which under (in fact, nonadaptive) composition actually degrade privacy to the level guaranteed. Our result
entails a strict improvement over the state-of-the-art: this
can be seen immediately in the following approximation ‚Äì
using the same notation as q
above, the value of ŒµÃÉŒ¥ÃÉ is now re

‚àö
2
duced to ŒµÃÉŒ¥ÃÉ = O kŒµ + Œµ k log(e + (Œµ k/Œ¥ÃÉ) ) . Since
a typical‚àöchoice of Œ¥ÃÉ is Œ¥ÃÉ = Œò(kŒ¥), in the regime where
Œµ = Œò( kŒ¥), this improves the existing guarantee by a
logarithmic factor. The gain is especially significant when
both Œµ and Œ¥ are small.

The Composition Theorem for Differential Privacy

We start with the view of differential privacy as providing
certain guarantees for the two error types (false alarm and
missed detection) in a binary hypothesis testing problem
(involving two neighboring databases), as in previous work
by Wasserman & Zhou (2010). We bring two benefits of
this operational interpretation of the privacy definition to
bear on the problem at hand.
‚Ä¢ The first is conceptual: the operational setting directs
the logic of the steps of the proof, makes the arguments straightforward and readily allows generalizations such as heterogeneous compositions. While the
state-of-the-art work (Dwork et al., 2010) needed recourse to sophisticated mathematical results in Reingold et al. (2008); Tao & Ziegler (2008); Green & Tao
(2004) to derive their results, our strengthening is arrived at using relatively elementary techniques.
‚Ä¢ The second is technical: the operational interpretation
of hypothesis testing brings both the natural data processing inequality, and the strong converse to the data
processing inequality. These inequalities, while simple by themselves, lead to surprisingly strong technical results. As an aside, we mention that there is a
strong tradition of such derivations in the information
theory literature: the Fisher information inequality
(Blachman, 1965; Zamir, 1998), the entropy power inequality (Stam, 1959; Blachman, 1965; VerduÃÅ & Guo,
2006), an extremal inequality involving mutual informations (Liu & Viswanath, 2007), matrix determinant inequalities (Cover & Thomas, 1988), the BrunnMinkowski inequality and its functional analytic variants (Dembo et al., 1991) ‚Äì Chapter 17 of Cover &
Thomas (2012) enumerates a detailed list ‚Äì were all
derived using operational interpretations of mutual information and corresponding data processing inequalities.
One special case of our results, the strengthening of the
state-of-the-art result in Dwork et al. (2010), could also
have been arrived at directly by using stronger technical
methods than used in Dwork et al. (2010). Specifically, we
use a direct expression for the privacy region (instead of an
upper bound) to arrive at our strengthened result.
The optimal composition theorem (Theorem 3.3) provides
a fundamental limit on how much privacy degrades under
composition. Such a characterization is a basic result in differential privacy and has been used widely in the literature
(Dwork et al., 2010; Hardt et al., 2010; Blocki et al., 2012;
Gupta et al., 2012; Muthukrishnan & Nikolov, 2012; Hardt
& Roth, 2013). In each of these instances, the optimal composition theorem derived here (or the simpler characterization of Theorem 3.4) could be ‚Äúcut-and-pasted‚Äù, allowing
for corresponding strengthening of their conclusions. We

demonstrate this strengthening for two instances: variance
of noise adding mechanisms in Section 4.1 and Gaussian
projection in Section 4.2. We further show that a variety
of existing noise adding mechanisms ensure the same level
of privacy with similar variances. This implies that there is
nothing special about the popular choice of adding a Gaussian noise when composing multiple queries, and the same
utility as measured through the noise variance can be obtained using other known mechanisms. We start our discussions by operationally introducing differential privacy
as certain guarantees on the error probabilities in a binary
hypothesis testing problem.

2. Differential Privacy as Hypothesis Testing
Given a random output Y of a database access mechanism
M , consider the following hypothesis testing experiment.
We choose a null hypothesis as database D0 and alternative
hypothesis as D1 :
H0

: Y came from a database D0 ,

H1

: Y came from a database D1 .

For a choice of a rejection region S, the probability of false
alarm (type I error), when the null hypothesis is true but
rejected,
is defined as PFA (D0 , D1 , M, S) ‚â° P M (D0 ) ‚àà

S , and the probability of missed detection (type II error),
when the null hypothesis is false but retained,
 is defined as
PMD (D0 , D1 , M, S) ‚â° P M (D1 ) ‚àà SÃÑ where SÃÑ is the
complement of S. The differential privacy condition on a
mechanism M is equivalent to the following set of constraints on the probability of false alarm and missed detection. Wasserman and Zhou proved that (Œµ, 0)-differential
privacy implies the conditions (1) for a special case when
Œ¥ = 0 (Wasserman & Zhou, 2010). The same proof technique can be used to prove a similar result for general
Œ¥ ‚àà [0, 1], and to prove that the conditions (1) imply (Œµ, Œ¥)differential privacy as well. We refer to the supplementary
material for a proof.
Theorem 2.1. For any Œµ ‚â• 0 and Œ¥ ‚àà [0, 1], a database
mechanism M is (Œµ, Œ¥)-differentially private if and only if
the following conditions are satisfied for all pairs of neighboring databases D0 and D1 , and all rejection regions
S ‚äÜ X:
PFA (D0 , D1 , M, S) + eŒµ PMD (D0 , D1 , M, S) ‚â• 1 ‚àí Œ¥ ,
Œµ

e PFA (D0 , D1 , M, S) + PMD (D0 , D1 , M, S) ‚â• 1 ‚àí Œ¥ .
This operational perspective of differential privacy relates
the privacy parameters Œµ and Œ¥ to a set of conditions on
probability of false alarm and missed detection. This shows
that it is impossible to get both small PMD and PFA from
data obtained via a differentially private mechanism, and

(1)

The Composition Theorem for Differential Privacy
PFA

for all decision rules Œ≥.

1

(0, 1 ‚àí Œ¥) ‚Üí

Let D0 ‚àº D1 denote that the two databases are neighbors.
The union over all neighboring databases define the privacy
region of the mechanism.

0.5

%
(0,

2(1‚àíŒ¥)
)
1+eŒµ

R(M ) ‚â°

( (1‚àíŒ¥)
, (1‚àíŒ¥)
)
1+eŒµ
1+eŒµ

The following corollary, which follows immediately from
Theorem 2.1, gives a necessary and sufficient condition on
the privacy region for (Œµ, Œ¥)-differential privacy.

0
0.5

R(M, D0 , D1 ) .

D0 ‚àºD1

.

0

[

1

PMD
Figure 1. Privacy region for (Œµ, Œ¥)-differential privacy. For simplicity, we only show the privacy region below the line PFA +
PMD ‚â§ 1, since the whole region is symmetric w.r.t. the line
PFA + PMD = 1.

that the converse is also true. This operational interpretation of differential privacy suggests a graphical representation of differential privacy as illustrated in Figure 1.


R(Œµ, Œ¥) ‚â°
(PMD , PFA )  PFA + eŒµ PMD ‚â• 1 ‚àí Œ¥ ,
and eŒµ PFA + PMD ‚â• 1 ‚àí Œ¥} .

(2)

Similarly, we define the privacy region of a database access
mechanism M with respect to two neighboring databases
D0 and D1 as
R(M, D0 , D1 ) ‚â°


conv (PMD (D0 , D1 , M, S), PFA (D0 , D1 , M, S)) 
	
for all S ‚äÜ X
,
(3)
where conv(¬∑) is the convex hull of a set. Operationally,
by taking the convex hull, the region includes the pairs of
false alarm and missed detection probabilities achieved by
soft decisions that might use internal randomness in the
hypothesis testing. Precisely, let Œ≥ : X ‚Üí {H0 , H1 }
be any decision rule where we allow probabilistic decisions. For example, if the output is in a set S1 we can
accept the null hypothesis with a certain probability p1 ,
and for another set S2 accept with probability p2 . In full
generality, a decision rule Œ≥ can be fully described by
a partition {Si } of the output space X , and corresponding accept probabilities {pi }. The probabilities of false
alarm and missed detection for a decision rule Œ≥ is defined as PFA (D0 , D1 , M, Œ≥) ‚â° P(Œ≥(M (D0 )) = H1 ) and
PMD (D0 , D1 , M, Œ≥) ‚â° P(Œ≥(M (D1 )) = H0 ).
Remark 2.2. For all neighboring databases D0 and D1 ,
and a database access mechanism M , the pair of a false
alarm and a missed detection probabilities achieved by any
decision rule Œ≥ is included in the privacy region:

Corollary 2.3. A mechanism M is (Œµ, Œ¥)-differentially private if and only if R(M ) ‚äÜ R(Œµ, Œ¥).
Consider two database access mechanisms M (¬∑) and
M 0 (¬∑). Let X and Y denote the random outputs of mechanisms M and M 0 respectively. We say M dominates M 0
if M 0 (D) is conditionally independent of the database D
conditioned on the outcome of M (D). In other words, the
database D, X = M (D) and Y = M 0 (D) form the following Markov chain: D‚ÄìX‚ÄìY (Cover & Thomas, 1988).
Theorem 2.4 (Data processing inequality for differential
privacy). If a mechanism M dominates a mechanism M 0 ,
then for all pairs of neighboring databases D1 and D2 ,
R(M 0 , D1 , D2 ) ‚äÜ

R(M, D1 , D2 ) .

We refer to the supplementary material for a proof. Wasserman & Zhou (2010) have proved that, for a special case
when M is (Œµ, 0)-differentially private, M 0 is also (Œµ, 0)differentially private, which is a corollary of the above theorem. Perhaps surprisingly, the converse is also true.
Theorem 2.5 (Corollary of Theorem 10 from (Blackwell,
1953)). Fix a pair of neighboring databases D1 and D2
and let X and Y denote the random outputs of mechanisms
M and M 0 , respectively. If M and M 0 satisfy
R(M 0 , D1 , D2 ) ‚äÜ

R(M, D1 , D2 ) ,

then there exists a coupling of the random outputs X and
Y such that they form a Markov chain D‚ÄìX‚ÄìY .

When the privacy region of M 0 is included in M , then there
exists a stochastic transformation T that operates on X and
produce a random output that has the same marginal distribution as Y conditioned on the database D. We can consider this mechanism T as a privatization mechanism that
takes a (privatized) output X and provides even further privatization. The above theorem was proved in Blackwell
(1953) in the context of comparing two experiments, where
a statistical experiment denotes a mechanism in the context
(PMD (D0 , D1 , M, Œ≥), PFA (D0 , D1 , M, Œ≥)) ‚àà R(M, D0 , D1 ) ,of differential privacy.

The Composition Theorem for Differential Privacy

3. Composition of Differentially Private
Mechanisms

(kŒµ, kŒ¥)-differential privacy under k-fold adaptive composition.

In this section, we address how differential privacy guarantees compose: when accessing databases multiple times via
differentially private mechanisms, each of which having its
own privacy guarantees, how much privacy is still guaranteed on the union of those outputs? To formally define
composition, we consider the following scenario known as
the ‚Äòcomposition experiment‚Äô, proposed in Dwork et al.
(2010).

In general, one can show that if Mi is (Œµi , Œ¥i )differentially
P
P private, then the composition satisfies
( i‚àà[k] Œµi , i‚àà[k] Œ¥i )-differential privacy. If we do not allow any slack in the Œ¥, this bound cannot be tightened. Precisely, there are examples ofPmechanisms which under kfold composition violate (Œµ, i‚àà[k] Œ¥i )-differential privacy
P
for any Œµ < i‚àà[k] Œµi . We can prove this by providing a
set S such that the
P privacy condition is
Pmet with equality:
P(V 0 ‚àà S) = e i‚àà[k] Œµi P(V 1 ‚àà S) + i‚àà[k] Œ¥i . However,
if we allow for a slightly larger value of Œ¥, then Dwork et al.
(2010) showed that one can gain a significantly higher privacy guarantee in terms of Œµ.
Theorem 3.2 (Theorem III.3 from Dwork et al. (2010)).
For any Œµ > 0, Œ¥ ‚àà [0, 1], and Œ¥ÃÉ ‚àà (0, 1], the class of
(Œµ, Œ¥)-differentially private mechanisms satisfies (ŒµÃÉŒ¥ÃÉ , kŒ¥ +
Œ¥ÃÉ)-differential privacy under k-fold adaptive composition,
for
q
(4)
ŒµÃÉŒ¥ÃÉ = kŒµ(eŒµ ‚àí 1) + Œµ 2k log(1/Œ¥ÃÉ).

A composition experiment takes as input a parameter b ‚àà
{0, 1}, and an adversary A. From the hypothesis testing
perspective proposed in the previous section, b can be interpreted as the hypothesis: null hypothesis for b = 0
and alternative hypothesis for b = 1. At each time i, a
database Di,b is accessed depending on b. For example,
D1,0 could be medical records including a particular individual and D1,1 does not include the person, and D2,0
could be voter registration database with the same person
present and D2,1 with the person absent. An adversary A
is trying to break privacy (and figure out whether or not
the particular individual is in the database) by testing the
hypotheses on the output of k sequential access to those
databases via differentially private mechanisms. In full
generality, we allow the adversary to have full control over
which database to access, which query to ask, and which
mechanism to be used at each repeated access. Further, the
adversary is free to make these choices adaptively based
on the previous outcomes. The only restrictions are the
differentially private mechanisms belong to a family M
(e.g., the family of all (Œµ, Œ¥)-differentially private mechanisms), the internal randomness of the mechanisms are independent at each repeated access, and the hypothesis b is
not known to the adversary. The outcome of this k-fold
composition experiment is the view of the adversary A:
V b ‚â° (R, Y1b , . . . , Ykb ), where
Yib = Mi (Di,b , qi ),
qi is the ith query, Mi ‚àà M is the ith privatization mechanism, and R is the internal randomness of A.
3.1. Optimal privacy region under composition
In terms of testing whether a particular individual is in the
database (b = 0) or not (b = 1), we want to characterize how much privacy degrades after a k-fold composition
experiment. It is known that the privacy degrades under
composition by at most the ‚Äòsum‚Äô of the differential privacy
parameters of each access.
Theorem 3.1 ((Dwork et al., 2006b;a; Dwork & Lei, 2009;
Dwork et al., 2010)). For any Œµ > 0 and Œ¥ ‚àà [0, 1],
the class of (Œµ, Œ¥)-differentially private mechanisms satisfy

By allowing a slack ‚àö
of Œ¥ÃÉ > 0, one can get a higher privacy
of ŒµÃÉŒ¥ÃÉ = O(kŒµ2 + kŒµ2 ), which is significantly smaller
than kŒµ. This is the best known guarantee so far, and has
been used whenever one requires a privacy guarantee under
composition (e.g. (Dwork et al., 2010; Blocki et al., 2012;
Hardt & Roth, 2013)). However, the important question of
optimality has remained open. Namely, is there a composition of mechanisms where the above privacy guarantee is
tight? In other words, is it possible to get a tighter bound
on differential privacy under composition?
We give a complete answer to this fundamental question
in the following theorems. We prove a tighter bound on
the privacy under composition. Further, we also prove the
achievability of the privacy guarantee: we provide a set of
mechanisms such that the privacy region under k-fold composition is exactly the region defined by the conditions in
(5). Hence, this bound on the privacy region is tight and
cannot be improved upon.
Theorem 3.3. For any Œµ ‚â• 0 and Œ¥ ‚àà [0, 1], the class of
(Œµ, Œ¥)-differentially private mechanisms satisfies

(k ‚àí 2i)Œµ , 1 ‚àí (1 ‚àí Œ¥)k (1 ‚àí Œ¥i ) -differential privacy (5)
under k-fold adaptive composition, for all i
{0, 1, . . . , bk/2c}, where

Pi‚àí1 k (k‚àí`)Œµ
‚àí e(k‚àí2i+`)Œµ
`=0 ` e
Œ¥i =
.
(1 + eŒµ )k

=

(6)

Hence, the privacy region of k-fold composition is
an intersection of k regions, each of which is ((k ‚àí

The Composition Theorem for Differential Privacy

2i)Œµ, Œ¥i )-differentially private: R({(k‚àí2i)Œµ, Œ¥i }i‚àà[k/2] ) ‚â°
Tb k2 c
i=0 R((k ‚àí 2i)Œµ, Œ¥i ). We refer to the supplementary material for a proof, where we give an explicit mechanism
that achieves this region under composition. Hence, this
bound on the privacy region is tight, and gives the exact
description of how much privacy can degrade under k-fold
adaptive composition. This settles the question left open
in Dwork et al. (2006b;a); Dwork & Lei (2009); Dwork
et al. (2010) by providing, for the first time, the fundamental limit of composition, and proving a matching mechanism with the worst-case privacy degradation.
To prove the optimality in Theorem 3.3, namely that it is
impossible to have privacy worse than (5), we rely on the
operational interpretation of the privacy as hypothesis testing. Precisely, for a given pair (Œµ, Œ¥), we define a dominant mechanism whose output can be used to simulate
any (Œµ, Œ¥)-differentially private mechanism. Therefore, any
k-fold composition of (Œµ, Œ¥)-differentially private mechanisms can be simulated from the output of k-fold composition of the dominant mechanisms. The analysis of this
dominant mechanisms gives the exact composition theorem in Eq.(5), and the new analysis tools (Theorem 2.4 and
Theorem 2.5) proves its optimality.
Figure 2 illustrates how much the privacy region of Theorem 3.3 degrades as we increase the number of composition k. Figure 3 provides a comparison of the three privacy
guarantees in Theorems 3.1, 3.2 and 3.3 for 30-fold composition of (0.1, 0.001)-differentially private mechanisms.
Smaller region gives a tighter bound, since it guarantees the
higher privacy.
3.2. Simplified privacy region under composition
In many applications of the composition theorems, a
closed form expression of the composition privacy guarantee is required. The privacy guarantee in (5) is tight,
but can be difficult to evaluate. The next theorem provides a simpler form expression which is an outer bound
of the exact region described in (5). Comparing to
(4), the privacy guarantee
is significantly improved from
q



ŒµÃÉŒ¥ÃÉ = O kŒµ2 + kŒµ2 log(1/Œ¥ÃÉ) to ŒµÃÉŒ¥ÃÉ = O kŒµ2 +
q
	
min
kŒµ2 log(1/Œ¥ÃÉ), Œµ log(Œµ/Œ¥ÃÉ) , especially when composing a large number k of interactive queries. Further,
the Œ¥-approximate differential privacy degradation of (1 ‚àí
(1 ‚àí Œ¥)k (1 ‚àí Œ¥ÃÉ)) is also strictly smaller than the previous
(kŒ¥ + Œ¥ÃÉ). We discuss the significance of this improvement
in the next section using examples from existing differential privacy literature.
Theorem 3.4. For any Œµ > 0, Œ¥ ‚àà [0, 1], and Œ¥ÃÉ ‚àà [0, 1],
the class of (Œµ, Œ¥)-differentially private mechanisms satisfies ŒµÃÉŒ¥ÃÉ , 1 ‚àí (1 ‚àí Œ¥)k (1 ‚àí Œ¥ÃÉ) -differential privacy under

1
k=1
k=2
k=3
k=4
k=5

PFA

0.5

0
0

0.5

1

PMD
1
k=1
k=2
k=3
k=4
k=5

PFA

0.5

0
0

0.5

1

PMD
Figure 2. Privacy region R({(k ‚àí2i)Œµ, Œ¥i }) for the class of (Œµ, 0)differentially private mechanisms (top) and (Œµ, Œ¥)-differentially
private mechanisms (bottom) under k-fold adaptive composition.

k-fold adaptive composition, for
s
‚àö

(eŒµ ‚àí 1)Œµk
kŒµ2 
ŒµÃÉŒ¥ÃÉ = min kŒµ ,
+ Œµ 2k log e +
Œµ
e +1
Œ¥ÃÉ
r
1  o
Œµ
(e ‚àí 1)Œµk
+ Œµ 2k log
.
(7)
,
eŒµ + 1
Œ¥ÃÉ
n

In the high privacy regime, where Œµ ‚â§ 0.9, this bound can
be further simplified as
q
n
‚àö

ŒµÃÉŒ¥ÃÉ ‚â§ min kŒµ, kŒµ2 + Œµ 2k log e + ( kŒµ2 /Œ¥ÃÉ ) ,
q
o
kŒµ2 + Œµ 2k log(1/Œ¥ÃÉ) .
We refer to the supplementary material for a proof. This
privacy guarantee improves
‚àö over the existing result of Theorem 3.2 when Œ¥ÃÉ = Œò( kŒµ2 ). Typical regime of interest is
the high-privacy
regime for composition privacy guarantee,
‚àö
i.e. when kŒµ2  1. The above theorem suggests that we
only need the extra slack of approximate privacy Œ¥ÃÉ of order
‚àö
kŒµ2 , instead of ‚Ñ¶(1) as suggested by the existing results.

The Composition Theorem for Differential Privacy

This tells us that the Œµ` ‚Äôs sum up under composition: whenever we have kŒµ or kŒµ2 in (7) we can replace it by the summation to get the general result for heterogeneous case.

1
Theorem 3.1
Theorem 3.2
Theorem 3.3

PFA

4. Applications

0.5

0
0

0.5

1

PMD
1

privacy region

PFA
1 ‚àí dŒµÃÉ (P0 , P1 )

&
slope = ‚àíeŒµÃÉ

.

0.5

0
0

0.5

1

PMD

Figure 3. Theorem 3.3 provides the tightest bound (top). Given
a mechanism M , the privacy region can be completely described
by its boundary, which is represented by a set of tangent lines of
the form PFA = ‚àíeŒµÃÉ PMD + 1 ‚àí dŒµÃÉ (P0 , P1 ) (bottom).

3.3. Composition Theorem for Heterogeneous
Mechanisms
We considered homogeneous mechanisms, where all mechanisms are (Œµ, Œ¥)-differentially private. Our analysis readily extends to heterogeneous mechanisms, where the `-th
query satisfies (Œµ` , Œ¥` )-differential privacy (we refer to such
mechanisms as (Œµ` , Œ¥` )-differentially private mechanisms).
Theorem 3.5. For any Œµ` > 0, Œ¥` ‚àà [0, 1] for
` ‚àà {1, . . . . , k}, and Œ¥ÃÉ ‚àà [0, 1], the class of (Œµ` , Œ¥` )differentially private mechanisms satisfy ŒµÃÉŒ¥ÃÉ , 1 ‚àí (1 ‚àí

Qk
Œ¥ÃÉ) `=1 (1 ‚àí Œ¥` ) -differential privacy under k-fold adaptive composition, for ŒµÃÉŒ¥ÃÉ =
min

k
nX

Œµ` ,

`=1

v
qP
u
u k
k
2 

Œµ`
X
u
(e ‚àí 1)Œµ` t
`=1 Œµ`
2 log e +
+
2
Œµ
,
`
e Œµ` + 1
Œ¥ÃÉ
`=1
`=1
v
u k
k
 o
Œµ`
X
X
(e ‚àí 1)Œµ` u
t
2 log 1
+
2
Œµ
.
(8)
`
e Œµ` + 1
Œ¥ÃÉ
`=1
`=1
k
X

When analyzing a complex mechanism with multiple submechanisms each with (Œµ0 , Œ¥0 )-differential privacy guarantee, we can apply the composition theorem (Theorem 3.3
and Theorem 3.4). To ensure overall (Œµ, Œ¥)-differential
privacy forpthe whole complex mechanism, one chooses
Œµ0 = Œµ/(2 k log(e + Œµ/Œ¥)) and Œ¥0 = Œ¥/2k, when there
are k sub-mechanisms. The existing composition theorem
guarantees the desired overall privacy. Then, the utility of
the complex mechanism is calculated for the choice of Œµ0
and Œ¥0 .
Following this recipe, we first provide a sufficient condition
on the variance of noise adding mechanisms. This analysis
shows that one requires smaller variance than what is previously believed, in the regime where Œµ = Œò(Œ¥). Further,
we show that a variety of known mechanisms achieve the
desired privacy under composition with the same level of
variance. Applying this analysis to known mechanisms for
cut queries of a graph, we show that again in the regime
where Œµ = Œò(Œ¥), one can achieve the desired privacy under
composition with improved utility.
For count queries with sensitivity one, the geometric noise
adding mechanism is known to be universally optimal in
a general cost minimization framework (Bayesian setting
in Ghosh et al. (2012) and worst-case setting in Geng &
Viswanath (2012)). Here we provide a new interpretation
of the geometric noise adding mechanism as an optimal
mechanism under composition for counting queries. In the
course of proving Theorem 3.3, we show that a family of
mechanisms are optimal under composition, in the sense
that they achieve the largest false alarm and missed detection region. Larger region under composition implies
that one can achieve smaller error rates, while ensuring the
same level of privacy at each step of the composition. In
this section, we show that the geometric mechanism is one
of such mechanisms, thus providing the new interpretation
to the optimality of the geometric mechanisms.
4.1. Variance of noise adding mechanisms under
composition
In this section, we consider real-valued queries q : D ‚Üí
R. The sensitivity of a real-valued query is defined as the
maximum absolute difference of the output between two
neighboring databases:

‚àÜ

‚â°

max |q(D) ‚àí q(D0 )| ,

D‚àºD 0

The Composition Theorem for Differential Privacy

where ‚àº indicates that the pair of databases are neighbors.
A common approach to privatize such a query output is to
add noise to it, and the variance of the noise grows with
sensitivity of the query and the desired level of privacy. A
popular choice of the noise is Gaussian. It is previously
known that it is sufficient to add Gaussian noise with variance O(k‚àÜ2 log(1/Œ¥)/Œµ2 ) to each query output in order to
ensure (Œµ, Œ¥)-differential privacy under k-fold composition.
We improve the analysis of Gaussians under composition,
and show that for a certain regime where Œµ = Œò(Œ¥), the
sufficient condition can be improved by a log factor.
When composing real-valued queries, the Gaussian mechanism is a popular choice (Blocki et al., 2012; Hardt & Roth,
2013). However, we show that there is nothing special
about Gaussian mechanisms for composition. We prove
that the Laplacian mechanism or the staircase mechanism
introduced in Geng & Viswanath (2012) can achieve the
same level of privacy under composition with the same
variance.
We can use Theorem 3.4 to find how much noise we
need to add to each query output, in order to ensure (Œµ, Œ¥)-differential privacy under k-fold composition. We know that if each query output is (Œµ0 , Œ¥0 )differentially
private, then the composed outputs satisfy
q
p
(kŒµ20 + 2kŒµ20 log(e + kŒµ20 /Œ¥ÃÉ), kŒ¥0 + Œ¥ÃÉ)-differential privacy assuming
Œµ0 ‚â§ 0.9. With the choice of Œ¥0 = Œ¥/2k,
‚àö
Œ¥ÃÉ = Œ¥/ 2, and Œµ20 = Œµ2 /4k log(e+(Œµ/Œ¥)), this ensures that
the target privacy of (Œµ, Œ¥) is satisfied under k-fold composition as described in the following corollary.
Corollary 4.1. For any Œµ
‚àà
(0, 0.9] and
Œ¥p‚àà (0, 1], if the database access mechanism satisfies
( Œµ2 /4k log(e + (Œµ/Œ¥)), Œ¥/2k)-differential privacy on
each query output, then it satisfies (Œµ, Œ¥)-differential
privacy under k-fold composition.
One of the most popular noise adding mechanisms is the
Laplacian mechanism, which adds Laplacian noise to realvalued query outputs. When the sensitivity is ‚àÜ, one can
achieve (Œµ0 , 0)-differential privacy with the choice of the
distribution Lap(Œµ0 /‚àÜ) = (Œµ0 /2‚àÜ)e‚àíŒµ0 |x|/‚àÜ . The resulting variance of the noise is 2‚àÜ2 /Œµ20 . The above corollary
implies a certain sufficient condition on the variance of the
Laplacian mechanism to ensure privacy under composition.
Corollary 4.2. For real-valued queries with sensitivity
‚àÜ > 0, the mechanism thatadds Laplacian noise with variance 8k‚àÜ2 log e + (Œµ/Œ¥) /Œµ2 satisfies (Œµ, Œ¥)-differential
privacy under k-fold adaptive composition for any Œµ ‚àà
(0, 0.9] and Œ¥ ‚àà (0, 1]. The mean squared error achieved
 by

the Laplacian mechanism is O k 2 ‚àÜ2 log e + (Œµ/Œ¥) /Œµ2 .
In terms of variance-privacy trade-off for real-valued
queries, the optimal noise-adding mechanism known as
the staircase mechanism was introduced in Geng &

Viswanath (2012). The probability density function of
this noise is piecewise constant, and the probability density on the pieces decay geometrically. It is shown
in Geng & Viswanath (2013) that that with variance of
O(min{1/Œµ2 , 1/Œ¥ 2 }), the staircase mechanism achieved
(Œµ, Œ¥)-differential privacy. Corollary
 4.1 implies that with
variance O k‚àÜ2 log(e + Œµ/Œ¥)/Œµ2 , the staircase mechanism satisfies (Œµ, Œ¥)-differential privacy under k-fold composition.
Another popular mechanism known as the Gaussian mechanism privatizes each query output by adding a Gaussian
noise with variance œÉ 2 . It is not difficult to show that
when the sensitivity of the query is ‚àÜ, with a choice of
œÉ 2 ‚â• 2‚àÜ2 log(2/Œ¥0 )/Œµ20 , the Gaussian mechanism satisfies
(Œµ0 , Œ¥0 )-differential privacy (e.g. (Dwork et al., 2006a)).
The above corollary implies that the Gaussian mechanism
with variance O(k‚àÜ2 log(1/Œ¥) log(e + (Œµ/Œ¥))/Œµ2 ) ensures
(Œµ, Œ¥)-differential privacy under k-fold composition. However, we can get a tighter sufficient condition by directly
analyzing how Gaussian mechanisms compose, and we refer to the supplementary material for a proof.
Theorem 4.3. For real-valued queries with sensitivity ‚àÜ >
0, the mechanism thatadds Gaussian noise with variance
8k‚àÜ2 log e + (Œµ/Œ¥) /Œµ2 satisfies (Œµ, Œ¥)-differential privacy under k-fold adaptive composition for any Œµ > 0 and
Œ¥ ‚àà (0, 1]. The mean squared error achieved
 by the Gaussian mechanism is O k 2 ‚àÜ2 log e + (Œµ/Œ¥) /Œµ2 .
It is previously known that it is sufficient to add i.i.d. Gaussian noise with variance O(k‚àÜ2 log(1/Œ¥)/Œµ2 ) to ensure
(Œµ, Œ¥)-differential privacy under k-fold composition (e.g.
Theorem 2.7 from Hardt & Talwar (2010)). The above theorem shows that when Œ¥ = Œò(Œµ), one can achieve the same
privacy with smaller variance by a factor of log(1/Œ¥).
4.2. Cut queries of a graph and variance queries of a
matrix
Blocki et al. (2012) showed that classical JohnsonLindenstrauss transform can generate a differentially private version of a database. Further, they show that this
achieves the best tradeoff between privacy and utility for
two applications: cut queries of a graph and variance
queries of a matrix. In this section, we show how the best
known trade off can be further improved by applying Theorem 3.4.
First, Blocki et. al. provide a differentially private mechanism for cut queries q(G, S): the number of edges crossing a (S, SÃÑ)-cut in a weighted undirected graph G. This
mechanism produces a sanitized graph satisfying (Œµ, Œ¥)differential privacy, where two graphs are neighbors if they
only differ on a single edge. The utility of the mechanism is measured via the additive error œÑ incurred by the

The Composition Theorem for Differential Privacy

privatization. Precisely, a mechanism M is said to give a
(Œ∑, œÑ, ŒΩ)-approximation for a single cut query q(¬∑, ¬∑), if for
every graph G and every nonempty S it holds that


P (1 ‚àí Œ∑)q(G, S) ‚àí œÑ ‚â§ M (G, S) ‚â§ (1 + Œ∑) q(G, S) + œÑ
‚â•1‚àíŒΩ .

(9)

For the proposed Johnson-Lindenstrauss mechanism satisfying (Œµ, Œ¥)-differential privacy, it is shown that the additive error œÑ0 incurred by querying the database k times is
bounded by Theorem 3.2 from Blocki et al. (2012)1
 log(k/ŒΩ)  
 plog(1/Œ¥) log(k/ŒΩ)
. (10)
log
œÑ0 = O |S|
Œµ
Œ∑2 Œ¥
Compared to other state-of-the-art privacy mechanisms
such as the Laplace noise adding mechanism (Dwork,
2006), exponential mechanism (McSherry & Talwar,
2007), multiplicative weights (Hardt & Rothblum, 2010),
and Iterative Database Construction (Gupta et al., 2012),
it is shown in (Blocki et al., 2012) that the JohnsonLindenstrauss mechanism achieves the best tradeoff between the additive error œÑ0 and the privacy Œµ. This tradeoff
in (10) is proved using the existing Theorem 3.2. We can
improve this analysis using the optimal composition theorem of Theorem 3.4, which gives
 plog(e + Œµ/Œ¥) log(k/ŒΩ)
 log(k/ŒΩ) 
œÑ = O |S|
log
. (11)
Œµ
Œ∑2 Œ¥
This is smaller than (10) by (a square root of) a logarithmic factor when Œµ = Œò(Œ¥). We refer to the supplementary
material for a proof of the analysis in (11).
A similar technique has been used in Blocki et al. (2012)
to provide a differentially private mechanism for variance
queries v(A, x) = xT AT Ax: the variance of a given matrix in a direction x. The proposed mechanism produces a
sanitized covariance matrix that satisfy (Œµ, Œ¥)-differential
privacy, where two matrices are neighbors if they differ
only in a single row and the difference is by Euclidean
distance at most one. With the previous composition theorem in Theorem
 3.2, Blocki et al. (2012) get
 an error
log(1/Œ¥) log(k/ŒΩ)
2 log(k/ŒΩ)
bound œÑ1 = O
log
. Using
Œµ2 Œ∑
Œ∑2 Œ¥
our tight composition theorem, 
this can be
 improved as
log(k/ŒΩ)
2 log(k/ŒΩ)
œÑ = O log(e+Œµ/Œ¥)
log
. Again, for
Œµ2 Œ∑
Œ∑2 Œ¥
Œµ = Œò(Œ¥), this is an improvement of a logarithmic factor.
4.3. Optimality of geometric noise adding
In this section, we consider integer valued queries q : D ‚Üí
Z with sensitivity one, also called counting queries. Such
1
The original theorem is stated for a single query with k = 1.
Here we state it more generally with arbitrary k. This requires
scaling ŒΩ by 1/k to take into account the union bound over k
query outputs in the utility guarantee in (9).

queries are common in practice, e.g. ‚ÄúHow many individuals have income less than $100,000?‚Äù. Presence of absence of an individual record changes the output at most by
one. Counting query is a well-studied topic in differential
privacy (Dinur & Nissim, 2003; Dwork & Nissim, 2004;
Blum et al., 2005; 2013) and they provide a primitive for
constructing more complex queries (Blum et al., 2005).
The geometric noise adding mechanism is a discrete variant of the popular Laplacian mechanism. For integervalued queries with sensitivity one, the mechanism adds
a noise distributed according to a double-sided geometric
distribution whoseprobability density function is p(k) =
(eŒµ ‚àí 1)/(eŒµ + 1) e‚àíŒµ|k| . This mechanism is known to be
universally optimal in a general cost minimization framework (Bayesian setting in (Ghosh et al., 2012) and worstcase setting in (Geng & Viswanath, 2012)). In this section,
we show that the geometric noise adding mechanism is also
optimal under composition.
Consider the composition experiment for counting queries.
For a pair of neighboring databases D0 and D1 , some of
the query outputs differ by one, since sensitivity is one,
and for other queries the output might be the same. Let
k denote the number of queries whose output differs with
respect to D0 and D1 . Then, we show that the privacy region achieved by geometric mechanism, that adds geometric noise for each integer-valued query output, is exactly
described by the optimal composition theorem of (5). Further, since this is the largest privacy region under composition for the pair of database D0 and D1 that differ in k
queries, no other mechanism can achieve a larger privacy
region. Since the geometric mechanism does not depend
on the particular choice of pairs of databases D0 and D1 ,
nor does it depend on the specific query being asked, the
mechanism is optimal universally for every pair of neighboring databases simultaneously.
Here, optimality is with respect to the composed privacy
region itself. Among the mechanisms guaranteeing the
same level of privacy, one with larger privacy region under composition is considered better, in terms of allowing
for smaller false alarm and missed detection rate in hypothesis testing whether the database contains a particular entry or not. In this sense, larger privacy degradation under
composition has more utility. The geometric mechanism
has the largest possible privacy degradation under composition, stated formally below; we refer to the supplementary
material for a proof.
Theorem 4.4. Under the k-fold composition experiment
of counting queries, the geometric mechanism achieves the
largest privacy region among all (Œµ, 0)-differentially private mechanisms, universally for every pair of neighboring
databases simultaneously.

The Composition Theorem for Differential Privacy

References
Blachman, N. The convolution inequality for entropy powers. Information Theory, IEEE Transactions on, 11(2):
267‚Äì271, 1965.
Blackwell, David. Equivalent comparisons of experiments.
The Annals of Mathematical Statistics, 24(2):265‚Äì272,
1953.
Blocki, Jeremiah, Blum, Avrim, Datta, Anupam, and Sheffet, Or. The johnson-lindenstrauss transform itself preserves differential privacy. In Foundations of Computer
Science (FOCS), 2012 IEEE 53rd Annual Symposium
on, pp. 410‚Äì419. IEEE, 2012.
Blum, Avrim, Dwork, Cynthia, McSherry, Frank, and Nissim, Kobbi. Practical privacy: the SuLQ framework.
In Proceedings of the twenty-fourth ACM SIGMODSIGACT-SIGART symposium on Principles of database
systems, pp. 128‚Äì138. ACM, 2005.
Blum, Avrim, Ligett, Katrina, and Roth, Aaron. A learning theory approach to noninteractive database privacy.
Journal of the ACM (JACM), 60(2):12, 2013.
Cover, Thomas M and Thomas, A. Determinant inequalities via information theory. SIAM journal on Matrix
Analysis and Applications, 9(3):384‚Äì392, 1988.
Cover, Thomas M and Thomas, Joy A. Elements of information theory. John Wiley & Sons, 2012.

Dwork, Cynthia, McSherry, Frank, Nissim, Kobbi, and
Smith, Adam. Calibrating noise to sensitivity in private
data analysis. In Theory of Cryptography, pp. 265‚Äì284.
Springer, 2006b.
Dwork, Cynthia, Rothblum, Guy N, and Vadhan, Salil.
Boosting and differential privacy. In Foundations of
Computer Science (FOCS), 2010 51st Annual IEEE
Symposium on, pp. 51‚Äì60. IEEE, 2010.
Geng, Quan and Viswanath, Pramod. Optimal noiseadding mechanism in differential privacy. arXiv preprint
arXiv:1212.1186, 2012.
Geng, Quan and Viswanath, Pramod. The optimal mechanism in (, Œ¥)-differential privacy. arXiv preprint
arXiv:1305.1330, 2013.
Ghosh, Arpita, Roughgarden, Tim, and Sundararajan,
Mukund. Universally utility-maximizing privacy mechanisms. SIAM Journal on Computing, 41(6):1673‚Äì1693,
2012.
Green, Ben and Tao, Terence. The primes contain arbitrarily long arithmetic progressions. arXiv preprint
math/0404188, 2004.
Gupta, Anupam, Roth, Aaron, and Ullman, Jonathan. Iterative constructions and private data release. In Theory of
Cryptography, pp. 339‚Äì356. Springer, 2012.

Dembo, Amir, Cover, Thomas M, and Thomas, Joy A.
Information theoretic inequalities. Information Theory,
IEEE Transactions on, 37(6):1501‚Äì1518, 1991.

Hardt, Moritz and Roth, Aaron. Beyond worst-case analysis in private singular vector computation. In Proceedings of the 45th annual ACM symposium on Symposium
on theory of computing, pp. 331‚Äì340. ACM, 2013.

Dinur, Irit and Nissim, Kobbi. Revealing information while
preserving privacy. In Proceedings of the twenty-second
ACM SIGMOD-SIGACT-SIGART symposium on Principles of database systems, pp. 202‚Äì210. ACM, 2003.

Hardt, Moritz and Rothblum, Guy N. A multiplicative
weights mechanism for privacy-preserving data analysis.
In Foundations of Computer Science (FOCS), 2010 51st
Annual IEEE Symposium on, pp. 61‚Äì70. IEEE, 2010.

Dwork, Cynthia. Differential privacy. In Automata, languages and programming, pp. 1‚Äì12. Springer, 2006.

Hardt, Moritz and Talwar, Kunal. On the geometry of differential privacy. In Proceedings of the 42nd ACM symposium on Theory of computing, pp. 705‚Äì714. ACM,
2010.

Dwork, Cynthia and Lei, Jing. Differential privacy and robust statistics. In Proceedings of the 41st annual ACM
symposium on Theory of computing, pp. 371‚Äì380. ACM,
2009.
Dwork, Cynthia and Nissim, Kobbi. Privacy-preserving
datamining on vertically partitioned databases. In Advances in Cryptology‚ÄìCRYPTO 2004, pp. 528‚Äì544.
Springer, 2004.
Dwork, Cynthia, Kenthapadi, Krishnaram, McSherry,
Frank, Mironov, Ilya, and Naor, Moni. Our data, ourselves: Privacy via distributed noise generation. In Advances in Cryptology-EUROCRYPT 2006, pp. 486‚Äì503.
Springer, 2006a.

Hardt, Moritz, Ligett, Katrina, and McSherry, Frank. A
simple and practical algorithm for differentially private
data release. arXiv preprint arXiv:1012.4763, 2010.
Liu, Tie and Viswanath, Pramod. An extremal inequality
motivated by multiterminal information-theoretic problems. Information Theory, IEEE Transactions on, 53(5):
1839‚Äì1851, 2007.
McSherry, Frank and Talwar, Kunal. Mechanism design
via differential privacy. In Foundations of Computer Science, 2007. FOCS‚Äô07. 48th Annual IEEE Symposium on,
pp. 94‚Äì103. IEEE, 2007.

The Composition Theorem for Differential Privacy

Muthukrishnan, S and Nikolov, Aleksandar. Optimal private halfspace counting via discrepancy. In Proceedings of the 44th symposium on Theory of Computing, pp.
1285‚Äì1292. ACM, 2012.
Reingold, Omer, Trevisan, Luca, Tulsiani, Madhur, and
Vadhan, Salil. Dense subsets of pseudorandom sets.
In Foundations of Computer Science, 2008. FOCS‚Äô08.
IEEE 49th Annual IEEE Symposium on, pp. 76‚Äì85.
IEEE, 2008.
Stam, AJ. Some inequalities satisfied by the quantities of
information of fisher and shannon. Information and Control, 2(2):101‚Äì112, 1959.
Tao, Terence and Ziegler, Tamar. The primes contain arbitrarily long polynomial progressions. Acta Mathematica,
201(2):213‚Äì305, 2008.
VerduÃÅ, Sergio and Guo, Dongning. A simple proof of the
entropy-power inequality. IEEE Transactions on Information Theory, 52(5):2165‚Äì2166, 2006.
Wasserman, Larry and Zhou, Shuheng. A statistical framework for differential privacy. Journal of the American
Statistical Association, 105(489):375‚Äì389, 2010.
Zamir, Ram. A proof of the fisher information inequality via a data processing argument. Information Theory,
IEEE Transactions on, 44(3):1246‚Äì1250, 1998.

