Dimension-free Concentration Bounds on Hankel Matrices for Spectral
Learning

FrancÃßois Denis
Mattias Gybels
Aix Marseille UniversiteÃÅ, CNRS, LIF, 13288 Marseille Cedex 9, FRANCE

FRANCOIS . DENIS @ LIF. UNIV- MRS . FR
MATTIAS . GYBELS @ LIF. UNIV- MRS . FR

Amaury Habrard
AMAURY. HABRARD @ UNIV- ST- ETIENNE . FR
UniversiteÃÅ Jean Monnet de Saint-Etienne, CNRS, LaHC, 42000 Saint-Etienne Cedex 2, FRANCE

Abstract
Learning probabilistic models over strings is an
important issue for many applications. Spectral
methods propose elegant solutions to the problem of inferring weighted automata from finite
samples of variable-length strings drawn from
an unknown target distribution. These methods
rely on a singular value decomposition of a matrix HS , called the Hankel matrix, that records
the frequencies of (some of) the observed strings.
The accuracy of the learned distribution depends
both on the quantity of information embedded
in HS and on the distance between HS and its
mean Hr . Existing concentration bounds seem
to indicate that the concentration over Hr gets
looser with its size, suggesting to make a tradeoff between the quantity of used information and
the size of Hr . We propose new dimensionfree concentration bounds for several variants of
Hankel matrices. Experiments demonstrate that
these bounds are tight and that they significantly
improve existing bounds. These results suggest
that the concentration rate of the Hankel matrix
around its mean does not constitute an argument
for limiting its size.

1. Introduction
Many applications in natural language processing, text
analysis or computational biology require learning probabilistic models over finite variable-size strings such as
probabilistic automata, Hidden Markov Models (HMM),
or more generally, weighted automata. Weighted automata
Proceedings of the 31 st International Conference on Machine
Learning, Beijing, China, 2014. JMLR: W&CP volume 32. Copyright 2014 by the author(s).

exactly model the class of rational series, and their algebraic properties have been widely studied in that context (Droste et al., 2009). In particular, they admit algebraic
representations that can be characterized by a set of finitedimensional linear operators whose rank corresponds to the
minimum number of states needed to define the automaton.
From a machine learning perspective, the objective is then
to infer good estimates of these linear operators from finite
samples. In this paper, we consider the problem of learning
the linear representation of a weighted automaton, from a
finite sample, composed of variable-size strings i.i.d. from
an unknown target distribution.
Recently, the seminal papers of Hsu et al. (2009) for
learning HMM and Bailly et al. (2009) for weighted automata, have defined a new category of approaches the so-called spectral methods - for learning distributions
over strings represented by finite state models (Siddiqi
et al., 2010; Song et al., 2010; Balle et al., 2012; Balle &
Mohri, 2012). Extensions to probabilistic models for treestructured data (Bailly et al., 2010; Parikh et al., 2011; Cohen et al., 2012), transductions (Balle et al., 2011) or other
graphical models (Anandkumar et al., 2012c;b;a; Luque
et al., 2012) have also attracted a lot of interest.
Spectral methods suppose that the main parameters of a
model can be expressed as the spectrum of a linear operator
and estimated from the spectral decomposition of a matrix
that sums up the observations. Given a rational series r, the
values taken by r can be arranged in a matrix Hr whose
rows and columns are indexed by strings, such that the linear operators defining r can be recovered directly from the
right singular vectors of Hr . This matrix is called the Hankel matrix of r.
In a learning context, given a learning sample S drawn from
a target distribution p, an empirical estimate HS of Hp is
built and then, a rational series pÃÉ is inferred from the right
singular vectors of HS . However, the size of HS increases
drastically with the size of S and state of the art approaches

Dimension-free Concentration Bounds on Hankel Matrices for Spectral Learning

consider smaller matrices HSU,V indexed by limited subset
of strings U and V . It can be shown that the above learning scheme, or slight variants of it, are consistent as soon
as the matrix HrU,V has full rank (Hsu et al., 2009; Bailly,
2011; Balle et al., 2012) and that the accuracy of the inferred series is directly connected to the concentration distance ||HSU,V ‚àí HpU,V ||2 between the empirical Hankel matrix and its mean (Hsu et al., 2009; Bailly, 2011).
On the one hand, limiting the size of the Hankel matrix
avoids prohibitive calculations. Moreover, most existing
concentration bounds on sum of random matrices depend
on their size and suggest that ||HSU,V ‚àí HpU,V ||2 may become significantly looser with the size of U and V , compromising the accuracy of the inferred model.
On the other hand, limiting the size of the Hankel matrix implies a drastic loss of information: only the strings
of S compatible with U and V will be considered. In
order to limit the loss of information when dealing with
restricted sets U and V , a general trend is to work with
other functionsP
than the target p, such as the prefix funcp(u)
=
b =
tion
v‚ààŒ£‚àó p(uv) or the factor function p
P
v,w‚ààŒ£‚àó p(vuw) (Balle et al., 2013; Luque et al., 2012).
These functions are rational, they have the same rank as p,
a representation of p can easily be derived from representations of p or pb and they allow a better use of the information
contained in the learning sample.
A first contribution is to provide a dimension free concentration inequality for ||HSU,V ‚àíHpU,V ||2 , by using recent results on tail inequalities for sum of random matrices showing that restricting the dimension of H is not mandatory.
However, these results cannot be directly applied to the
prefix and factor series, since the norm of the corresponding random matrices are unbounded. A second contribution of the paper is to define two classes of parametrized
functions, pŒ∑ and pbŒ∑ , that constitute continuous intermediates between p and p (resp. pb), and to provide analogous
dimension-free concentration bounds for these classes.
These bounds are evaluated on a benchmark made of 11
problems extracted from the PAutomaC challenge (Verwer
et al., 2012). These experiments show that the bounds derived from our theoretical results are quite tight - compared
to the exact values- and that they significantly improve existing bounds, even on matrices of fixed dimensions.
These results have two practical consequences for spectral learning: (i) the concentration of the empirical Hankel
matrix around its mean does not highly depend on its dimension and the only reason not to use all the information
contained in the sample should only rely on computing resources limitations. In that perspective, using random techniques to perform singular values decomposition on huge
Hankel matrices should be considered (Halko et al., 2011);

(ii) by constrast, the concentration is weaker for the prefix and factor functions, and smoothed variants should be
used, with an appropriate parameter.
The paper is organized as follows. Section 2 introduces
the main notations, definitions and concepts. Section 3
presents a first dimension free-concentration inequality for
the standard Hankel matrices. Then, we introduce the prefix and the factor variants and provide analogous concentration results. Section 4 describes some experiments before
the conclusion presented in Section 5.

2. Preliminaries
2.1. Singular Values, Eigenvalues and Matrix Norms
Let M ‚àà Rm√ón be a m √ó n real matrix. The singular
values of M are the square roots of the eigenvalues of the
matrix M T M , where M T denotes the transpose of M :
œÉmax (M ) and œÉmin (M ) denote the largest and smallest
singular value of M , respectively.
In this paper, we mainly use the spectral norms || ¬∑ ||k induced by the corresponding vector norms on Rn and dex||k
fined by ||M ||k = maxx6=0 ||M
||x||k :
‚Ä¢ ||M ||1 = M ax1‚â§j‚â§n

Pm

‚Ä¢ ||M ||‚àû = M ax1‚â§i‚â§m

i=1

Pn

|M [i, j]|,

j=1

|M [i, j]|,

‚Ä¢ ||M ||2 = œÉmax (M ).
We have: ||M ||2 ‚â§

p

||M ||1 ||M ||‚àû .

These norms can be extended, under certain conditions, to
infinite matrices and the previous inequalities remain true
when the corresponding norms are defined.
2.2. Rational stochastic languages and Hankel matrices
Let Œ£ be a finite alphabet. The set of all finite strings over
Œ£ is denoted by Œ£‚àó , the empty string is denoted by , the
length of string w is denoted by |w| and Œ£n (resp. Œ£‚â§n )
denotes the set of all strings of length n (resp. ‚â§ n). For
any string w, let Pref(w) = {u ‚àà Œ£‚àó |‚àÉv ‚àà Œ£‚àó w = uv}.
A series is a mapping r : Œ£‚àó P
7‚Üí R. A series r is convergent
if the sequence r(Œ£‚â§n ) =
w‚ààŒ£‚â§n r(w) is convergent;
its limit is denoted by r(Œ£‚àó ). A stochastic language p is
a probability distribution over Œ£‚àó , i.e. a series taking non
negative values and converging to 1.
Let n ‚â• 1 and M be a morphism defined from Œ£‚àó to
M(n), the set of n √ó n matrices with real coefficients. For
all u ‚àà Œ£‚àó , let us denote M (u) by Mu and Œ£x‚ààŒ£ Mx by
MŒ£ . A series r over Œ£ is rational if there exists an integer n ‚â• 1, two vectors I, T ‚àà Rn and a morphism M :
Œ£‚àó 7‚Üí M(n) such that for all u ‚àà Œ£‚àó , r(u) = I T Mu T .

Dimension-free Concentration Bounds on Hankel Matrices for Spectral Learning

The triplet hI, M, T i is called an n-dimensional linear representation of r. The vector I can be interpreted as a vector
of initial weights, T as a vector of terminal weights and the
morphism M as a set of matrix parameters associated with
the letters of Œ£. A rational stochastic language is thus a
stochastic language admitting a linear representation.
Let U, V ‚äÜ Œ£‚àó , the Hankel matrix HrU,V , associated with
a series r, is the matrix indexed by U √ó V and defined
by HrU,V [u, v] = r(uv), for any (u, v) ‚àà U √ó V . If
U = V = Œ£‚àó , HrU,V , simply denoted by Hr , is a bi-infinite
matrix. In the following, we always assume that  ‚àà U
and that U and V are ordered in quasi-lexicographic order:
strings are first ordered by increasing length and then, according to the lexicographic order. It can be shown that a
series r is rational if and only if the rank of the matrix Hr
is finite. The rank of Hr is equal to the minimal dimension
of a linear representation of r.
Let r be a non negative convergent rational series and let
hI, M, T i be a minimal d-dimensional linear representation
of r. Then, the sum Id +MŒ£ +. . .+MŒ£n +. . . is convergent
and r(Œ£‚àó ) = I T (Id ‚àí MŒ£ )‚àí1 T where Id is the identity
matrix of size d.
Several convergent rational series can be naturally associated with a stochastic language p:
P

‚Ä¢ p, defined by p(u) = v‚ààŒ£‚àó p(uv), the series associated with the prefixes of the language,
P
‚Ä¢ pb, defined by pÃÇ(u) = v,w‚ààŒ£‚àó p(vuw), the series associated with the factors of the language.
It can be noticed that p(u) = p(uŒ£‚àó ), the probability that a
string begins with u, but that in general, pb(u) ‚â• p(Œ£‚àó uŒ£‚àó ),
the probability that a string contains u as a substring.
If hI, M, T i is a minimal d-dimensional linear representation of p, then hI, M, (Id ‚àí MŒ£ )‚àí1 T i (resp. h[I T (Id ‚àí
MŒ£ )‚àí1 ]T , M, (Id ‚àí MŒ£ )‚àí1 T i) is a minimal linear representation of p (resp. of pb). Any linear representation of
these variants of p can be reconstructed from the others.
For any integer k ‚â• 1, let
X
Sp(k) =
p(u1 u2 . . . uk ) = I T (Id ‚àí MŒ£ )‚àík T.
u1 u2 ...uk

U,V

‚Ä¢ H w [u, v] = 1uv‚ààP ref (w) and
b U,V [u, v] = P
‚Ä¢ H
w
x,y‚ààŒ£‚àó 1xuvy=w
for any (u, v) ‚àà U √ó V . For any sample of strings S, let
P
P
U,V
U,V
1
1
U,V
= |S|
and
HSU,V = |S|
w‚ààS Hw , H S
w‚ààS H w
P
U,V
1
U,V
b
b
H
=
Hw .
S

|S|

w‚ààS

For example, let S = {a, ab}, U = V = {, a, b}. We have
U,V

HS

Ô£´
Ô£∂
0 0.5 0
= Ô£≠0.5 0 0.5Ô£∏ ,
0
0
0

U,V

HS

Ô£´
Ô£∂
1 1 0
= Ô£≠ 1 0 0.5Ô£∏ ,
0 0 0

Ô£´
Ô£∂
2.5 1 0.5
b U,V = Ô£≠ 1 0 0.5Ô£∏ .
H
S
0.5 0 0

2.3. Spectral Algorithm for Learning Rational
Stochastic Languages
Rational series admit a canonical linear representation determined by their Hankel matrix. Let r be a rational series
‚àó
of rank d and U ‚äÇ Œ£‚àó such that the matrix HrU √óŒ£ (denoted by H in the following) has rank d.
‚Ä¢ For any string s, let Ts be the constant matrix whose
rows and columns are indexed by Œ£‚àó and defined by
Ts [u, v] = 1 if v = us and 0 otherwise.
‚Ä¢ Let E be a vector indexed by Œ£‚àó whose coordinates
are all zero except the first one equals to 1: E[u] =
1u= and let P be the vector indexed by Œ£‚àó defined
by P [u] = r(u).
‚Ä¢ Let H = LDRT be a reduced singular value decomposition of H: R (resp. L) is a matrix whose columns
form a set of orthonormal vectors - the right (resp.
left) singular vectors of H - and D is a d √ó d diagonal matrix, composed of the singular values of H.
Then, hRT E, (RT Tx R)x‚ààŒ£ , RT P i is a linear representation of r (Bailly et al., 2009; Bailly, 2011; Balle et al.,
2012). A quick proof can be found in (Denis et al., 2013).
The basic spectral algorithm for learning rational stochastic
languages aims at identifying the canonical linear representation of the target p determined by its Hankel matrix Hp .
Let S be a sample independently drawn according to p:

‚ààŒ£‚àó
(1)

(2)

(3)

Clearly, p(Œ£‚àó ) = Sp = 1, p(Œ£‚àó ) = Sp and pb(Œ£‚àó ) = Sp .
P
P
(2)
Note that Sp = 1 + u |u|p(u), where u |u|p(u) is the
average length of a string drawn according to p.
Let U, V ‚äÜ Œ£‚àó . For any string w ‚àà Œ£‚àó , let us define the
U,V
b wU,V by
matrices HwU,V , H w and H
‚Ä¢ HwU,V [u, v] = 1uv=w ,

‚Ä¢ Choose sets U, V ‚äÜ Œ£‚àó and build the Hankel matrix
HSU √óV ,
‚Ä¢ choose a rank d and compute a reduced SVD of
HSU √óV truncated at rank d,
‚Ä¢ build
the
canonical
linear
representation
hRST E, (RST Tx RS )x‚ààŒ£ , RST PS i from the right
singular vectors RS and the empirical distribution pS
defined from S.

Dimension-free Concentration Bounds on Hankel Matrices for Spectral Learning

Alternative learning strategies consist in learning p or pb, using the same algorithm, and then to compute an estimate of
p. In all cases, the accuracy of the learned representation
mainly depends on the estimation of R. The Stewart formula (Stewart, 1990) bounds the principle angle Œ∏ between
the spaces spanned by the right singular vectors of R and
RS :
||HSU √óV ‚àí HrU √óV ||2
.
|sin(Œ∏)| ‚â§
œÉmin (HrU √óV )
According to this formula, the concentration of the Hankel matrix around its mean is critical and the question of
limiting the sizes of U and V naturally arises. Note that
the Stewart inequality does not give any clear indication
on the impact or on the interest of limiting these sets. Indeed, Weyl‚Äôs inequalities can be used to show that both the
numerator and the denominator of the right part of the inequality increase with U and V .

3. Concentration Bounds for Hankel Matrices
Let p be a rational stochastic language over Œ£‚àó , let Œæ be a
random variable distributed according to p, let U, V ‚äÜ Œ£‚àó
and let Z(Œæ) ‚àà R|U |√ó|V | be a random matrix. For instance,
U,V
b U,V .
Z(Œæ) may be equal to HŒæU,V , H Œæ or H
Œæ
Concentration bounds for sum of random matrices can be
used to estimate the spectral distance between the empirical matrix ZS computed on the sample S and its mean
(see (Hsu et al., 2011) for references). However, most of
classical inequalities depend on the dimensions of the matrices. For example, it can be proved that with probability
at least 1 ‚àí Œ¥ (Kakade, 2010):
6M
||ZS ‚àí EZ||2 ‚â§ ‚àö
N

r
p

log d +

1
log
Œ¥

!
(1)

where N is the size of S, d is the minimal dimension of the
matrix Z and ||Z||2 ‚â§ M almost surely. If Z = HŒæU,V ,
U,V

then M = 1; if Z = H Œæ , M = ‚Ñ¶(D1/2 ) in the worst
b U,V , ||Z||2 is generally unbounded.
case; if Z = H
Œæ
These concentration bounds get worse with both sizes of
the matrices. Coming back to the discussion at the end of
Section 2, they suggest to limit the size of the sets U and V ,
and therefore, to design strategies to choose optimal sets.
We then use recent results (Tropp, 2012; Hsu et al., 2011)
to obtain dimension-free concentration bounds for Hankel
matrices. More precisely, we extend a Bernstein bound for
unbounded random matrices from (Hsu et al., 2011) to non
symmetric random matrices by using the dilation principle
(Tropp, 2012).
Let Z be a random matrix, the dilation of Z is the symmet-

ric random matrix X defined by



0 Z
ZZ T
2
X=
.
Then
X
=
T
Z
0
0

0



ZT Z

and ||X||2 = ||Z||2 , tr(X 2 ) = tr(ZZ T ) + tr(Z T Z) and
||X 2 ||2 ‚â§ M ax(||ZZ T ||2 , ||Z T Z||2 ).
We can then reformulate the result that we use as follows (Denis et al., 2013).
Theorem 1. Let Œæ1 , . . . , ŒæN be i.i.d. random variables, and
for i = 1, . . . , N , let Zi = Z(Œæi ) be i.i.d. matrices and
Xi the dilation of Zi . If there exists b > 0, œÉ > 0, and
k > 0 such that E[X1 ] = 0, ||X1 ||2 ‚â§ b, ||E(X12 )||2 ‚â§
œÉ 2 and tr(E(X12 )) ‚â§ œÉ 2 k almost surely, then for all t > 0,
#
"
r
N
2œÉ 2 t
bt
1 X
Xi ||2 >
+
‚â§ k¬∑t(et ‚àít‚àí1)‚àí1 .
P r ||
N i=1
N
3N
We will then make use of this theorem to derive our new
concentration bounds. Section 3.1 deals with the standard
case, Section 3.2 with the prefix case and Section 3.3 with
the factor case.
3.1. Concentration Bound for the Hankel Matrix HpU,V
Let p be a rational stochastic language over Œ£‚àó , let S
be a sample independently drawn according to p, and let
U, V ‚äÜ Œ£‚àó . In this section, we compute a bound on
||HSU,V ‚àí HpU,V ||2 which is independent from the sizes of
U and V and holds in particular when U = V = Œ£‚àó .
Let Œæ be a random variable distributed according to p, let
Z(Œæ) = HŒæU,V ‚àí HpU,V be the random matrix defined by
Zu,v = 1Œæ=uv ‚àí p(uv) and let X be the dilation of Z.
Clearly, E(X) = 0. In order to apply Theorem 1, it is necessary to compute the parameters b, œÉ and k. We first prove
a technical lemma that will provide a bound on E(X 2 ).
Lemma 1. For any u, u0 ‚àà U , v, v 0 ‚àà V ,
|E(Zuv Zu0 v )| ‚â§ p(u0 v) and |E(Zuv Zuv0 )| ‚â§ p(uv 0 ).
Proof.
E(Zuv Zu0 v ) = E(1Œæ=uv 1Œæ=u0 v ) ‚àí p(uv)p(u0 v)
X
=
p(w)1w=uv 1w=u0 v ‚àí p(uv)p(u0 v)
w‚ààŒ£‚àó
0

= p(u v)[1u=u0 ‚àí p(uv)]
and
|E(Zuv Zu0 v )| ‚â§ p(u0 v).
The second inequality is proved in a similar way.
Next lemma provides parameters b, œÉ and k needed to apply
Theorem 1.

Dimension-free Concentration Bounds on Hankel Matrices for Spectral Learning
(2)

Lemma 2. ||X||2 ‚â§ 2, E(T r(X 2 )) ‚â§ 2Sp
(2)
||E(X 2 )||2 ‚â§ Sp .

and

U,V

P
P
Proof. 1. ‚àÄu ‚àà U ,
v‚ààV |Zu,v | =
v‚ààV |1Œæ=uv ‚àí
p(uv)| ‚â§ 1 + p(uŒ£‚àó ) ‚â§ 2. Therefore, ||Z||‚àû ‚â§ 2. In
a similar way, it can be shown that ||Z||1 ‚â§ 2. Hence,
p
||X||2 = ||Z||2 ‚â§ ||Z||‚àû ||Z||1 ‚â§ 2.
2. For all (u, u0 ) ‚àà U 2 : ZZ T [u, u0 ] =

P

v‚ààV

3.2. Bound for the prefix Hankel Matrix HpU,V

Zu,v Zu0 ,v .

Therefore,

The random matrix Z(Œæ) = H Œæ ‚àí HpU,V is defined
by Z u,v = 1uv‚ààP ref (Œæ) ‚àí p(uv). It can easily be shown
that ||Z||2 may be unbounded if U or V are unbounded:
||Z||2 = ‚Ñ¶(|Œæ|1/2 ). Hence, Theorem 1 cannot be directly
applied, which suggests that the concentration of Z around
its mean could be far weaker than the concentration of Z.
For any Œ∑ ‚àà [0, 1], we define a smoothed variant of p by
pŒ∑ (u) =

E(T r(ZZ T )) = E(

X

ZZ T [u, u])

X

‚â§

E(Zu,v Zu,v )

u‚ààU,v‚ààV

‚â§ Sp(2) .
(2)

In a similar way, it can be proved that E(T r(Z T Z)) ‚â§ Sp
(2)
and therefore, E(T r(X 2 )) ‚â§ 2Sp .
3. For any u ‚àà U ,
X
|E(ZZ T [u, u0 ])| ‚â§
u0 ‚ààU

X

|E(Zuv Zu0 v )|

X

p(u0 v)

u0 ‚ààU,v‚ààV

‚â§ Sp(2) .
(2)

Hence, ||ZZ T ||‚àû ‚â§ Sp . It can be proved, in a sim(2)
(2)
ilar way, that ||Z T Z||‚àû ‚â§ Sp , ||ZZ T ||1 ‚â§ Sp and
(2)
(2)
||Z T Z||1 ‚â§ Sp . Therefore, ||X 2 ||2 ‚â§ Sp .
We can now prove the main theorem of this section:
Theorem 2. Let p be a rational stochastic language and
let S be a sample of N strings drawn i.i.d. from p. For all
t > 0,
P r Ô£∞||HSU,V ‚àí HpU,V ||2 >

Œ∑ n p(uŒ£n ).

n‚â•0

Proposition 1. Let p be a rational stochastic language and
let hI, (Mx )x‚ààŒ£ , T i be a minimal linear representation of
p. Let T Œ∑ = (Id ‚àí Œ∑MŒ£ )‚àí1 T . Then, pŒ∑ is rational and
hI, (Mx )x‚ààŒ£ , T Œ∑ i is a linear representation of pŒ∑ .
P
Proof. For any string u, pŒ∑ (u) = n‚â•0 I T Mu Œ∑ n MŒ£n T =
P
I T Mu ( n‚â•0 Œ∑ n MŒ£n )T = I T Mu T Œ∑ .

u0 ‚ààU,v‚ààV

‚â§

Ô£Æ

X

Note that p1 = p, p0 = p and that p(u) ‚â§ pŒ∑ (u) ‚â§ p(u)
for any string u. Therefore, the functions pŒ∑ are natural intermediates between p and p. Moreover, when p is rational,
each pŒ∑ is also rational.

Zu,v Zu,v )

u‚ààU,v‚ààV

X

Œ∑ |x| p(ux) =

x‚ààŒ£‚àó

u‚ààU

= E(

X

s

(2)

Ô£π

2Sp t
2t Ô£ª
+
‚â§ 2t(et ‚àít‚àí1)‚àí1 .
N
3N

Proof. Let Œæ1 , . . . , ŒæN be N independent copies of Œæ, let
Zi = Z(Œæi ) and let Xi be the dilation of Zi for i =
1, . . . , N . Lemma 2 shows that the 4 conditions of The(2)
orem 1 are fulfilled with b = 2, œÉ 2 = Sp and k = 2.

Note that T can be computed from T Œ∑ when Œ∑ and MŒ£ are
known and therefore, it is a consistent learning strategy to
learn pŒ∑ from the data, for some Œ∑, and next, to derive p.
For any 0 ‚â§ Œ∑ ‚â§ 1, let Z Œ∑ (Œæ) be the random matrix defined
by
Z Œ∑ [u, v] =

Œ∑ |x| 1Œæ=uvx ‚àí pŒ∑ (uv)

x‚ààŒ£‚àó

=

X

Œ∑ |x| (1Œæ=uvx ‚àí p(uvx)).

x‚ààŒ£‚àó

for any (u, v) ‚àà U √ó V . It is clear that E(Z Œ∑ ) = 0 and we
show below that ||Z Œ∑ ||2 is bounded if Œ∑ < 1.
(k)

The moments SpŒ∑ can naturally be associated with pŒ∑ . For
any 0 ‚â§ Œ∑ ‚â§ 1 and any k ‚â• 1, let
(k)

X

SpŒ∑ =

pŒ∑ (u1 u2 . . . uk ).

u1 u2 ...uk ‚ààŒ£‚àó
(k)

We have SpŒ∑ = I T (Id ‚àí MŒ£ )‚àík (Id ‚àí Œ∑MŒ£ )‚àí1 T and it is
(k)

This bound is independent from U and V . It can be noticed
that the proof also provides a dimension dependent bound
P
(2)
by replacing Sp with (u,v)‚ààU √óV p(uv), which may result in a significative improvement if U or V are small.

X

(k)

clear that Sp0 = Sp

(k)

(k+1)

and Sp1 = Sp

Lemma 3.
||Z Œ∑ ||2 ‚â§

1
(1)
+ SpŒ∑ .
1‚àíŒ∑

.

Dimension-free Concentration Bounds on Hankel Matrices for Spectral Learning

Proof. Indeed, let u ‚àà U .
X
X
X
Œ∑ |x| 1Œæ=uvx +
Œ∑ |x| p(uvx)
|Z Œ∑ [u, v]| ‚â§
v,x‚ààŒ£‚àó

v‚ààV

Therefore, we can apply the Theorem 1 with b =

(1)

+ SpŒ∑ . Similarly, ||Z Œ∑ ||1 ‚â§

1
1‚àíŒ∑

+

(1)

SpŒ∑ , which completes the proof.
When U and V are bounded, let l be the maximal length
of a string in U ‚à™ V . It can easily be shown that ||Z Œ∑ ||2 ‚â§
(1)
l + 1 + SpŒ∑ and therefore, in that case,
||Z Œ∑ ||2 ‚â§ M in(l + 1,

1
(1)
) + SpŒ∑
1‚àíŒ∑

Lemma 4. |E(Z Œ∑ [u, v]Z Œ∑ [u0 , v])| ‚â§ pŒ∑ (u0 v), for any
u, u0 , v ‚àà Œ£‚àó .
Proof. We have E((1Œæ=w ‚àí p(w))(1Œæ=w0 ‚àí p(w0 ))) =
E(1Œæ=w 1Œæ=w0 ) ‚àí p(w)p(w0 ). Therefore,
E(Z Œ∑ [u, v]Z Œ∑ [u0 , v])
X

Œ∑

|xx0 |

p(w)1w=u0 vx0 [1w=uvx ‚àí p(uvx)]

X

0

Œ∑ |x | p(u0 vx0 )[

x0

X

Œ∑ |x| (1u0 vx0 =uvx ‚àí p(uvx))]
0

Œ∑ |x | p(u0 vx0 ) = pŒ∑ (u0 v)
and |E(Z Œ∑ [u, v]Z Œ∑ [u0 , v])| ‚â§
P |x| x0
since ‚àí1 ‚â§ ‚àípŒ∑ (uv) ‚â§
(1u0 vx0 =uvx ‚àí p(uvx)) ‚â§ 1
xŒ∑

P

x

‚â§ 2t(et ‚àí t ‚àí 1)‚àí1 .
Remark that when Œ∑ = 0 we find back the concentration
bound of Theorem 2, and that Inequality 2 provides a bound
when Œ∑ = 1.
3.3. Bound for the factor Hankel Matrix HpbU,V
b
b U,V ‚àí HpbU,V is defined by
The random matrix Z(Œæ)
=H
Œæ
X
Zbu,v =
1Œæ=xuvy ‚àí pb(uv).
x,y‚ààŒ£‚àó

Œ∑ |x| (1u0 vx0 =uvx ‚àí p(uvx))| ‚â§ 1.

Lemma 5.
T

T

(2)

(2)

||E(Z Œ∑ Z Œ∑ )||2 ‚â§ SpŒ∑ and T r(E(Z Œ∑ Z Œ∑ )) ‚â§ SpŒ∑ .
T

T

(2)

(2)

||E(Z Œ∑ Z Œ∑ )||2 ‚â§ SpŒ∑ and T r(E(Z Œ∑ Z Œ∑ )) ‚â§ SpŒ∑ .
Proof. Indeed,
T

||E(Z Œ∑ Z Œ∑ )||‚àû ‚â§ M axu

X

|E(Z Œ∑ [u, v]Z Œ∑ [u0 , v])|

u0 ,v

‚â§

X
u0 ,v,x0

We can also define smoothed variants of pb by
X
X
pbŒ∑ (u) =
Œ∑ |xy| p(xuy) =
Œ∑ m+n p(Œ£m uŒ£n )
x,y‚ààŒ£‚àó

x

P

i.e. |

Theorem 3. Let p be a rational stochastic language, let
S be a sample of N strings drawn i.i.d. from p and let
0 ‚â§ Œ∑ < 1. For all t > 0,
Ô£π
Ô£Æ
s
(2)


2S
t
t
1
pŒ∑
Ô£Ø U,V
(1) Ô£∫
||2 >
+
+ SpŒ∑ Ô£ª
P r Ô£∞||H Œ∑,S ‚àí HpU,V
Œ∑
N
3N 1 ‚àí Œ∑

0

Œ∑ |xx | p(u0 vx0 )[1u0 vx0 =uvx ‚àí p(uvx)]

x,x0

=

+

b 2 is generally unbounded. Moreover, unlike the prefix
||Z||
b 2 can be unbounded even if U and V are finite.
case, ||Z||
Hence, the Theorem 1 cannot be directly applied either.

x,x0 ,w

X

1
1‚àíŒ∑

and k = 2.

0

X

=

=

(2)
SpŒ∑

Œ∑ |xx | [E(1Œæ=uvx 1Œæ=u0 vx0 ) ‚àí p(u0 vx0 )p(uvx)]

x,x0

=

(1)
SpŒ∑ , œÉ 2

(2)

which holds even if Œ∑ = 1.

=

(2)

E(Z Œ∑ [u, v]Z Œ∑ [u, v]) ‚â§ SpŒ∑ .

Similar computations provide all the inequalities.

1
(1)
+ SpŒ∑ .
1‚àíŒ∑
1
1‚àíŒ∑

X
u,v

(1)

Hence, ||Z Œ∑ ||‚àû ‚â§

T

T r(E(Z Œ∑ Z Œ∑ )) =

v,x‚ààŒ£‚àó

‚â§ (1 + Œ∑ + . . . + Œ∑ |Œæ|‚àí|u| ) + SpŒ∑
‚â§

In the same way,

0

(2)

Œ∑ |x | p(u0 vx0 ) ‚â§ SpŒ∑ .

m,n‚â•0

which have properties similar to functions pŒ∑ :
‚Ä¢ p ‚â§ pbŒ∑ ‚â§ pb, pb1 = pb and pb0 = p,
‚Ä¢ if hI, (Mx )x‚ààŒ£ , T i be a minimal linear representation of p then hIbŒ∑ , (Mx )x‚ààŒ£ , T Œ∑ i, where IbŒ∑ = (Id ‚àí
Œ∑MŒ£T )‚àí1 I, is a linear representation of pÃÇŒ∑ .
However, proofs of the previous Section cannot be directly
extended to pbŒ∑ because p is bounded by 1, a property which
is often used in the proofs, while pb is not. Next lemma
provides a tool which allows to bypass this difficulty.
Lemma 6. Let 0 < Œ∑ ‚â§ 1. For any integer n, (n + 1)Œ∑ n ‚â§
KŒ∑ where

1
if Œ∑ ‚â§ e‚àí1
KŒ∑ =
‚àí1
(‚àíeŒ∑ ln Œ∑)
otherwise.

Dimension-free Concentration Bounds on Hankel Matrices for Spectral Learning

Proof. Let f (x) = (x + 1)Œ∑ x . We have f 0 (x) = Œ∑ x (1 +
(x + 1) ln Œ∑) and f takes its maximum for xM = ‚àí1 ‚àí
1/ ln Œ∑, which is positive if and only if Œ∑ > 1/e. We have
f (xM ) = (‚àíeŒ∑ ln Œ∑)‚àí1 .
Lemma 7. Let w, u ‚àà Œ£‚àó . Then,
X
Œ∑ |xy| 1w=xuy ‚â§ KŒ∑ and pb(u) ‚â§ KŒ∑ p(Œ£‚àó uŒ£‚àó ).
x,y‚ààŒ£‚àó

Proof. Indeed, if w = xuy, then |xy| = |w| ‚àí |u| and u
appears at most |w| ‚àí |u| + 1 times as a factor of w.
X
pb(u) =
Œ∑ |xy| p(xuy)
x,y‚ààŒ£‚àó

X

=

X

p(w)

Œ∑ |xy| 1w=xuvy

4. Experiments
The proposed bounds are evaluated on the benchmark of
PAutomaC (Verwer et al., 2012) which provides samples of strings generated from several probabilistic automata, designed to evaluate probabilistic automata learning. Eleven problems have been selected from that benchmark for which sparsity of the Hankel matrices makes the
use of standard SVD algorithms available from NumPy or
SciPy possible. The size N of the samples is 20, 000 except for the problem 4 where N = 100, 000. Table 1 shows
some target properties of the selected problems: the size of
(k)
the alphabets and the exact values of Sp computed for the
different targets p. Figure 1 shows the typical behavior of
(1)
(1)
SpŒ∑ and SpbŒ∑ , similar for all the problems.

x,y‚ààŒ£‚àó

w‚ààŒ£‚àó uŒ£‚àó
‚àó

‚àó

‚â§ KŒ∑ p(Œ£ uŒ£ ).

For Œ∑ ‚àà [0, 1], let ZbŒ∑ (Œæ) be the random matrix defined by
X
ZbŒ∑ [u, v] =
Œ∑ |xy| 1Œæ=xuvy ‚àí pbŒ∑ (uv)
x,y‚ààŒ£‚àó

X

=

Œ∑ |xy| (1Œæ=xuvy ‚àí p(xuvy)).

x,y‚ààŒ£‚àó

and, for any k ‚â• 0, let
(k)

SpbŒ∑ =

X

pbŒ∑ (u1 u2 . . . uk ).

u1 u2 ...uk ‚ààŒ£‚àó
(k)

T
bŒ∑ ) = 0, S
It can easily be shown that E(Z
p
bŒ∑ = I (Id ‚àí
(k)

(k)

Œ∑MŒ£ )‚àí1 (Id ‚àí MŒ£ )‚àík (Id ‚àí Œ∑MŒ£ )‚àí1 T , Spb0 = Sp

(k)
Spb1

=

(1)

(1)

Figure 1. Behavior of SpŒ∑ and SpbŒ∑ for Œ∑ ‚àà [0; 1].

and

(k+2)
.
Sp

For each problem, the exact value of ||HSU,V ‚àí HpU,V ||2
is computed for sets U and V of the form Œ£‚â§l , trying to
maximize l according to our computing resources. It is
(1)
‚àí2
compared to the bounds provided by Theorem 2 and Equab
||ZŒ∑ ||2 ‚â§ (1 ‚àí Œ∑) + SpbŒ∑ .
tion (1), with Œ¥ = 0.05 (Table 2). The optimized bound
(‚Äùopt.‚Äù), refers to the case where œÉ 2 has been calculated
Eventually, we can apply the Theorem 1 with b = (1 ‚àí
over U √ó V rather than Œ£‚àó √ó Œ£‚àó (see the remark at the end
(1)
(2)
Œ∑)‚àí2 + SpbŒ∑ , œÉ 2 = KŒ∑ SpbŒ∑ and k = 2 (Denis et al., 2013).
of Section 3.1). Tables 3 and 4 show analog comparisons
Theorem 4. Let p be a rational stochastic language, let
for the prefix and the factor cases with different values of Œ∑.
S be a sample of N strings drawn i.i.d. from p and let
Similar results have been obtained for all the problems of
0 ‚â§ Œ∑ < 1. For all t > 0,
PautomaC. We can remark that our dimension-free bounds
Ô£Æ
Ô£π
s
are significantly more accurate than the one provided by
(2)


2KŒ∑ SpbŒ∑ t
t
1
Ô£Ø b U,V
(1) Ô£∫
U,V
Equation (1). Notice that in the prefix case, the dimensionP r Ô£∞||H
‚àí
H
||
>
+
+
S
Ô£ª
2
Œ∑,S
p
bŒ∑
p
bŒ∑
N
3N (1 ‚àí Œ∑)2
free bound has a better behavior in the limit case Œ∑ = 1
than the bound from Eq. (1). This is due to the fact that
‚â§ 2t(et ‚àí t ‚àí 1)‚àí1 .
in our bound, the term that bounds ||Z||2 appears in the N1
term while it appears in the ‚àö1N term in the other one.
Remark that when Œ∑ = 0 we find back the concentration
bound of Theorem 2. We provide experimental evaluation
Additional experiments confirm the implications of these
of the proposed bounds in the next Section.
results for spectral learning (see (Denis et al., 2013)).
It can be shown that ||ZbŒ∑ ||2 is bounded if Œ∑ < 1.
Lemma 8. (Denis et al., 2013)

Dimension-free Concentration Bounds on Hankel Matrices for Spectral Learning

Problem number
|Œ£|
(2)
Sp
(3)
Sp

3
4
8.23
57.84

4
4
6.25
31.06

Table 1. Properties of the problem set.
7
15
25
29
31
13
14
10
6
5
6.52
13.40
10.65
6.35
6.97
29.61 160.92 93.34 38.11 43.53

38
10
8.09
65.87

Table 2. Concentration values from various bounds for ||HSU,V ‚àí HpU,V ||2
Problem number
3
4
7
15
25
29
31
l
8
9
8
5
5
9
7
||HSU,V ‚àí HpU,V ||2 0.0052 0.0030 0.0064 0.0037 0.0033 0.0045 0.0051
Eq. (1)
0.1910 0.0857 0.1917 0.1909 0.1935 0.1908 0.1911
Th. 2 (dim. free)
0.0669 0.0260 0.0595 0.0853 0.0761 0.0588 0.0615
Th. 2 (opt. U, V )
0.0475 0.0228 0.0527 0.0284 0.0323 0.0472 0.0437

U,V

U,V
||2
Table 3. Concentration values from various bounds for ||H S ‚àí Hp,Œ∑
lines and Œ∑ = 1 for the last four lines.
Problem number
3
4
7
15
25
l
8
9
8
5
5
U,V
U,V
||2 0.0067 0.0035 0.0085 0.0043 0.0041
||H S ‚àí Hp,Œ∑
Eq. (1)
0.7463 0.3326 0.7545 0.7515 0.7626
Th. 3 (dim. free)
0.0890 0.0339 0.0777 0.1162 0.1026
Th. 3 (opt. U, V )
0.0636 0.0299 0.0697 0.0398 0.0457
U,V

U,V
||2
‚àí Hp,Œ∑
Eq. (1)
Th. 3 (dim. free)
Th. 3 (opt. U, V )

||H S

0.0141
3.1011
0.1784
0.1281

0.0059
1.3079
0.0582
0.0518

0.0217
2.7839
0.1279
0.1166

0.0124
3.5129
0.2967
0.1062

0.0145
3.0283
0.2261
0.1057

39
14
8.82
90.81

40
14
9.74
111.84

for U = V = Œ£‚â§l .
38
39
4
6
0.0058 0.0049
0.1852 0.1925
0.0663 0.0692
0.0275 0.0325

We have provided dimension-free concentration inequalities for Hankel matrices in the context of spectral learning of rational stochastic languages. These bounds cover 3
cases, each one corresponding to a specific way to exploit
the strings under observation, paying attention to the strings
themselves, to their prefixes or to their factors. For the last
two cases, we introduced parametrized variants which allow a trade-off between the rate of the concentration and
the exploitation of the information contained in data.
A consequence of these results is that there is no a priori
good reason, aside from computing resources limitations,
to restrict the size of the Hankel matrices. This suggests
an immediate future work consisting in investigating recent
random techniques (Halko et al., 2011) to compute singular values decomposition on Hankel matrices in order to be

40
4
0.0037
0.1829
0.0728
0.0243

(prefix case) for U = V = Œ£‚â§l with Œ∑ =

1
2

42
7
0.0054
0.1936
0.0634
0.0378

for the first four

29
9
0.0055
0.7250
0.0770
0.0621

31
7
0.0073
0.7369
0.0811
0.0577

38
4
0.0059
0.7051
0.0884
0.0366

39
6
0.0061
0.7068
0.0931
0.0432

40
4
0.0044
0.6753
0.0983
0.0317

42
7
0.0062
0.7146
0.0844
0.0498

0.0116
2.9286
0.1450
0.1175

0.0182
2.6695
0.1547
0.1099

0.0132
2.2395
0.1899
0.0778

0.0135
2.8524
0.2230
0.1020

0.0089
2.5132
0.2472
0.0761

0.0127
2.7863
0.1846
0.1077

b U,V ‚àí H U,V ||2 (factor case) for U = V = Œ£‚â§l
Table 4. Concentration values from various bounds for ||H
S
pÃÇ,Œ∑
Problem number
3
4
7
15
25
29
31
38
39
l
6
7
5
4
4
6
6
4
4
b U,V ‚àí H U,V ||2 0.0065 0.0031 0.0071 0.0042 0.0033 0.0051 0.0072 0.0061 0.0065
||H
S
p
b,Œ∑
Eq. (1)
0.9134 0.4107 0.9196 0.9466 0.9152 0.9096 0.9219 0.8765 0.8292
Th. 4 (dim. free)
0.0985 0.0374 0.0858 0.1292 0.1139 0.0849 0.0895 0.0979 0.1033
Th. 4 (opt. U, V )
0.0601 0.0300 0.0619 0.0364 0.0412 0.0559 0.0589 0.0405 0.0356

5. Conclusion

42
9
7.39
62.11

and Œ∑ = 1/e.
40
42
4
5
0.0047 0.0060
0.8796 0.8565
0.1092 0.0934
0.0349 0.0444

able to deal with huge matrices. Then, a second aspect is to
evaluate the impact of these methods on the quality of the
models, including an empirical evaluation of the behavior
of the standard approach and its prefix and factor extensions, along with the influence of the parameter Œ∑.
Another research direction would be to link up the prefix
and factor cases to concentration bounds for sum of random
tensors and to generalize the results to the case where a
fixed number ‚â• 1 of factors is considered for each string.

Acknowledments
This work was supported by the French National Agency
for Research (Lampada - ANR-09-EMER-007).

Dimension-free Concentration Bounds on Hankel Matrices for Spectral Learning

References
Anandkumar, A., Foster, D.P., Hsu, D., Kakade, S., and
Liu, Y.-K. A spectral algorithm for latent dirichlet allocation. In Proceedings of NIPS, pp. 926‚Äì934, 2012a.
Anandkumar, A., Hsu, D., Huang, F., and Kakade, S.
Learning mixtures of tree graphical models. In Proceedings of NIPS, pp. 1061‚Äì1069, 2012b.
Anandkumar, A., Hsu, D., and Kakade, S.M. A method of
moments for mixture models and hidden markov models. Proceedings of COLT - Journal of Machine Learning
Research - Proceedings Track, 23:33.1‚Äì33.34, 2012c.
Bailly, R. MeÃÅthodes spectrales pour l‚ÄôinfeÃÅrence grammaticale probabiliste de langages stochastiques rationnels.
PhD thesis, Aix-Marseille UniversiteÃÅ, 2011.
Bailly, R., Denis, F., and Ralaivola, L. Grammatical inference as a principal component analysis problem. In
Proceedings of ICML, pp. 5, 2009.
Bailly, R., Habrard, A., and Denis, F. A spectral approach
for probabilistic grammatical inference on trees. In Proceedings of ALT, pp. 74‚Äì88, 2010.
Balle, B. and Mohri, M. Spectral learning of general
weighted automata via constrained matrix completion.
In Proceedings of NIPS, pp. 2168‚Äì2176, 2012.
Balle, B., Quattoni, A., and Carreras, X. A spectral learning
algorithm for finite state transducers. In Proceedings of
ECML/PKDD (1), pp. 156‚Äì171, 2011.
Balle, B., Quattoni, A., and Carreras, X. Local loss optimization in operator models: A new insight into spectral
learning. In Proceedings of ICML, 2012.
Balle, B., Carreras, X., Luque, F. M., and Quattoni, A.
Spectral learning of weighted automata: A forwardbackward perspective. To appear in Machine Learning,
2013.
Cohen, Shay B., Stratos, Karl, Collins, Michael, Foster,
Dean P., and Ungar, Lyle H. Spectral learning of LatentVariable PCFGs. In ACL (1), pp. 223‚Äì231. The Association for Computer Linguistics, 2012. ISBN 978-1937284-24-4.
Denis, F., Gybels, M., and Habrard, A. Dimension-free
Concentration Bounds on Hankel Matrices for Spectral
Learning (Long Version). arXiv:1312.6282, 2013.
Droste, M., Kuich, W., and Vogler, H. (eds.). Handbook of
Weighted Automata. Springer, 2009.

Halko, N., Martinsson, P.G., and Tropp, J.A. Finding
structure with randomness: Probabilistic algorithms for
constructing approximate matrix decompositions. SIAM
Rev., 53(2):217‚Äì288, 2011.
Hsu, D., Kakade, S.M., and Zhang, T. A spectral algorithm
for learning hidden markov models. In Proceedings of
COLT, 2009.
Hsu, D., Kakade, S. M., and Zhang, T. Dimension-free tail
inequalities for sums of random matrices. ArXiv e-prints,
2011.
Kakade, S. Multivariate analysis, dimensionality reduction,
and spectral methods. Lecture Notes (Matrix Concentration Derivations), 2010.
Luque, F.M., Quattoni, A., Balle, B., and Carreras, X.
Spectral learning for non-deterministic dependency parsing. In Proceedings of EACL, pp. 409‚Äì419, 2012.
Parikh, A.P., Song, L., and Xing, E.P. A spectral algorithm for latent tree graphical models. In Proceedings of
ICML, pp. 1065‚Äì1072, 2011.
Siddiqi, S., Boots, B., and Gordon, G.J. Reduced-rank hidden Markov models. In Proceedings of the Thirteenth
International Conference on Artificial Intelligence and
Statistics (AISTATS-2010), 2010.
Song, L., Boots, B., Siddiqi, S.M., Gordon, G.J., and
Smola, A.J. Hilbert space embeddings of hidden markov
models. In Proceedings of ICML, pp. 991‚Äì998, 2010.
Stewart, G. W. Perturbation theory for the singular value
decomposition. In SVD and Signal Processing II: Algorithms, Analysis and Applications, pp. 99‚Äì109. Elsevier,
1990.
Tropp, J.A. User-friendly tail bounds for sums of random
matrices. Foundations of Computational Mathematics,
12(4):389‚Äì434, 2012.
Verwer, S., Eyraud, R., and de la Higuera, C. Results of
the PAutomaC probabilistic automaton learning competition. Journal of Machine Learning Research - Proceedings Track, 21:243‚Äì248, 2012.

